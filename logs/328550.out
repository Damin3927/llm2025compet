===== ジョブ開始: Wed Aug  6 12:01:14 PM JST 2025 =====
cwd  = /home/Competition2025/P02/P02U006/ColossalAI
host = osk-gpu54
JOB  = 328550
NODES= osk-gpu[54,56,91]
/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/colossalai
FLASH_ATTENTION_DISABLE=1
HF_TRANSFORMERS_CACHE_DISABLE_FLASH_ATTN_2=1
=== CUDA環境 ===
CUDA_HOME=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310
/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/nvcc
nvcc: NVIDIA (R) Cuda compiler driver
Copyright (c) 2005-2025 NVIDIA Corporation
Built on Tue_May_27_02:21:03_PDT_2025
Cuda compilation tools, release 12.9, V12.9.86
Build cuda_12.9.r12.9/compiler.36037853_0
=== Pythonライブラリのバージョン ===
python 3.10.18 (main, Jun  5 2025, 13:14:17) [GCC 11.2.0]
torch 2.4.1+cu124
torchvision 0.19.1+cu124
torchaudio 2.4.1+cu124
numpy 1.26.4
please install Colossal-AI from https://www.colossalai.org/download or from source
colossalai 0.0.0
transformers 4.46.3
PATH=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/condabin:/home/Competition2025/P02/P02U006/.local/bin:/home/Competition2025/P02/P02U006/bin:/usr/share/Modules/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin
LD_LIBRARY_PATH=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:
CPATH=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib/python3.10/site-packages/nvidia/cublas/include:
LIBRARY_PATH=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:
[after unset NCCL_NET_PLUGIN]
NCCL_NET_PLUGIN=none
NCCL_SOCKET_IFNAME=enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0
NCCL_DEBUG=INFO
NCCL_TIMEOUT=3600
NCCL_IB_HCA=mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1
TORCH_NCCL_BLOCKING_WAIT=1
TORCH_NCCL_ASYNC_ERROR_HANDLING=0
MASTER_ADDR=osk-gpu54  MASTER_PORT=13700
== [Pre-launch NCCL env] ==
NCCL_NET_PLUGIN=none
NCCL_SOCKET_IFNAME=enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0
NCCL_DEBUG=INFO
NCCL_TIMEOUT=3600
NCCL_IB_HCA=mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1
TORCH_NCCL_BLOCKING_WAIT=1
TORCH_NCCL_ASYNC_ERROR_HANDLING=0
please install Colossal-AI from https://www.colossalai.org/download or from source
please install Colossal-AI from https://www.colossalai.org/download or from source
please install Colossal-AI from https://www.colossalai.org/download or from source
please install Colossal-AI from https://www.colossalai.org/download or from source
please install Colossal-AI from https://www.colossalai.org/download or from source
please install Colossal-AI from https://www.colossalai.org/download or from source
please install Colossal-AI from https://www.colossalai.org/download or from source
please install Colossal-AI from https://www.colossalai.org/download or from source
Error: failed to run torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora on 127.0.0.1, is localhost: True, exception: Encountered a bad command exit code!

Command: 'cd /home/Competition2025/P02/P02U006/ColossalAI && export SHELL="/bin/bash" SLURM_GPUS_PER_NODE="8" GCC_RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ranlib" SLURM_JOB_USER="P02U006" SLURM_TASKS_PER_NODE="8(x3)" SLURM_JOB_UID="11034" HISTCONTROL="ignoredups" SLURM_TASK_PID="2009347" CONDA_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/conda" SLURM_JOB_GPUS="0,1,2,3,4,5,6,7" SLURM_LOCALID="5" build_alias="x86_64-conda-linux-gnu" SLURM_SUBMIT_DIR="/home/Competition2025/P02/P02U006/ColossalAI" CMAKE_ARGS="-DCMAKE_AR=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar -DCMAKE_RANLIB=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib -DCMAKE_LINKER=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld -DCMAKE_STRIP=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip -DCMAKE_BUILD_TYPE=Release" HOSTNAME="osk-gpu54" HISTSIZE="1000" SLURMD_NODENAME="osk-gpu54" FLASH_ATTENTION_DISABLE="1" MASTER_PORT="13700" GPROF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gprof" _CONDA_PYTHON_SYSCONFIGDATA_NAME="_sysconfigdata_x86_64_conda_cos7_linux_gnu" STRINGS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strings" CPP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cpp" NCCL_NET_PLUGIN="none" SLURM_NODE_ALIASES="(null)" SLURM_CLUSTER_NAME="osk-cluster" SLURM_CPUS_ON_NODE="8" SLURM_JOB_CPUS_PER_NODE="8(x3)" NCCL_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" SLURM_GPUS_ON_NODE="8" PWD="/home/Competition2025/P02/P02U006/ColossalAI" SLURM_GTIDS="0,1,2,3,4,5,6,7" GSETTINGS_SCHEMA_DIR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/share/glib-2.0/schemas" LOGNAME="P02U006" UCX_NET_DEVICES="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" XDG_SESSION_TYPE="tty" CONDA_PREFIX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" SLURM_JOB_PARTITION="P02" MODULESHOME="/usr/share/Modules" MANPATH="/usr/share/man:" ROCR_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" NCCL_DEBUG="INFO" SLURM_JOB_NUM_NODES="3" CXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" NCCL_TIMEOUT="3600" SLURM_JOBID="328550" GLOO_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" NCCL_IB_HCA="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" DEBUG_CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_JOB_QOS="normal" MOTD_SHOWN="pam" TORCH_NCCL_BLOCKING_WAIT="1" LDFLAGS="-Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,-rpath,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -Wl,-rpath-link,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib  -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib/stubs" __MODULES_SHARE_MANPATH=":1" HOME="/home/Competition2025/P02/P02U006" LANG="en_US.UTF-8" DEBUG_CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" LS_COLORS="rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=01;37;41:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.webp=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=01;36:*.au=01;36:*.flac=01;36:*.m4a=01;36:*.mid=01;36:*.midi=01;36:*.mka=01;36:*.mp3=01;36:*.mpc=01;36:*.ogg=01;36:*.ra=01;36:*.wav=01;36:*.oga=01;36:*.opus=01;36:*.spx=01;36:*.xspf=01;36:" NVCC_PREPEND_FLAGS=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++ -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" SLURM_PROCID="5" CXX_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" HF_TRANSFORMERS_CACHE_DISABLE_FLASH_ATTN_2="1" ELFEDIT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-elfedit" CONDA_PROMPT_MODIFIER="(deepseeksft310) " TMPDIR="/tmp" CMAKE_PREFIX_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot/usr" CUDACXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/nvcc" CPPFLAGS="-DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" SLURM_NTASKS="24" LD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld" SLURM_TOPOLOGY_ADDR="osk-gpu54" SSH_CONNECTION="100.113.255.14 54546 10.255.255.101 22" READELF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-readelf" ZE_AFFINITY_MASK="0,1,2,3,4,5,6,7" PYTORCH_CUDA_ALLOC_CONF="expandable_segments:True" GXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-g++" MASTER_ADDR="osk-gpu54" SLURM_TOPOLOGY_ADDR_PATTERN="node" CUDA_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" GCC_AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ar" ADDR2LINE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-addr2line" XDG_SESSION_CLASS="user" SLURM_WORKING_CLUSTER="osk-cluster:10.255.255.100:6817:9728:109" PYTHONPATH="/home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat:/home/Competition2025/P02/P02U006/ColossalAI:" TERM="xterm-256color" TORCH_NCCL_ASYNC_ERROR_HANDLING="0" GCC_NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-nm" SIZE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-size" HOST="x86_64-conda-linux-gnu" LESSOPEN="||/usr/bin/lesspipe.sh %s" CC_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" USER="P02U006" LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" SLURM_NODELIST="osk-gpu[54,56,91]" ENVIRONMENT="BATCH" GPU_DEVICE_ORDINAL="0,1,2,3,4,5,6,7" CONDA_SHLVL="1" MODULES_RUN_QUARANTINE="LD_LIBRARY_PATH LD_PRELOAD" AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar" AS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-as" DEBUG_CPPFLAGS="-D_DEBUG -D_FORTIFY_SOURCE=2 -Og -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_PRIO_PROCESS="0" host_alias="x86_64-conda-linux-gnu" SLURM_NPROCS="24" PYTHONFAULTHANDLER="1" SHLVL="2" SLURM_NNODES="3" NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-nm" GCC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc" PMIX_MCA_gds="^ds12" XDG_SESSION_ID="64665" SLURM_SUBMIT_HOST="osk-cpu01" LD_GOLD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld.gold" CONDA_PYTHON_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/python" LD_LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" XDG_RUNTIME_DIR="/run/user/11034" SLURM_JOB_ID="328550" UCX_MAX_RNDV_RAILS="8" SLURM_NODEID="0" SSH_CLIENT="100.113.255.14 54546 22" CONDA_DEFAULT_ENV="deepseeksft310" __MODULES_LMINIT="module use --append /home/appli/modulefiles:module use --append /usr/share/Modules/modulefiles:module use --append /etc/modulefiles:module use --append /usr/share/modulefiles" OBJCOPY="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objcopy" OMPI_MCA_coll_hcoll_enable="0" which_declare="declare -f" STRIP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip" CUDA_HOME="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" NVCC_PREPEND_FLAGS_BACKUP=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" XDG_DATA_DIRS="/home/Competition2025/P02/P02U006/.local/share/flatpak/exports/share:/var/lib/flatpak/exports/share:/usr/local/share:/usr/share" OBJDUMP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objdump" SLURM_CONF="/etc/slurm/slurm.conf" PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/condabin:/home/Competition2025/P02/P02U006/.local/bin:/home/Competition2025/P02/P02U006/bin:/usr/share/Modules/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin" SLURM_JOB_NAME="lora-r1" MODULEPATH="/etc/scl/modulefiles:/home/appli/modulefiles:/usr/share/Modules/modulefiles:/etc/modulefiles:/usr/share/modulefiles" CC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" SLURM_NTASKS_PER_NODE="8" CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" CXXFILT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++filt" DBUS_SESSION_BUS_ADDRESS="unix:path=/run/user/11034/bus" BUILD="x86_64-conda-linux-gnu" MAIL="/var/spool/mail/P02U006" SSH_TTY="/dev/pts/47" SLURM_JOB_GID="11034" CPATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib/python3.10/site-packages/nvidia/cublas/include:" RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib" CONDA_BUILD_SYSROOT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot" UCX_MAX_EAGER_RAILS="8" OLDPWD="/home/Competition2025/P02/P02U006" SLURM_JOB_NODELIST="osk-gpu[54,56,91]" MODULES_CMD="/usr/share/Modules/libexec/modulecmd.tcl" TORCH_ELASTIC_STORE_TIMEOUT="3600" _="/usr/bin/srun" SLURM_MPI_TYPE="pmix_v3" SRUN_DEBUG="3" SLURM_UMASK="0022" SLURM_JOB_CPUS_PER_NODE_PACK_GROUP_0="8(x3)" SLURM_DISTRIBUTION="block" SLURM_STEP_ID="0" SLURM_STEPID="0" SLURM_STEP_NODELIST="osk-gpu[54,56,91]" SLURM_STEP_NUM_NODES="3" SLURM_STEP_NUM_TASKS="24" SLURM_STEP_TASKS_PER_NODE="8(x3)" SLURM_STEP_LAUNCHER_PORT="32819" SLURM_SRUN_COMM_PORT="32819" SLURM_PMIXP_ABORT_AGENT_PORT="34205" SLURM_PMIX_MAPPING_SERV="(vector,(0,3,8))" SLURM_SRUN_COMM_HOST="192.168.11.54" SLURM_STEP_GPUS="0,1,2,3,4,5,6,7" SLURM_CPU_BIND="quiet,none" SLURM_CPU_BIND_TYPE="none" SLURM_CPU_BIND_VERBOSE="quiet" SLURM_LAUNCH_NODE_IPADDR="192.168.11.54" PMIX_NAMESPACE="slurm.pmix.328550.0" PMIX_RANK="5" PMIX_SERVER_URI3="pmix-server.2009332;tcp4://127.0.0.1:45561" PMIX_SERVER_URI2="pmix-server.2009332;tcp4://127.0.0.1:45561" PMIX_SERVER_URI21="pmix-server.2009332;tcp4://127.0.0.1:45561" PMIX_SECURITY_MODE="munge,native" PMIX_PTL_MODULE="tcp,usock" PMIX_BFROP_BUFFER_TYPE="PMIX_BFROP_BUFFER_NON_DESC" PMIX_GDS_MODULE="ds21,ds12,hash" PMIX_SERVER_TMPDIR="/var/spool/slurm/d/pmix.328550.0/" PMIX_SYSTEM_TMPDIR="/tmp" PMIX_DSTORE_21_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds21_2009332" PMIX_DSTORE_ESH_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds12_2009332" PMIX_HOSTNAME="osk-gpu54" PMIX_VERSION="3.2.3" CUDA_DEVICE_MAX_CONNECTIONS="1" && torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora'

Exit code: 1

Stdout: already printed

Stderr: already printed



====== Training on All Nodes =====
127.0.0.1: failure

====== Stopping All Nodes =====
127.0.0.1: finish
Error: failed to run torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora on 127.0.0.1, is localhost: True, exception: Encountered a bad command exit code!

Command: 'cd /home/Competition2025/P02/P02U006/ColossalAI && export SHELL="/bin/bash" SLURM_GPUS_PER_NODE="8" GCC_RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ranlib" SLURM_JOB_USER="P02U006" SLURM_TASKS_PER_NODE="8(x3)" SLURM_JOB_UID="11034" HISTCONTROL="ignoredups" SLURM_TASK_PID="2009343" CONDA_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/conda" SLURM_JOB_GPUS="0,1,2,3,4,5,6,7" SLURM_LOCALID="1" build_alias="x86_64-conda-linux-gnu" SLURM_SUBMIT_DIR="/home/Competition2025/P02/P02U006/ColossalAI" CMAKE_ARGS="-DCMAKE_AR=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar -DCMAKE_RANLIB=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib -DCMAKE_LINKER=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld -DCMAKE_STRIP=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip -DCMAKE_BUILD_TYPE=Release" HOSTNAME="osk-gpu54" HISTSIZE="1000" SLURMD_NODENAME="osk-gpu54" FLASH_ATTENTION_DISABLE="1" MASTER_PORT="13700" GPROF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gprof" _CONDA_PYTHON_SYSCONFIGDATA_NAME="_sysconfigdata_x86_64_conda_cos7_linux_gnu" STRINGS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strings" CPP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cpp" NCCL_NET_PLUGIN="none" SLURM_NODE_ALIASES="(null)" SLURM_CLUSTER_NAME="osk-cluster" SLURM_CPUS_ON_NODE="8" SLURM_JOB_CPUS_PER_NODE="8(x3)" NCCL_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" SLURM_GPUS_ON_NODE="8" PWD="/home/Competition2025/P02/P02U006/ColossalAI" SLURM_GTIDS="0,1,2,3,4,5,6,7" GSETTINGS_SCHEMA_DIR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/share/glib-2.0/schemas" LOGNAME="P02U006" UCX_NET_DEVICES="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" XDG_SESSION_TYPE="tty" CONDA_PREFIX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" SLURM_JOB_PARTITION="P02" MODULESHOME="/usr/share/Modules" MANPATH="/usr/share/man:" ROCR_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" NCCL_DEBUG="INFO" SLURM_JOB_NUM_NODES="3" CXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" NCCL_TIMEOUT="3600" SLURM_JOBID="328550" GLOO_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" NCCL_IB_HCA="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" DEBUG_CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_JOB_QOS="normal" MOTD_SHOWN="pam" TORCH_NCCL_BLOCKING_WAIT="1" LDFLAGS="-Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,-rpath,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -Wl,-rpath-link,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib  -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib/stubs" __MODULES_SHARE_MANPATH=":1" HOME="/home/Competition2025/P02/P02U006" LANG="en_US.UTF-8" DEBUG_CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" LS_COLORS="rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=01;37;41:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.webp=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=01;36:*.au=01;36:*.flac=01;36:*.m4a=01;36:*.mid=01;36:*.midi=01;36:*.mka=01;36:*.mp3=01;36:*.mpc=01;36:*.ogg=01;36:*.ra=01;36:*.wav=01;36:*.oga=01;36:*.opus=01;36:*.spx=01;36:*.xspf=01;36:" NVCC_PREPEND_FLAGS=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++ -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" SLURM_PROCID="1" CXX_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" HF_TRANSFORMERS_CACHE_DISABLE_FLASH_ATTN_2="1" ELFEDIT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-elfedit" CONDA_PROMPT_MODIFIER="(deepseeksft310) " TMPDIR="/tmp" CMAKE_PREFIX_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot/usr" CUDACXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/nvcc" CPPFLAGS="-DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" SLURM_NTASKS="24" LD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld" SLURM_TOPOLOGY_ADDR="osk-gpu54" SSH_CONNECTION="100.113.255.14 54546 10.255.Error: failed to run torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora on 127.0.0.1, is localhost: True, exception: Encountered a bad command exit code!

Command: 'cd /home/Competition2025/P02/P02U006/ColossalAI && export SHELL="/bin/bash" SLURM_GPUS_PER_NODE="8" GCC_RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ranlib" SLURM_JOB_USER="P02U006" SLURM_TASKS_PER_NODE="8(x3)" SLURM_JOB_UID="11034" HISTCONTROL="ignoredups" SLURM_TASK_PID="2009349" CONDA_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/conda" SLURM_JOB_GPUS="0,1,2,3,4,5,6,7" SLURM_LOCALID="7" build_alias="x86_64-conda-linux-gnu" SLURM_SUBMIT_DIR="/home/Competition2025/P02/P02U006/ColossalAI" CMAKE_ARGS="-DCMAKE_AR=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar -DCMAKE_RANLIB=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib -DCMAKE_LINKER=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld -DCMAKE_STRIP=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip -DCMAKE_BUILD_TYPE=Release" HOSTNAME="osk-gpu54" HISTSIZE="1000" SLURMD_NODENAME="osk-gpu54" FLASH_ATTENTION_DISABLE="1" MASTER_PORT="13700" GPROF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gprof" _CONDA_PYTHON_SYSCONFIGDATA_NAME="_sysconfigdata_x86_64_conda_cos7_linux_gnu" STRINGS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strings" CPP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cpp" NCCL_NET_PLUGIN="none" SLURM_NODE_ALIASES="(null)" SLURM_CLUSTER_NAME="osk-cluster" SLURM_CPUS_ON_NODE="8" SLURM_JOB_CPUS_PER_NODE="8(x3)" NCCL_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" SLURM_GPUS_ON_NODE="8" PWD="/home/Competition2025/P02/P02U006/ColossalAI" SLURM_GTIDS="0,1,2,3,4,5,6,7" GSETTINGS_SCHEMA_DIR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/share/glib-2.0/schemas" LOGNAME="P02U006" UCX_NET_DEVICES="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" XDG_SESSION_TYPE="tty" CONDA_PREFIX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" SLURM_JOB_PARTITION="P02" MODULESHOME="/usr/share/Modules" MANPATH="/usr/share/man:" ROCR_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" NCCL_DEBUG="INFO" SLURM_JOB_NUM_NODES="3" CXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" NCCL_TIMEOUT="3600" SLURM_JOBID="328550" GLOO_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" NCCL_IB_HCA="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_255.101 22" READELF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-readelf" ZE_AFFINITY_MASK="0,1,2,3,4,5,6,7" PYTORCH_CUDA_ALLOC_CONF="expandable_segments:True" GXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-g++" MASTER_ADDR="osk-gpu54" SLURM_TOPOLOGY_ADDR_PATTERN="node" CUDA_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" GCC_AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ar" ADDR2LINE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-addr2line" XDG_SESSION_CLASS="user" SLURM_WORKING_CLUSTER="osk-cluster:10.255.255.100:6817:9728:109" PYTHONPATH="/home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat:/home/Competition2025/P02/P02U006/ColossalAI:" TERM="xterm-256color" TORCH_NCCL_ASYNC_ERROR_HANDLING="0" GCC_NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-nm" SIZE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-size" HOST="x86_64-conda-linux-gnu" LESSOPEN="||/usr/bin/lesspipe.sh %s" CC_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" USER="P02U006" LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" SLURM_NODELIST="osk-gpu[54,56,91]" ENVIRONMENT="BATCH" GPU_DEVICE_ORDINAL="0,1,2,3,4,5,6,7" CONDA_SHLVL="1" MODULES_RUN_QUARANTINE="LD_LIBRARY_PATH LD_PRELOAD" AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar" AS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-as" DEBUG_CPPFLAGS="-D_DEBUG -D_FORTIFY_SOURCE=2 -Og -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_PRIO_PROCESS="0" host_alias="x86_64-conda-linux-gnu" SLURM_NPROCS="24" PYTHONFAULTHANDLER="1" SHLVL="2" SLURM_NNODES="3" NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-nm" GCC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc" PMIX_MCA_gds="^ds12" XDG_SESSION_ID="64665" SLURM_SUBMIT_HOST="osk-cpu01" LD_GOLD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld.gold" CONDA_PYTHON_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/python" LD_LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" XDG_RUNTIME_DIR="/run/user/11034" SLURM_JOB_ID="328550" UCX_MAX_RNDV_RAILS="8" SLURM_NODEID="0" SSH_CLIENT="100.113.255.14 54546 22" CONDA_DEFAULT_ENV="deepseeksft310" __MODULES_LMINIT="module use --append /home/appli/modulefiles:module use --append /usr/share/Modules/modulefiles:module use --append /etc/modulefiles:module use --append /usr/share/modulefiles" OBJCOPY="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objcopy" OMPI_MCA_coll_hcoll_enable="0" which_declare="declare -f" STRIP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip" CUDA_HOME="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" NVCC_PREPEND_FLAGS_BACKUP=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" XDG_DATA_DIRS="/home/Competition2025/P02/P02U006/.local/share/flatpak/exports/share:/var/lib/flatpak/exports/share:/usr/local/share:/usr/share" OBJDUMP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objdump" SLURM_CONF="/etc/slurm/slurm.conf" PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/condabin:/home/Competiti4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" DEBUG_CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_JOB_QOS="normal" MOTD_SHOWN="pam" TORCH_NCCL_BLOCKING_WAIT="1" LDFLAGS="-Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,-rpath,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -Wl,-rpath-link,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib  -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib/stubs" __MODULES_SHARE_MANPATH=":1" HOME="/home/Competition2025/P02/P02U006" LANG="en_US.UTF-8" DEBUG_CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" LS_COLORS="rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=01;37;41:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.webp=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=01;36:*.au=01;36:*.flac=01;36:*.m4a=01;36:*.mid=01;36:*.midi=01;36:*.mka=01;36:*.mp3=01;36:*.mpc=01;36:*.ogg=01;36:*.ra=01;36:*.wav=01;36:*.oga=01;36:*.opus=01;36:*.spx=01;36:*.xspf=01;36:" NVCC_PREPEND_FLAGS=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++ -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" SLURM_PROCID="7" CXX_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" HF_TRANSFORMERS_CACHE_DISABLE_FLASH_ATTN_2="1" ELFEDIT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-elfedit" CONDA_PROMPT_MODIFIER="(deepseeksft310) " TMPDIR="/tmp" CMAKE_PREFIX_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot/usr" CUDACXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/nvcc" CPPFLAGS="-DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" SLURM_NTASKS="24" LD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld" SLURM_TOPOLOGY_ADDR="osk-gpu54" SSH_CONNECTION="100.113.255.14 54546 10.255.on2025/P02/P02U006/.local/bin:/home/Competition2025/P02/P02U006/bin:/usr/share/Modules/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin" SLURM_JOB_NAME="lora-r1" MODULEPATH="/etc/scl/modulefiles:/home/appli/modulefiles:/usr/share/Modules/modulefiles:/etc/modulefiles:/usr/share/modulefiles" CC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" SLURM_NTASKS_PER_NODE="8" CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" CXXFILT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++filt" DBUS_SESSION_BUS_ADDRESS="unix:path=/run/user/11034/bus" BUILD="x86_64-conda-linux-gnu" MAIL="/var/spool/mail/P02U006" SSH_TTY="/dev/pts/47" SLURM_JOB_GID="11034" CPATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib/python3.10/site-packages/nvidia/cublas/include:" RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib" CONDA_BUILD_SYSROOT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot" UCX_MAX_EAGER_RAILS="8" OLDPWD="/home/Competition2025/P02/P02U006" SLURM_JOB_NODELIST="osk-gpu[54,56,91]" MODULES_CMD="/usr/share/Modules/libexec/modulecmd.tcl" TORCH_ELASTIC_STORE_TIMEOUT="3600" _="/usr/bin/srun" SLURM_MPI_TYPE="pmix_v3" SRUN_DEBUG="3" SLURM_UMASK="0022" SLURM_JOB_CPUS_PER_NODE_PACK_GROUP_0="8(x3)" SLURM_DISTRIBUTION="block" SLURM_STEP_ID="0" SLURM_STEPID="0" SLURM_STEP_NODELIST="osk-gpu[54,56,91]" SLURM_STEP_NUM_NODES="3" SLURM_STEP_NUM_TASKS="24" SLURM_STEP_TASKS_PER_NODE="8(x3)" SLURM_STEP_LAUNCHER_PORT="32819" SLURM_SRUN_COMM_PORT="32819" SLURM_PMIXP_ABORT_AGENT_PORT="34205" SLURM_PMIX_MAPPING_SERV="(vector,(0,3,8))" SLURM_SRUN_COMM_HOST="192.168.11.54" SLURM_STEP_GPUS="0,1,2,3,4,5,6,7" SLURM_CPU_BIND="quiet,none" SLURM_CPU_BIND_TYPE="none" SLURM_CPU_BIND_VERBOSE="quiet" SLURM_LAUNCH_NODE_IPADDR="192.168.11.54" PMIX_NAMESPACE="slurm.pmix.328550.0" PMIX_RANK="1" PMIX_SERVER_URI3="pmix-server.2009332;tcp4://127.0.0.1:45561" PMIX_SERVER_URI2="pmix-server.2009332;tcp4://127.0.0.1:45561" PMIX_SERVER_URI21="pmix-server.2009332;tcp4://127.0.0.1:45561" PMIX_SECURITY_MODE="munge,native" PMIX_PTL_MODULE="tcp,usock" PMIX_BFROP_BUFFER_TYPE="PMIX_BFROP_BUFFER_NON_DESC" PMIX_GDS_MODULE="ds21,ds12,hash" PMIX_SERVER_TMPDIR="/var/spool/slurm/d/pmix.328550.0/" PMIX_SYSTEM_TMPDIR="/tmp" PMIX_DSTORE_21_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds21_2009332" PMIX_DSTORE_ESH_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds12_2009332" PMIX_HOSTNAME="osk-gpu54" PMIX_VERSION="3.2.3" CUDA_DEVICE_MAX_CONNECTIONS="1" && torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora'

Exit code: 1

Stdout: already printed

Stderr: already printed


255.101 22" READELF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-readelf" ZE_AFFINITY_MASK="0,1,2,3,4,5,6,7" PYTORCH_CUDA_ALLOC_CONF="expandable_segments:True" GXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-g++" MASTER_ADDR="osk-gpu54" SLURM_TOPOLOGY_ADDR_PATTERN="node" CUDA_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" GCC_AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ar" ADDR2LINE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-addr2line" XDG_SESSION_CLASS="user" SLURM_WORKING_CLUSTER="osk-cluster:10.255.255.100:6817:9728:109" PYTHONPATH="/home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat:/home/Competition2025/P02/P02U006/ColossalAI:" TERM="xterm-256color" TORCH_NCCL_ASYNC_ERROR_HANDLING="0" GCC_NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-nm" SIZE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-size" HOST="x86_64-conda-linux-gnu" LESSOPEN="||/usr/bin/lesspipe.sh %s" CC_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" USER="P02U006" LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" SLURM_NODELIST="osk-gpu[54,56,91]" ENVIRONMENT="BATCH" GPU_DEVICE_ORDINAL="0,1,2,3,4,5,6,7" CONDA_SHLVL="1" MODULES_RUN_QUARANTINE="LD_LIBRARY_PATH LD_PRELOAD" AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar" AS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-as" DEBUG_CPPFLAGS="-D_DEBUG -D_FORTIFY_SOURCE=2 -Og -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_PRIO_PROCESS="0" host_alias="x86_64-conda-linux-gnu" SLURM_NPROCS="24" PYTHONFAULTHANDLER="1" SHLVL="2" SLURM_NNODES="3" NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-nm" GCC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc" PMIX_MCA_gds="^ds12" XDG_SESSION_ID="64665" SLURM_SUBMIT_HOST="osk-cpu01" LD_GOLD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld.gold" CONDA_PYTHON_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/python" LD_LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" XDG_RUNTIME_DIR="/run/user/11034" SLURM_JOB_ID="328550" UCX_MAX_RNDV_RAILS="8" SLURM_NODEID="0" SSH_CLIENT="100.113.255.14 54546 22" CONDA_DEFAULT_ENV="deepseeksft310" __MODULES_LMINIT="module use --append /home/appli/modulefiles:module use --append /usr/share/Modules/modulefiles:module use --append /etc/modulefiles:module use --append /usr/share/modulefiles" OBJCOPY="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objcopy" OMPI_MCA_coll_hcoll_enable="0" which_declare="declare -f" STRIP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip" CUDA_HOME="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" NVCC_PREPEND_FLAGS_BACKUP=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" XDG_DATA_DIRS="/home/Competition2025/P02/P02U006/.local/share/flatpak/exports/share:/var/lib/flatpak/exports/share:/usr/local/share:/usr/share" OBJDUMP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objdump" SLURM_CONF="/etc/slurm/slurm.conf" PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/condabin:/home/Competition2025/P02/P02U006/.local/bin:/home/Competition2025/P02/P02U006/bin:/usr/share/Modules/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin" SLURM_JOB_NAME="lora-r1" MODULEPATH="/etc/scl/modulefiles:/home/appli/modulefiles:/usr/share/Modules/modulefiles:/etc/modulefiles:/usr/share/modulefiles" CC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" SLURM_NTASKS_PER_NODE="8" CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" CXXFILT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++filt" DBUS_SESSION_BUS_ADDRESS="unix:path=/run/user/11034/bus" BUILD="x86_64-conda-linux-gnu" MAIL="/var/spool/mail/P02U006" SSH_TTY="/dev/pts/47" SLURM_JOB_GID="11034" CPATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib/python3.10/site-packages/nvidia/cublas/include:" RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib" CONDA_BUILD_SYSROOT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot" UCX_MAX_EAGER_RAILS="8" OLDPWD="/home/Competition2025/P02/P02U006" SLURM_JOB_NODELIST="osk-gpu[54,56,91]" MODULES_CMD="/usr/share/Modules/libexec/modulecmd.tcl" TORCH_ELASTIC_STORE_TIMEOUT="3600" _="/usr/bin/srun" SLURM_MPI_TYPE="pmix_v3" SRUN_DEBUG="3" SLURM_UMASK="0022" SLURM_JOB_CPUS_PER_NODE_PACK_GROUP_0="8(x3)" SLURM_DISTRIBUTION="block" SLURM_STEP_ID="0" SLURM_STEPID="0" SLURM_STEP_NODELIST="osk-gpu[54,56,91]" SLURM_STEP_NUM_NODES="3" SLURM_STEP_NUM_TASKS="24" SLURM_STEP_TASKS_PER_NODE="8(x3)" SLURM_STEP_LAUNCHER_PORT="32819" SLURM_SRUN_COMM_PORT="32819" SLURM_PMIXP_ABORT_AGENT_PORT="34205" SLURM_PMIX_MAPPING_SERV="(vector,(0,3,8))" SLURM_SRUN_COMM_HOST="192.168.11.54" SLURM_STEP_GPUS="0,1,2,3,4,5,6,7" SLURM_CPU_BIND="quiet,none" SLURM_CPU_BIND_TYPE="none" SLURM_CPU_BIND_VERBOSE="quiet" SLURM_LAUNCH_NODE_IPADDR="192.168.11.54" PMIX_NAMESPACE="slurm.pmix.328550.0" PMIX_RANK="7" PMIX_SERVER_URI3="pmix-server.2009332;tcp4://127.0.0.1:45561" PMIX_SERVER_URI2="pmix-server.2009332;tcp4://127.0.0.1:45561" PMIX_SERVER_URI21="pmix-server.2009332;tcp4://127.0.0.1:45561" PMIX_SECURITY_MODE="munge,native" PMIX_PTL_MODULE="tcp,usock" PMIX_BFROP_BUFFER_TYPE="PMIX_BFROP_BUFFER_NON_DESC" PMIX_GDS_MODULE="ds21,ds12,hash" PMIX_SERVER_TMPDIR="/var/spool/slurm/d/pmix.328550.0/" PMIX_SYSTEM_TMPDIR="/tmp" PMIX_DSTORE_21_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds21_2009332" PMIX_DSTORE_ESH_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds12_2009332" PMIX_HOSTNAME="osk-gpu54" PMIX_VERSION="3.2.3" CUDA_DEVICE_MAX_CONNECTIONS="1" && torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora'

Exit code: 1

Stdout: already printed

Stderr: already printed



====== Training on All Nodes =====
127.0.0.1: failure

====== Stopping All Nodes =====
127.0.0.1: finish

====== Training on All Nodes =====
127.0.0.1: failure
Error: failed to run torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora on 127.0.0.1, is localhost: True, exception: Encountered a bad command exit code!

Command: 'cd /home/Competition2025/P02/P02U006/ColossalAI && export SHELL="/bin/bash" SLURM_GPUS_PER_NODE="8" GCC_RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ranlib" SLURM_JOB_USER="P02U006" SLURM_TASKS_PER_NODE="8(x3)" SLURM_JOB_UID="11034" HISTCONTROL="ignoredups" SLURM_TASK_PID="2009342" CONDA_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/conda" SLURM_JOB_GPUS="0,1,2,3,4,5,6,7" SLURM_LOCALID="0" build_alias="x86_64-conda-linux-gnu" SLURM_SUBMIT_DIR="/home/Competition2025/P02/P02U006/ColossalAI" CMAKE_ARGS="-DCMAKE_AR=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar -DCMAKE_RANLIB=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib -DCMAKE_LINKER=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld -DCMAKE_STRIP=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip -DCMAKE_BUILD_TYPE=Release" HOSTNAME="osk-gpu54" HISTSIZE="1000" SLURMD_NODENAME="osk-gpu54" FLASH_ATTENTION_DISABLE="1" MASTER_PORT="13700" GPROF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gprof" _CONDA_PYTHON_SYSCONFIGDATA_NAME="_sysconfigdata_x86_64_conda_cos7_linux_gnu" STRINGS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strings" CPP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cpp" NCCL_NET_PLUGIN="none" SLURM_NODE_ALIASES="(null)" SLURM_CLUSTER_NAME="osk-cluster" SLURM_CPUS_ON_NODE="8" SLURM_JOB_CPUS_PER_NODE="8(x3)" NCCL_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" SLURM_GPUS_ON_NODE="8" PWD="/home/Competition2025/P02/P02U006/ColossalAI" SLURM_GTIDS="0,1,2,3,4,5,6,7" GSETTINGS_SCHEMA_DIR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/share/glib-2.0/schemas" LOGNAME="P02U006" UCX_NET_DEVICES="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" XDG_SESSION_TYPE="tty" CONDA_PREFIX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" SLURM_JOB_PARTITION="P02" MODULESHOME="/usr/share/Modules" MANPATH="/usr/share/man:" ROCR_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" NCCL_DEBUG="INFO" SLURM_JOB_NUM_NODES="3" CXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" NCCL_TIMEOUT="3600" SLURM_JOBID="328550" GLOO_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" NCCL_IB_HCA="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" DEBUG_CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_JOB_QOS="normal" MOTD_SHOWN="pam" TORCH_NCCL_BLOCKING_WAIT="1" LDFLAGS="-Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,-rpath,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -Wl,-rpath-link,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib  -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib/stubs" __MODULES_SHARE_MANPATH=":1" HOME="/home/Competition2025/P02/P02U006" LANG="en_US.UTF-8" DEBUG_CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" LS_COLORS="rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=01;37;41:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.webp=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=01;36:*.au=01;36:*.flac=01;36:*.m4a=01;36:*.mid=01;36:*.midi=01;36:*.mka=01;36:*.mp3=01;36:*.mpc=01;36:*.ogg=01;36:*.ra=01;36:*.wav=01;36:*.oga=01;36:*.opus=01;36:*.spx=01;36:*.xspf=01;36:" NVCC_PREPEND_FLAGS=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++ -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" SLURM_PROCID="0" CXX_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" HF_TRANSFORMERS_CACHE_DISABLE_FLASH_ATTN_2="1" ELFEDIT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-elfedit" CONDA_PROMPT_MODIFIER="(deepseeksft310) " TMPDIR="/tmp" CMAKE_PREFIX_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot/usr" CUDACXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/nvcc" CPPFLAGS="-DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" SLURM_NTASKS="24" LD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld" SLURM_TOPOLOGY_ADDR="osk-gpu54" SSH_CONNECTION="100.113.255.14 54546 10.255.255.101 22" READELF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-readelf" ZE_AFFINITY_MASK="0,1,2,3,4,5,6,7" PYTORCH_CUDA_ALLOC_CONF="expandable_segments:True" GXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-g++" MASTER_ADDR="osk-gpu54" SLURM_TOPOLOGY_ADDR_PATTERN="node" CUDA_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" GCC_AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ar" ADDR2LINE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-addr2line" XDG_SESSION_CLASS="user" SLURM_WORKING_CLUSTER="osk-cluster:10.255.255.100:6817:9728:109" PYTHONPATH="/home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat:/home/Competition2025/P02/P02U006/ColossalAI:" TERM="xterm-256color" TORCH_NCCL_ASYNC_ERROR_HANDLING="0" GCC_NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-nm" SIZE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-size" HOST="x86_64-conda-linux-gnu" LESSOPEN="||/usr/bin/lesspipe.sh %s" CC_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" USER="P02U006" LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" SLURM_NODELIST="osk-gpu[54,56,91]" ENVIRONMENT="BATCH" GPU_DEVICE_ORDINAL="0,1,2,3,4,5,6,7" CONDA_SHLVL="1" MODULES_RUN_QUARANTINE="LD_LIBRARY_PATH LD_PRELOAD" AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar" AS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-as" DEBUG_CPPFLAGS="-D_DEBUG -D_FORTIFY_SOURCE=2 -Og -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_PRIO_PROCESS="0" host_alias="x86_64-conda-linux-gnu" SLURM_NPROCS="24" PYTHONFAULTHANDLER="1" SHLVL="2" SLURM_NNODES="3" NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-nm" GCC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc" PMIX_MCA_gds="^ds12" XDG_SESSION_ID="64665" SLURM_SUBMIT_HOST="osk-cpu01" LD_GOLD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld.gold" CONDA_PYTHON_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/python" LD_LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" XDG_RUNTIME_DIR="/run/user/11034" SLURM_JOB_ID="328550" UCX_MAX_RNDV_RAILS="8" SLURM_NODEID="0" SSH_CLIENT="100.113.255.14 54546 22" CONDA_DEFAULT_ENV="deepseeksft310" __MODULES_LMINIT="module use --append /home/appli/modulefiles:module use --append /usr/share/Modules/modulefiles:module use --append /etc/modulefiles:module use --append /usr/share/modulefiles" OBJCOPY="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objcopy" OMPI_MCA_coll_hcoll_enable="0" which_declare="declare -f" STRIP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip" CUDA_HOME="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" NVCC_PREPEND_FLAGS_BACKUP=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" XDG_DATA_DIRS="/home/Competition2025/P02/P02U006/.local/share/flatpak/exports/share:/var/lib/flatpak/exports/share:/usr/local/share:/usr/share" OBJDUMP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objdump" SLURM_CONF="/etc/slurm/slurm.conf" PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/condabin:/home/Competition2025/P02/P02U006/.local/bin:/home/Competition2025/P02/P02U006/bin:/usr/share/Modules/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin" SLURM_JOB_NAME="lora-r1" MODULEPATH="/etc/scl/modulefiles:/home/appli/modulefiles:/usr/share/Modules/modulefiles:/etc/modulefiles:/usr/share/modulefiles" CC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" SLURM_NTASKS_PER_NODE="8" CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" CXXFILT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++filt" DBUS_SESSION_BUS_ADDRESS="unix:path=/run/user/11034/bus" BUILD="x86_64-conda-linux-gnu" MAIL="/var/spool/mail/P02U006" SSH_TTY="/dev/pts/47" SLURM_JOB_GID="11034" CPATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib/python3.10/site-packages/nvidia/cublas/include:" RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib" CONDA_BUILD_SYSROOT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot" UCX_MAX_EAGER_RAILS="8" OLDPWD="/home/Competition2025/P02/P02U006" SLURM_JOB_NODELIST="osk-gpu[54,56,91]" MODULES_CMD="/usr/share/Modules/libexec/modulecmd.tcl" TORCH_ELASTIC_STORE_TIMEOUT="3600" _="/usr/bin/srun" SLURM_MPI_TYPE="pmix_v3" SRUN_DEBUG="3" SLURM_UMASK="0022" SLURM_JOB_CPUS_PER_NODE_PACK_GROUP_0="8(x3)" SLURM_DISTRIBUTION="block" SLURM_STEP_ID="0" SLURM_STEPID="0" SLURM_STEP_NODELIST="osk-gpu[54,56,91]" SLURM_STEP_NUM_NODES="3" SLURM_STEP_NUM_TASKS="24" SLURM_STEP_TASKS_PER_NODE="8(x3)" SLURM_STEP_LAUNCHER_PORT="32819" SLURM_SRUN_COMM_PORT="32819" SLURM_PMIXP_ABORT_AGENT_PORT="34205" SLURM_PMIX_MAPPING_SERV="(vector,(0,3,8))" SLURM_SRUN_COMM_HOST="192.168.11.54" SLURM_STEP_GPUS="0,1,2,3,4,5,6,7" SLURM_CPU_BIND="quiet,none" SLURM_CPU_BIND_TYPE="none" SLURM_CPU_BIND_VERBOSE="quiet" SLURM_LAUNCH_NODE_IPADDR="192.168.11.54" PMIX_NAMESPACE="slurm.pmix.328550.0" PMIX_RANK="0" PMIX_SERVER_URI3="pmix-server.2009332;tcp4://127.0.0.1:45561" PMIX_SERVER_URI2="pmix-server.2009332;tcp4://127.0.0.1:45561" PMIX_SERVER_URI21="pmix-server.2009332;tcp4://127.0.0.1:45561" PMIX_SECURITY_MODE="munge,native" PMIX_PTL_MODULE="tcp,usock" PMIX_BFROP_BUFFER_TYPE="PMIX_BFROP_BUFFER_NON_DESC" PMIX_GDS_MODULE="ds21,ds12,hash" PMIX_SERVER_TMPDIR="/var/spool/slurm/d/pmix.328550.0/" PMIX_SYSTEM_TMPDIR="/tmp" PMIX_DSTORE_21_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds21_2009332" PMIX_DSTORE_ESH_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds12_2009332" PMIX_HOSTNAME="osk-gpu54" PMIX_VERSION="3.2.3" CUDA_DEVICE_MAX_CONNECTIONS="1" && torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora'

Exit code: 1

Stdout: already printed

Stderr: already printed



====== Training on All Nodes =====
127.0.0.1: failure

====== Stopping All Nodes =====
127.0.0.1: finish

====== Stopping All Nodes =====
127.0.0.1: finish
Error: failed to run torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora on 127.0.0.1, is localhost: True, exception: Encountered a bad command exit code!

Command: 'cd /home/Competition2025/P02/P02U006/ColossalAI && export SHELL="/bin/bash" SLURM_GPUS_PER_NODE="8" GCC_RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ranlib" SLURM_JOB_USER="P02U006" SLURM_TASKS_PER_NODE="8(x3)" SLURM_JOB_UID="11034" HISTCONTROL="ignoredups" SLURM_TASK_PID="2009345" CONDA_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/conda" SLURM_JOB_GPUS="0,1,2,3,4,5,6,7" SLURM_LOCALID="3" build_alias="x86_64-conda-linux-gnu" SLURM_SUBMIT_DIR="/home/Competition2025/P02/P02U006/ColossalAI" CMAKE_ARGS="-DCMAKE_AR=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar -DCMAKE_RANLIB=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib -DCMAKE_LINKER=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld -DCMAKE_STRIP=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip -DCMAKE_BUILD_TYPE=Release" HOSTNAME="osk-gpu54" HISTSIZE="1000" SLURMD_NODENAME="osk-gpu54" FLASH_ATTENTION_DISABLE="1" MASTER_PORT="13700" GPROF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gprof" _CONDA_PYTHON_SYSCONFIGDATA_NAME="_sysconfigdata_x86_64_conda_cos7_linux_gnu" STRINGS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strings" CPP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cpp" NCCL_NET_PLUGIN="none" SLURM_NODE_ALIASES="(null)" SLURM_CLUSTER_NAME="osk-cluster" SLURM_CPUS_ON_NODE="8" SLURM_JOB_CPUS_PER_NODE="8(x3)" NCCL_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" SLURM_GPUS_ON_NODE="8" PWD="/home/Competition2025/P02/P02U006/ColossalAI" SLURM_GTIDS="0,1,2,3,4,5,6,7" GSETTINGS_SCHEMA_DIR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/share/glib-2.0/schemas" LOGNAME="P02U006" UCX_NET_DEVICES="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" XDG_SESSION_TYPE="tty" CONDA_PREFIX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" SLURM_JOB_PARTITION="P02" MODULESHOME="/usr/share/Modules" MANPATH="/usr/share/man:" ROCR_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" NCCL_DEBUG="INFO" SLURM_JOB_NUM_NODES="3" CXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" NCCL_TIMEOUT="3600" SLURM_JOBID="328550" GLOO_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" NCCL_IB_HCA="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" DEBUG_CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_JOB_QOS="normal" MOTD_SHOWN="pam" TORCH_NCCL_BLOCKING_WAIT="1" LDFLAGS="-Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,-rpath,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -Wl,-rpath-link,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib  -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib/stubs" __MODULES_SHARE_MANPATH=":1" HOME="/home/Competition2025/P02/P02U006" LANG="en_US.UTF-8" DEBUG_CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" LS_COLORS="rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=01;37;41:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.webp=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=01;36:*.au=01;36:*.flac=01;36:*.m4a=01;36:*.mid=01;36:*.midi=01;36:*.mka=01;36:*.mp3=01;36:*.mpc=01;36:*.ogg=01;36:*.ra=01;36:*.wav=01;36:*.oga=01;36:*.opus=01;36:*.spx=01;36:*.xspf=01;36:" NVCC_PREPEND_FLAGS=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++ -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" SLURM_PROCID="3" CXX_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" HF_TRANSFORMERS_CACHE_DISABLE_FLASH_ATTN_2="1" ELFEDIT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-elfedit" CONDA_PROMPT_MODIFIER="(deepseeksft310) " TMPDIR="/tmp" CMAKE_PREFIX_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot/usr" CUDACXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/nvcc" CPPFLAGS="-DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" SLURM_NTASKS="24" LD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld" SLURM_TOPOLOGY_ADDR="osk-gpu54" SSH_CONNECTION="100.113.255.14 54546 10.255.255.101 22" READELF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-readelf" ZE_AFFINITY_MASK="0,1,2,3,4,5,6,7" PYTORCH_CUDA_ALLOC_CONF="expandable_segments:True" GXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-g++" MASTER_ADDR="osk-gpu54" SLURM_TOPOLOGY_ADDR_PATTERN="node" CUDA_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" GCC_AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ar" ADDR2LINE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-addr2line" XDG_SESSION_CLASS="user" SLURM_WORKING_CLUSTER="osk-cluster:10.255.255.100:6817:9728:109" PYTHONPATH="/home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat:/home/Competition2025/P02/P02U006/ColossalAI:" TERM="xterm-256color" TORCH_NCCL_ASYNC_ERROR_HANDLING="0" GCC_NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-nm" SIZE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-size" HOST="x86_64-conda-linux-gnu" LESSOPEN="||/usr/bin/lesspipe.sh %s" CC_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" USER="P02U006" LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" SLURM_NODELIST="osk-gpu[54,56,91]" ENVIRONMENT="BATCH" GPU_DEVICE_ORDINAL="0,1,2,3,4,5,6,7" CONDA_SHLVL="1" MODULES_RUN_QUARANTINE="LD_LIBRARY_PATH LD_PRELOAD" AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar" AS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-as" DEBUG_CPPFLAGS="-D_DEBUG -D_FORTIFY_SOURCE=2 -Og -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_PRIO_PROCESS="0" host_alias="x86_64-conda-linux-gnu" SLURM_NPROCS="24" PYTHONFAULTHANDLER="1" SHLVL="2" SLURM_NNODES="3" NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-nm" GCC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc" PMIX_MCA_gds="^ds12" XDG_SESSION_ID="64665" SLURM_SUBMIT_HOST="osk-cpu01" LD_GOLD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld.gold" CONDA_PYTHON_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/python" LD_LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" XDG_RUNTIME_DIR="/run/user/11034" SLURM_JOB_ID="328550" UCX_MAX_RNDV_RAILS="8" SLURM_NODEID="0" SSH_CLIENT="100.113.255.14 54546 22" CONDA_DEFAULT_ENV="deepseeksft310" __MODULES_LMINIT="module use --append /home/appli/modulefiles:module use --append /usr/share/Modules/modulefiles:module use --append /etc/modulefiles:module use --append /usr/share/modulefiles" OBJCOPY="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objcopy" OMPI_MCA_coll_hcoll_enable="0" which_declare="declare -f" STRIP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip" CUDA_HOME="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" NVCC_PREPEND_FLAGS_BACKUP=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" XDG_DATA_DIRS="/home/Competition2025/P02/P02U006/.local/share/flatpak/exports/share:/var/lib/flatpak/exports/share:/usr/local/share:/usr/share" OBJDUMP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objdump" SLURM_CONF="/etc/slurm/slurm.conf" PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/condabin:/home/Competition2025/P02/P02U006/.local/bin:/home/Competition2025/P02/P02U006/bin:/usr/share/Modules/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin" SLURM_JOB_NAME="lora-r1" MODULEPATH="/etc/scl/modulefiles:/home/appli/modulefiles:/usr/share/Modules/modulefiles:/etc/modulefiles:/usr/share/modulefiles" CC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" SLURM_NTASKS_PER_NODE="8" CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" CXXFILT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++filt" DBUS_SESSION_BUS_ADDRESS="unix:path=/run/user/11034/bus" BUILD="x86_64-conda-linux-gnu" MAIL="/var/spool/mail/P02U006" SSH_TTY="/dev/pts/47" SLURM_JOB_GID="11034" CPATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib/python3.10/site-packages/nvidia/cublas/include:" RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib" CONDA_BUILD_SYSROOT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot" UCX_MAX_EAGER_RAILS="8" OLDPWD="/home/Competition2025/P02/P02U006" SLURM_JOB_NODELIST="osk-gpu[54,56,91]" MODULES_CMD="/usr/share/Modules/libexec/modulecmd.tcl" TORCH_ELASTIC_STORE_TIMEOUT="3600" _="/usr/bin/srun" SLURM_MPI_TYPE="pmix_v3" SRUN_DEBUG="3" SLURM_UMASK="0022" SLURM_JOB_CPUS_PER_NODE_PACK_GROUP_0="8(x3)" SLURM_DISTRIBUTION="block" SLURM_STEP_ID="0" SLURM_STEPID="0" SLURM_STEP_NODELIST="osk-gpu[54,56,91]" SLURM_STEP_NUM_NODES="3" SLURM_STEP_NUM_TASKS="24" SLURM_STEP_TASKS_PER_NODE="8(x3)" SLURM_STEP_LAUNCHER_PORT="32819" SLURM_SRUN_COMM_PORT="32819" SLURM_PMIXP_ABORT_AGENT_PORT="34205" SLURM_PMIX_MAPPING_SERV="(vector,(0,3,8))" SLURM_SRUN_COMM_HOST="192.168.11.54" SLURM_STEP_GPUS="0,1,2,3,4,5,6,7" SLURM_CPU_BIND="quiet,none" SLURM_CPU_BIND_TYPE="none" SLURM_CPU_BIND_VERBOSE="quiet" SLURM_LAUNCH_NODE_IPADDR="192.168.11.54" PMIX_NAMESPACE="slurm.pmix.328550.0" PMIX_RANK="3" PMIX_SERVER_URI3="pmix-server.2009332;tcp4://127.0.0.1:45561" PMIX_SERVER_URI2="pmix-server.2009332;tcp4://127.0.0.1:45561" PMIX_SERVER_URI21="pmix-server.2009332;tcp4://127.0.0.1:45561" PMIX_SECURITY_MODE="munge,native" PMIX_PTL_MODULE="tcp,usock" PMIX_BFROP_BUFFER_TYPE="PMIX_BFROP_BUFFER_NON_DESC" PMIX_GDS_MODULE="ds21,ds12,hash" PMIX_SERVER_TMPDIR="/var/spool/slurm/d/pmix.328550.0/" PMIX_SYSTEM_TMPDIR="/tmp" PMIX_DSTORE_21_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds21_2009332" PMIX_DSTORE_ESH_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds12_2009332" PMIX_HOSTNAME="osk-gpu54" PMIX_VERSION="3.2.3" CUDA_DEVICE_MAX_CONNECTIONS="1" && torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora'

Exit code: 1

Stdout: already printed

Stderr: already printed



====== Training on All Nodes =====
127.0.0.1: failure
Error: failed to run torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora on 127.0.0.1, is localhost: True, exception: Encountered a bad command exit code!

Command: 'cd /home/Competition2025/P02/P02U006/ColossalAI && export SHELL="/bin/bash" SLURM_GPUS_PER_NODE="8" GCC_RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ranlib" SLURM_JOB_USER="P02U006" SLURM_TASKS_PER_NODE="8(x3)" SLURM_JOB_UID="11034" HISTCONTROL="ignoredups" SLURM_TASK_PID="2009346" CONDA_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/conda" SLURM_JOB_GPUS="0,1,2,3,4,5,6,7" SLURM_LOCALID="4" build_alias="x86_64-conda-linux-gnu" SLURM_SUBMIT_DIR="/home/Competition2025/P02/P02U006/ColossalAI" CMAKE_ARGS="-DCMAKE_AR=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar -DCMAKE_RANLIB=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib -DCMAKE_LINKER=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld -DCMAKE_STRIP=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip -DCMAKE_BUILD_TYPE=Release" HOSTNAME="osk-gpu54" HISTSIZE="1000" SLURMD_NODENAME="osk-gpu54" FLASH_ATTENTION_DISABLE="1" MASTER_PORT="13700" GPROF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gprof" _CONDA_PYTHON_SYSCONFIGDATA_NAME="_sysconfigdata_x86_64_conda_cos7_linux_gnu" STRINGS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strings" CPP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cpp" NCCL_NET_PLUGIN="none" SLURM_NODE_ALIASES="(null)" SLURM_CLUSTER_NAME="osk-cluster" SLURM_CPUS_ON_NODE="8" SLURM_JOB_CPUS_PER_NODE="8(x3)" NCCL_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" SLURM_GPUS_ON_NODE="8" PWD="/home/Competition2025/P02/P02U006/ColossalAI" SLURM_GTIDS="0,1,2,3,4,5,6,7" GSETTINGS_SCHEMA_DIR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/share/glib-2.0/schemas" LOGNAME="P02U006" UCX_NET_DEVICES="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" XDG_SESSION_TYPE="tty" CONDA_PREFIX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" SLURM_JOB_PARTITION="P02" MODULESHOME="/usr/share/Modules" MANPATH="/usr/share/man:" ROCR_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" NCCL_DEBUG="INFO" SLURM_JOB_NUM_NODES="3" CXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" NCCL_TIMEOUT="3600" SLURM_JOBID="328550" GLOO_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" NCCL_IB_HCA="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" DEBUG_CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_JOB_QOS="normal" MOTD_SHOWN="pam" TORCH_NCCL_BLOCKING_WAIT="1" LDFLAGS="-Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,-rpath,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -Wl,-rpath-link,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib  -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib/stubs" __MODULES_SHARE_MANPATH=":1" HOME="/home/Competition2025/P02/P02U006" LANG="en_US.UTF-8" DEBUG_CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" LS_COLORS="rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=01;37;41:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.webp=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=01;36:*.au=01;36:*.flac=01;36:*.m4a=01;36:*.mid=01;36:*.midi=01;36:*.mka=01;36:*.mp3=01;36:*.mpc=01;36:*.ogg=01;36:*.ra=01;36:*.wav=01;36:*.oga=01;36:*.opus=01;36:*.spx=01;36:*.xspf=01;36:" NVCC_PREPEND_FLAGS=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++ -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" SLURM_PROCID="4" CXX_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" HF_TRANSFORMERS_CACHE_DISABLE_FLASH_ATTN_2="1" ELFEDIT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-elfedit" CONDA_PROMPT_MODIFIER="(deepseeksft310) " TMPDIR="/tmp" CMAKE_PREFIX_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot/usr" CUDACXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/nvcc" CPPFLAGS="-DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" SLURM_NTASKS="24" LD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld" SLURM_TOPOLOGY_ADDR="osk-gpu54" SSH_CONNECTION="100.113.255.14 54546 10.255.255.101 22" READELF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-readelf" ZE_AFFINITY_MASK="0,1,2,3,4,5,6,7" PYTORCH_CUDA_ALLOC_CONF="expandable_segments:True" GXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-g++" MASTER_ADDR="osk-gpu54" SLURM_TOPOLOGY_ADDR_PATTERN="node" CUDA_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" GCC_AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ar" ADDR2LINE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-addr2line" XDG_SESSION_CLASS="user" SLURM_WORKING_CLUSTER="osk-cluster:10.255.255.100:6817:9728:109" PYTHONPATH="/home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat:/home/Competition2025/P02/P02U006/ColossalAI:" TERM="xterm-256color" TORCH_NCCL_ASYNC_ERROR_HANDLING="0" GCC_NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-nm" SIZE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-size" HOST="x86_64-conda-linux-gnu" LESSOPEN="||/usr/bin/lesspipe.sh %s" CC_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" USER="P02U006" LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" SLURM_NODELIST="osk-gpu[54,56,91]" ENVIRONMENT="BATCH" GPU_DEVICE_ORDINAL="0,1,2,3,4,5,6,7" CONDA_SHLVL="1" MODULES_RUN_QUARANTINE="LD_LIBRARY_PATH LD_PRELOAD" AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar" AS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-as" DEBUG_CPPFLAGS="-D_DEBUG -D_FORTIFY_SOURCE=2 -Og -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_PRIO_PROCESS="0" host_alias="x86_64-conda-linux-gnu" SLURM_NPROCS="24" PYTHONFAULTHANDLER="1" SHLVL="2" SLURM_NNODES="3" NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-nm" GCC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc" PMIX_MCA_gds="^ds12" XDG_SESSION_ID="64665" SLURM_SUBMIT_HOST="osk-cpu01" LD_GOLD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld.gold" CONDA_PYTHON_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/python" LD_LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" XDG_RUNTIME_DIR="/run/user/11034" SLURM_JOB_ID="328550" UCX_MAX_RNDV_RAILS="8" SLURM_NODEID="0" SSH_CLIENT="100.113.255.14 54546 22" CONDA_DEFAULT_ENV="deepseeksft310" __MODULES_LMINIT="module use --append /home/appli/modulefiles:module use --append /usr/share/Modules/modulefiles:module use --append /etc/modulefiles:module use --append /usr/share/modulefiles" OBJCOPY="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objcopy" OMPI_MCA_coll_hcoll_enable="0" which_declare="declare -f" STRIP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip" CUDA_HOME="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" NVCC_PREPEND_FLAGS_BACKUP=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" XDG_DATA_DIRS="/home/Competition2025/P02/P02U006/.local/share/flatpak/exports/share:/var/lib/flatpak/exports/share:/usr/local/share:/usr/share" OBJDUMP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objdump" SLURM_CONF="/etc/slurm/slurm.conf" PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/condabin:/home/Competition2025/P02/P02U006/.local/bin:/home/Competition2025/P02/P02U006/bin:/usr/share/Modules/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin" SLURM_JOB_NAME="lora-r1" MODULEPATH="/etc/scl/modulefiles:/home/appli/modulefiles:/usr/share/Modules/modulefiles:/etc/modulefiles:/usr/share/modulefiles" CC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" SLURM_NTASKS_PER_NODE="8" CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" CXXFILT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++filt" DBUS_SESSION_BUS_ADDRESS="unix:path=/run/user/11034/bus" BUILD="x86_64-conda-linux-gnu" MAIL="/var/spool/mail/P02U006" SSH_TTY="/dev/pts/47" SLURM_JOB_GID="11034" CPATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib/python3.10/site-packages/nvidia/cublas/include:" RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib" CONDA_BUILD_SYSROOT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot" UCX_MAX_EAGER_RAILS="8" OLDPWD="/home/Competition2025/P02/P02U006" SLURM_JOB_NODELIST="osk-gpu[54,56,91]" MODULES_CMD="/usr/share/Modules/libexec/modulecmd.tcl" TORCH_ELASTIC_STORE_TIMEOUT="3600" _="/usr/bin/srun" SLURM_MPI_TYPE="pmix_v3" SRUN_DEBUG="3" SLURM_UMASK="0022" SLURM_JOB_CPUS_PER_NODE_PACK_GROUP_0="8(x3)" SLURM_DISTRIBUTION="block" SLURM_STEP_ID="0" SLURM_STEPID="0" SLURM_STEP_NODELIST="osk-gpu[54,56,91]" SLURM_STEP_NUM_NODES="3" SLURM_STEP_NUM_TASKS="24" SLURM_STEP_TASKS_PER_NODE="8(x3)" SLURM_STEP_LAUNCHER_PORT="32819" SLURM_SRUN_COMM_PORT="32819" SLURM_PMIXP_ABORT_AGENT_PORT="34205" SLURM_PMIX_MAPPING_SERV="(vector,(0,3,8))" SLURM_SRUN_COMM_HOST="192.168.11.54" SLURM_STEP_GPUS="0,1,2,3,4,5,6,7" SLURM_CPU_BIND="quiet,none" SLURM_CPU_BIND_TYPE="none" SLURM_CPU_BIND_VERBOSE="quiet" SLURM_LAUNCH_NODE_IPADDR="192.168.11.54" PMIX_NAMESPACE="slurm.pmix.328550.0" PMIX_RANK="4" PMIX_SERVER_URI3="pmix-server.2009332;tcp4://127.0.0.1:45561" PMIX_SERVER_URI2="pmix-server.2009332;tcp4://127.0.0.1:45561" PMIX_SERVER_URI21="pmix-server.2009332;tcp4://127.0.0.1:45561" PMIX_SECURITY_MODE="munge,native" PMIX_PTL_MODULE="tcp,usock" PMIX_BFROP_BUFFER_TYPE="PMIX_BFROP_BUFFER_NON_DESC" PMIX_GDS_MODULE="ds21,ds12,hash" PMIX_SERVER_TMPDIR="/var/spool/slurm/d/pmix.328550.0/" PMIX_SYSTEM_TMPDIR="/tmp" PMIX_DSTORE_21_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds21_2009332" PMIX_DSTORE_ESH_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds12_2009332" PMIX_HOSTNAME="osk-gpu54" PMIX_VERSION="3.2.3" CUDA_DEVICE_MAX_CONNECTIONS="1" && torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora'

Exit code: 1

Stdout: already printed

Stderr: already printed



====== Training on All Nodes =====
127.0.0.1: failure

====== Stopping All Nodes =====
127.0.0.1: finish

====== Stopping All Nodes =====
127.0.0.1: finish
Error: failed to run torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora on 127.0.0.1, is localhost: True, exception: Encountered a bad command exit code!

Command: 'cd /home/Competition2025/P02/P02U006/ColossalAI && export SHELL="/bin/bash" SLURM_GPUS_PER_NODE="8" GCC_RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ranlib" SLURM_JOB_USER="P02U006" SLURM_TASKS_PER_NODE="8(x3)" SLURM_JOB_UID="11034" HISTCONTROL="ignoredups" SLURM_TASK_PID="2009348" CONDA_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/conda" SLURM_JOB_GPUS="0,1,2,3,4,5,6,7" SLURM_LOCALID="6" build_alias="x86_64-conda-linux-gnu" SLURM_SUBMIT_DIR="/home/Competition2025/P02/P02U006/ColossalAI" CMAKE_ARGS="-DCMAKE_AR=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar -DCMAKE_RANLIB=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib -DCMAKE_LINKER=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld -DCMAKE_STRIP=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip -DCMAKE_BUILD_TYPE=Release" HOSTNAME="osk-gpu54" HISTSIZE="1000" SLURMD_NODENAME="osk-gpu54" FLASH_ATTENTION_DISABLE="1" MASTER_PORT="13700" GPROF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gprof" _CONDA_PYTHON_SYSCONFIGDATA_NAME="_sysconfigdata_x86_64_conda_cos7_linux_gnu" STRINGS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strings" CPP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cpp" NCCL_NET_PLUGIN="none" SLURM_NODE_ALIASES="(null)" SLURM_CLUSTER_NAME="osk-cluster" SLURM_CPUS_ON_NODE="8" SLURM_JOB_CPUS_PER_NODE="8(x3)" NCCL_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" SLURM_GPUS_ON_NODE="8" PWD="/home/Competition2025/P02/P02U006/ColossalAI" SLURM_GTIDS="0,1,2,3,4,5,6,7" GSETTINGS_SCHEMA_DIR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/share/glib-2.0/schemas" LOGNAME="P02U006" UCX_NET_DEVICES="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" XDG_SESSION_TYPE="tty" CONDA_PREFIX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" SLURM_JOB_PARTITION="P02" MODULESHOME="/usr/share/Modules" MANPATH="/usr/share/man:" ROCR_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" NCCL_DEBUG="INFO" SLURM_JOB_NUM_NODES="3" CXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" NCCL_TIMEOUT="3600" SLURM_JOBID="328550" GLOO_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" NCCL_IB_HCA="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" DEBUG_CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_JOB_QOS="normal" MOTD_SHOWN="pam" TORCH_NCCL_BLOCKING_WAIT="1" LDFLAGS="-Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,-rpath,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -Wl,-rpath-link,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib  -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib/stubs" __MODULES_SHARE_MANPATH=":1" HOME="/home/Competition2025/P02/P02U006" LANG="en_US.UTF-8" DEBUG_CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" LS_COLORS="rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=01;37;41:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.webp=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=01;36:*.au=01;36:*.flac=01;36:*.m4a=01;36:*.mid=01;36:*.midi=01;36:*.mka=01;36:*.mp3=01;36:*.mpc=01;36:*.ogg=01;36:*.ra=01;36:*.wav=01;36:*.oga=01;36:*.opus=01;36:*.spx=01;36:*.xspf=01;36:" NVCC_PREPEND_FLAGS=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++ -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" SLURM_PROCID="6" CXX_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" HF_TRANSFORMERS_CACHE_DISABLE_FLASH_ATTN_2="1" ELFEDIT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-elfedit" CONDA_PROMPT_MODIFIER="(deepseeksft310) " TMPDIR="/tmp" CMAKE_PREFIX_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot/usr" CUDACXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/nvcc" CPPFLAGS="-DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" SLURM_NTASKS="24" LD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld" SLURM_TOPOLOGY_ADDR="osk-gpu54" SSH_CONNECTION="100.113.255.14 54546 10.255.255.101 22" READELF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-readelf" ZE_AFFINITY_MASK="0,1,2,3,4,5,6,7" PYTORCH_CUDA_ALLOC_CONF="expandable_segments:True" GXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-g++" MASTER_ADDR="osk-gpu54" SLURM_TOPOLOGY_ADDR_PATTERN="node" CUDA_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" GCC_AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ar" ADDR2LINE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-addr2line" XDG_SESSION_CLASS="user" SLURM_WORKING_CLUSTER="osk-cluster:10.255.255.100:6817:9728:109" PYTHONPATH="/home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat:/home/Competition2025/P02/P02U006/ColossalAI:" TERM="xterm-256color" TORCH_NCCL_ASYNC_ERROR_HANDLING="0" GCC_NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-nm" SIZE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-size" HOST="x86_64-conda-linux-gnu" LESSOPEN="||/usr/bin/lesspipe.sh %s" CC_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" USER="P02U006" LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" SLURM_NODELIST="osk-gpu[54,56,91]" ENVIRONMENT="BATCH" GPU_DEVICE_ORDINAL="0,1,2,3,4,5,6,7" CONDA_SHLVL="1" MODULES_RUN_QUARANTINE="LD_LIBRARY_PATH LD_PRELOAD" AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar" AS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-as" DEBUG_CPPFLAGS="-D_DEBUG -D_FORTIFY_SOURCE=2 -Og -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_PRIO_PROCESS="0" host_alias="x86_64-conda-linux-gnu" SLURM_NPROCS="24" PYTHONFAULTHANDLER="1" SHLVL="2" SLURM_NNODES="3" NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-nm" GCC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc" PMIX_MCA_gds="^ds12" XDG_SESSION_ID="64665" SLURM_SUBMIT_HOST="osk-cpu01" LD_GOLD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld.gold" CONDA_PYTHON_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/python" LD_LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" XDG_RUNTIME_DIR="/run/user/11034" SLURM_JOB_ID="328550" UCX_MAX_RNDV_RAILS="8" SLURM_NODEID="0" SSH_CLIENT="100.113.255.14 54546 22" CONDA_DEFAULT_ENV="deepseeksft310" __MODULES_LMINIT="module use --append /home/appli/modulefiles:module use --append /usr/share/Modules/modulefiles:module use --append /etc/modulefiles:module use --append /usr/share/modulefiles" OBJCOPY="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objcopy" OMPI_MCA_coll_hcoll_enable="0" which_declare="declare -f" STRIP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip" CUDA_HOME="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" NVCC_PREPEND_FLAGS_BACKUP=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" XDG_DATA_DIRS="/home/Competition2025/P02/P02U006/.local/share/flatpak/exports/share:/var/lib/flatpak/exports/share:/usr/local/share:/usr/share" OBJDUMP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objdump" SLURM_CONF="/etc/slurm/slurm.conf" PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/condabin:/home/Competition2025/P02/P02U006/.local/bin:/home/Competition2025/P02/P02U006/bin:/usr/share/Modules/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin" SLURM_JOB_NAME="lora-r1" MODULEPATH="/etc/scl/modulefiles:/home/appli/modulefiles:/usr/share/Modules/modulefiles:/etc/modulefiles:/usr/share/modulefiles" CC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" SLURM_NTASKS_PER_NODE="8" CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" CXXFILT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++filt" DBUS_SESSION_BUS_ADDRESS="unix:path=/run/user/11034/bus" BUILD="x86_64-conda-linux-gnu" MAIL="/var/spool/mail/P02U006" SSH_TTY="/dev/pts/47" SLURM_JOB_GID="11034" CPATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib/python3.10/site-packages/nvidia/cublas/include:" RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib" CONDA_BUILD_SYSROOT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot" UCX_MAX_EAGER_RAILS="8" OLDPWD="/home/Competition2025/P02/P02U006" SLURM_JOB_NODELIST="osk-gpu[54,56,91]" MODULES_CMD="/usr/share/Modules/libexec/modulecmd.tcl" TORCH_ELASTIC_STORE_TIMEOUT="3600" _="/usr/bin/srun" SLURM_MPI_TYPE="pmix_v3" SRUN_DEBUG="3" SLURM_UMASK="0022" SLURM_JOB_CPUS_PER_NODE_PACK_GROUP_0="8(x3)" SLURM_DISTRIBUTION="block" SLURM_STEP_ID="0" SLURM_STEPID="0" SLURM_STEP_NODELIST="osk-gpu[54,56,91]" SLURM_STEP_NUM_NODES="3" SLURM_STEP_NUM_TASKS="24" SLURM_STEP_TASKS_PER_NODE="8(x3)" SLURM_STEP_LAUNCHER_PORT="32819" SLURM_SRUN_COMM_PORT="32819" SLURM_PMIXP_ABORT_AGENT_PORT="34205" SLURM_PMIX_MAPPING_SERV="(vector,(0,3,8))" SLURM_SRUN_COMM_HOST="192.168.11.54" SLURM_STEP_GPUS="0,1,2,3,4,5,6,7" SLURM_CPU_BIND="quiet,none" SLURM_CPU_BIND_TYPE="none" SLURM_CPU_BIND_VERBOSE="quiet" SLURM_LAUNCH_NODE_IPADDR="192.168.11.54" PMIX_NAMESPACE="slurm.pmix.328550.0" PMIX_RANK="6" PMIX_SERVER_URI3="pmix-server.2009332;tcp4://127.0.0.1:45561" PMIX_SERVER_URI2="pmix-server.2009332;tcp4://127.0.0.1:45561" PMIX_SERVER_URI21="pmix-server.2009332;tcp4://127.0.0.1:45561" PMIX_SECURITY_MODE="munge,native" PMIX_PTL_MODULE="tcp,usock" PMIX_BFROP_BUFFER_TYPE="PMIX_BFROP_BUFFER_NON_DESC" PMIX_GDS_MODULE="ds21,ds12,hash" PMIX_SERVER_TMPDIR="/var/spool/slurm/d/pmix.328550.0/" PMIX_SYSTEM_TMPDIR="/tmp" PMIX_DSTORE_21_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds21_2009332" PMIX_DSTORE_ESH_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds12_2009332" PMIX_HOSTNAME="osk-gpu54" PMIX_VERSION="3.2.3" CUDA_DEVICE_MAX_CONNECTIONS="1" && torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora'

Exit code: 1

Stdout: already printed

Stderr: already printed



====== Training on All Nodes =====
127.0.0.1: failure

====== Stopping All Nodes =====
127.0.0.1: finish
please install Colossal-AI from https://www.colossalai.org/download or from source
please install Colossal-AI from https://www.colossalai.org/download or from source
please install Colossal-AI from https://www.colossalai.org/download or from source
please install Colossal-AI from https://www.colossalai.org/download or from source
please install Colossal-AI from https://www.colossalai.org/download or from source
please install Colossal-AI from https://www.colossalai.org/download or from source
please install Colossal-AI from https://www.colossalai.org/download or from source
please install Colossal-AI from https://www.colossalai.org/download or from source
please install Colossal-AI from https://www.colossalai.org/download or from source
please install Colossal-AI from https://www.colossalai.org/download or from source
please install Colossal-AI from https://www.colossalai.org/download or from source
please install Colossal-AI from https://www.colossalai.org/download or from source
please install Colossal-AI from https://www.colossalai.org/download or from source
please install Colossal-AI from https://www.colossalai.org/download or from source
please install Colossal-AI from https://www.colossalai.org/download or from source
please install Colossal-AI from https://www.colossalai.org/download or from source
please install Colossal-AI from https://www.colossalai.org/download or from source
Error: failed to run torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora on 127.0.0.1, is localhost: True, exception: Encountered a bad command exit code!

Command: 'cd /home/Competition2025/P02/P02U006/ColossalAI && export SHELL="/bin/bash" SLURM_GPUS_PER_NODE="8" GCC_RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ranlib" SLURM_JOB_USER="P02U006" SLURM_TASKS_PER_NODE="8(x3)" SLURM_JOB_UID="11034" HISTCONTROL="ignoredups" SLURM_TASK_PID="3124472" CONDA_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/conda" SLURM_JOB_GPUS="0,1,2,3,4,5,6,7" SLURM_LOCALID="0" build_alias="x86_64-conda-linux-gnu" SLURM_SUBMIT_DIR="/home/Competition2025/P02/P02U006/ColossalAI" CMAKE_ARGS="-DCMAKE_AR=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar -DCMAKE_RANLIB=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib -DCMAKE_LINKER=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld -DCMAKE_STRIP=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip -DCMAKE_BUILD_TYPE=Release" HOSTNAME="osk-gpu54" HISTSIZE="1000" SLURMD_NODENAME="osk-gpu91" FLASH_ATTENTION_DISABLE="1" MASTER_PORT="13700" GPROF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gprof" _CONDA_PYTHON_SYSCONFIGDATA_NAME="_sysconfigdata_x86_64_conda_cos7_linux_gnu" STRINGS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strings" CPP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cpp" NCCL_NET_PLUGIN="none" SLURM_NODE_ALIASES="(null)" SLURM_CLUSTER_NAME="osk-cluster" SLURM_CPUS_ON_NODE="8" SLURM_JOB_CPUS_PER_NODE="8(x3)" NCCL_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" SLURM_GPUS_ON_NODE="8" PWD="/home/Competition2025/P02/P02U006/ColossalAI" SLURM_GTIDS="16,17,18,19,20,21,22,23" GSETTINGS_SCHEMA_DIR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/share/glib-2.0/schemas" LOGNAME="P02U006" UCX_NET_DEVICES="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" XDG_SESSION_TYPE="tty" CONDA_PREFIX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" SLURM_JOB_PARTITION="P02" MODULESHOME="/usr/share/Modules" MANPATH="/usr/share/man:" ROCR_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" NCCL_DEBUG="INFO" SLURM_JOB_NUM_NODES="3" CXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" NCCL_TIMEOUT="3600" SLURM_JOBID="328550" GLOO_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" NCCL_IB_HCA="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" DEBUG_CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_JOB_QOS="normal" MOTD_SHOWN="pam" TORCH_NCCL_BLOCKING_WAIT="1" LDFLAGS="-Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,-rpath,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -Wl,-rpath-link,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib  -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib/stubs" __MODULES_SHARE_MANPATH=":1" HOME="/home/Competition2025/P02/P02U006" LANG="en_US.UTF-8" DEBUG_CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" LS_COLORS="rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=01;37;41:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.webp=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=01;36:*.au=01;36:*.flac=01;36:*.m4a=01;36:*.mid=01;36:*.midi=01;36:*.mka=01;36:*.mp3=01;36:*.mpc=01;36:*.ogg=01;36:*.ra=01;36:*.wav=01;36:*.oga=01;36:*.opus=01;36:*.spx=01;36:*.xspf=01;36:" NVCC_PREPEND_FLAGS=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++ -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" SLURM_PROCID="16" CXX_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" HF_TRANSFORMERS_CACHE_DISABLE_FLASH_ATTN_2="1" ELFEDIT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-elfedit" CONDA_PROMPT_MODIFIER="(deepseeksft310) " TMPDIR="/tmp" CMAKE_PREFIX_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot/usr" CUDACXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/nvcc" CPPFLAGS="-DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" SLURM_NTASKS="24" LD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld" SLURM_TOPOLOGY_ADDR="osk-gpu91" SSH_CONNECTION="100.113.255.14 54546 10.255.255.101 22" READELF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-readelf" ZE_AFFINITY_MASK="0,1,2,3,4,5,6,7" PYTORCH_CUDA_ALLOC_CONF="expandable_segments:True" GXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-g++" MASTER_ADDR="osk-gpu54" SLURM_TOPOLOGY_ADDR_PATTERN="node" CUDA_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" GCC_AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ar" ADDR2LINE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-addr2line" XDG_SESSION_CLASS="user" SLURM_WORKING_CLUSTER="osk-cluster:10.255.255.100:6817:9728:109" PYTHONPATH="/home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat:/home/Competition2025/P02/P02U006/ColossalAI:" TERM="xterm-256color" TORCH_NCCL_ASYNC_ERROR_HANDLING="0" GCC_NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-nm" SIZE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-size" HOST="x86_64-conda-linux-gnu" LESSOPEN="||/usr/bin/lesspipe.sh %s" CC_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" USER="P02U006" LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" SLURM_NODELIST="osk-gpu[54,56,91]" ENVIRONMENT="BATCH" GPU_DEVICE_ORDINAL="0,1,2,3,4,5,6,7" CONDA_SHLVL="1" MODULES_RUN_QUARANTINE="LD_LIBRARY_PATH LD_PRELOAD" AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar" AS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-as" DEBUG_CPPFLAGS="-D_DEBUG -D_FORTIFY_SOURCE=2 -Og -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_PRIO_PROCESS="0" host_alias="x86_64-conda-linux-gnu" SLURM_NPROCS="24" PYTHONFAULTHANDLER="1" SHLVL="2" SLURM_NNODES="3" NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-nm" GCC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc" PMIX_MCA_gds="^ds12" XDG_SESSION_ID="64665" SLURM_SUBMIT_HOST="osk-cpu01" LD_GOLD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld.gold" CONDA_PYTHON_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/python" LD_LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" XDG_RUNTIME_DIR="/run/user/11034" SLURM_JOB_ID="328550" UCX_MAX_RNDV_RAILS="8" SLURM_NODEID="2" SSH_CLIENT="100.113.255.14 54546 22" CONDA_DEFAULT_ENV="deepseeksft310" __MODULES_LMINIT="module use --append /home/appli/modulefiles:module use --append /usr/share/Modules/modulefiles:module use --append /etc/modulefiles:module use --append /usr/share/modulefiles" OBJCOPY="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objcopy" OMPI_MCA_coll_hcoll_enable="0" which_declare="declare -f" STRIP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip" CUDA_HOME="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" NVCC_PREPEND_FLAGS_BACKUP=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" XDG_DATA_DIRS="/home/Competition2025/P02/P02U006/.local/share/flatpak/exports/share:/var/lib/flatpak/exports/share:/usr/local/share:/usr/share" OBJDUMP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objdump" SLURM_CONF="/etc/slurm/slurm.conf" PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/condabin:/home/Competition2025/P02/P02U006/.local/bin:/home/Competition2025/P02/P02U006/bin:/usr/share/Modules/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin" SLURM_JOB_NAME="lora-r1" MODULEPATH="/etc/scl/modulefiles:/home/appli/modulefiles:/usr/share/Modules/modulefiles:/etc/modulefiles:/usr/share/modulefiles" CC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" SLURM_NTASKS_PER_NODE="8" CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" CXXFILT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++filt" DBUS_SESSION_BUS_ADDRESS="unix:path=/run/user/11034/bus" BUILD="x86_64-conda-linux-gnu" MAIL="/var/spool/mail/P02U006" SSH_TTY="/dev/pts/47" SLURM_JOB_GID="11034" CPATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib/python3.10/site-packages/nvidia/cublas/include:" RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib" CONDA_BUILD_SYSROOT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot" UCX_MAX_EAGER_RAILS="8" OLDPWD="/home/Competition2025/P02/P02U006" SLURM_JOB_NODELIST="osk-gpu[54,56,91]" MODULES_CMD="/usr/share/Modules/libexec/modulecmd.tcl" TORCH_ELASTIC_STORE_TIMEOUT="3600" _="/usr/bin/srun" SLURM_MPI_TYPE="pmix_v3" SRUN_DEBUG="3" SLURM_UMASK="0022" SLURM_JOB_CPUS_PER_NODE_PACK_GROUP_0="8(x3)" SLURM_DISTRIBUTION="block" SLURM_STEP_ID="0" SLURM_STEPID="0" SLURM_STEP_NODELIST="osk-gpu[54,56,91]" SLURM_STEP_NUM_NODES="3" SLURM_STEP_NUM_TASKS="24" SLURM_STEP_TASKS_PER_NODE="8(x3)" SLURM_STEP_LAUNCHER_PORT="32819" SLURM_SRUN_COMM_PORT="32819" SLURM_PMIXP_ABORT_AGENT_PORT="34205" SLURM_PMIX_MAPPING_SERV="(vector,(0,3,8))" SLURM_SRUN_COMM_HOST="192.168.11.54" SLURM_STEP_GPUS="0,1,2,3,4,5,6,7" SLURM_CPU_BIND="quiet,none" SLURM_CPU_BIND_TYPE="none" SLURM_CPU_BIND_VERBOSE="quiet" SLURM_LAUNCH_NODE_IPADDR="192.168.11.54" PMIX_NAMESPACE="slurm.pmix.328550.0" PMIX_RANK="16" PMIX_SERVER_URI3="pmix-server.3124463;tcp4://127.0.0.1:41703" PMIX_SERVER_URI2="pmix-server.3124463;tcp4://127.0.0.1:41703" PMIX_SERVER_URI21="pmix-server.3124463;tcp4://127.0.0.1:41703" PMIX_SECURITY_MODE="munge,native" PMIX_PTL_MODULE="tcp,usock" PMIX_BFROP_BUFFER_TYPE="PMIX_BFROP_BUFFER_NON_DESC" PMIX_GDS_MODULE="ds21,ds12,hash" PMIX_SERVER_TMPDIR="/var/spool/slurm/d/pmix.328550.0/" PMIX_SYSTEM_TMPDIR="/tmp" PMIX_DSTORE_21_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds21_3124463" PMIX_DSTORE_ESH_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds12_3124463" PMIX_HOSTNAME="osk-gpu91" PMIX_VERSION="3.2.3" CUDA_DEVICE_MAX_CONNECTIONS="1" && torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora'

Exit code: 1

Stdout: already printed

Stderr: already printed



====== Training on All Nodes =====
127.0.0.1: failure

====== Stopping All Nodes =====
127.0.0.1: finish
Error: failed to run torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora on 127.0.0.1, is localhost: True, exception: Encountered a bad command exit code!

Command: 'cd /home/Competition2025/P02/P02U006/ColossalAI && export SHELL="/bin/bash" SLURM_GPUS_PER_NODE="8" GCC_RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ranlib" SLURM_JOB_USER="P02U006" SLURM_TASKS_PER_NODE="8(x3)" SLURM_JOB_UID="11034" HISTCONTROL="ignoredups" SLURM_TASK_PID="3124478" CONDA_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/conda" SLURM_JOB_GPUS="0,1,2,3,4,5,6,7" SLURM_LOCALID="6" build_alias="x86_64-conda-linux-gnu" SLURM_SUBMIT_DIR="/home/Competition2025/P02/P02U006/ColossalAI" CMAKE_ARGS="-DCMAKE_AR=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar -DCMAKE_RANLIB=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib -DCMAKE_LINKER=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld -DCMAKE_STRIP=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip -DCMAKE_BUILD_TYPE=Release" HOSTNAME="osk-gpu54" HISTSIZE="1000" SLURMD_NODENAME="osk-gpu91" FLASH_ATTENTION_DISABLE="1" MASTER_PORT="13700" GPROF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gprof" _CONDA_PYTHON_SYSCONFIGDATA_NAME="_sysconfigdata_x86_64_conda_cos7_linux_gnu" STRINGS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strings" CPP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cpp" NCCL_NET_PLUGIN="none" SLURM_NODE_ALIASES="(null)" SLURM_CLUSTER_NAME="osk-cluster" SLURM_CPUS_ON_NODE="8" SLURM_JOB_CPUS_PER_NODE="8(x3)" NCCL_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" SLURM_GPUS_ON_NODE="8" PWD="/home/Competition2025/P02/P02U006/ColossalAI" SLURM_GTIDS="16,17,18,19,20,21,22,23" GSETTINGS_SCHEMA_DIR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/share/glib-2.0/schemas" LOGNAME="P02U006" UCX_NET_DEVICES="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" XDG_SESSION_TYPE="tty" CONDA_PREFIX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" SLURM_JOB_PARTITION="P02" MODULESHOME="/usr/share/Modules" MANPATH="/usr/share/man:" ROCR_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" NCCL_DEBUG="INFO" SLURM_JOB_NUM_NODES="3" CXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" NCCL_TIMEOUT="3600" SLURM_JOBID="328550" GLOO_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" NCCL_IB_HCA="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" DEBUG_CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_JOB_QOS="normal" MOTD_SHOWN="pam" TORCH_NCCL_BLOCKING_WAIT="1" LDFLAGS="-Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,-rpath,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -Wl,-rpath-link,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib  -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib/stubs" __MODULES_SHARE_MANPATH=":1" HOME="/home/Competition2025/P02/P02U006" LANG="en_US.UTF-8" DEBUG_CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" LS_COLORS="rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=01;37;41:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.webp=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=01;36:*.au=01;36:*.flac=01;36:*.m4a=01;36:*.mid=01;36:*.midi=01;36:*.mka=01;36:*.mp3=01;36:*.mpc=01;36:*.ogg=01;36:*.ra=01;36:*.wav=01;36:*.oga=01;36:*.opus=01;36:*.spx=01;36:*.xspf=01;36:" NVCC_PREPEND_FLAGS=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++ -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" SLURM_PROCID="22" CXX_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" HF_TRANSFORMERS_CACHE_DISABLE_FLASH_ATTN_2="1" ELFEDIT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-elfedit" CONDA_PROMPT_MODIFIER="(deepseeksft310) " TMPDIR="/tmp" CMAKE_PREFIX_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot/usr" CUDACXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/nvcc" CPPFLAGS="-DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" SLURM_NTASKS="24" LD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld" SLURM_TOPOLOGY_ADDR="osk-gpu91" SSH_CONNECTION="100.113.255.14 54546 10.255.255.101 22" READELF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-readelf" ZE_AFFINITY_MASK="0,1,2,3,4,5,6,7" PYTORCH_CUDA_ALLOC_CONF="expandable_segments:True" GXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-g++" MASTER_ADDR="osk-gpu54" SLURM_TOPOLOGY_ADDR_PATTERN="node" CUDA_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" GCC_AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ar" ADDR2LINE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-addr2line" XDG_SESSION_CLASS="user" SLURM_WORKING_CLUSTER="osk-cluster:10.255.255.100:6817:9728:109" PYTHONPATH="/home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat:/home/Competition2025/P02/P02U006/ColossalAI:" TERM="xterm-256color" TORCH_NCCL_ASYNC_ERROR_HANDLING="0" GCC_NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-nm" SIZE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-size" HOST="x86_64-conda-linux-gnu" LESSOPEN="||/usr/bin/lesspipe.sh %s" CC_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" USER="P02U006" LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" SLURM_NODELIST="osk-gpu[54,56,91]" ENVIRONMENT="BATCH" GPU_DEVICE_ORDINAL="0,1,2,3,4,5,6,7" CONDA_SHLVL="1" MODULES_RUN_QUARANTINE="LD_LIBRARY_PATH LD_PRELOAD" AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar" AS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-as" DEBUG_CPPFLAGS="-D_DEBUG -D_FORTIFY_SOURCE=2 -Og -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_PRIO_PROCESS="0" host_alias="x86_64-conda-linux-gnu" SLURM_NPROCS="24" PYTHONFAULTHANDLER="1" SHLVL="2" SLURM_NNODES="3" NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-nm" GCC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc" PMIX_MCA_gds="^ds12" XDG_SESSION_ID="64665" SLURM_SUBMIT_HOST="osk-cpu01" LD_GOLD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld.gold" CONDA_PYTHON_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/python" LD_LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" XDG_RUNTIME_DIR="/run/user/11034" SLURM_JOB_ID="328550" UCX_MAX_RNDV_RAILS="8" SLURM_NODEID="2" SSH_CLIENT="100.113.255.14 54546 22" CONDA_DEFAULT_ENV="deepseeksft310" __MODULES_LMINIT="module use --append /home/appli/modulefiles:module use --append /usr/share/Modules/modulefiles:module use --append /etc/modulefiles:module use --append /usr/share/modulefiles" OBJCOPY="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objcopy" OMPI_MCA_coll_hcoll_enable="0" which_declare="declare -f" STRIP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip" CUDA_HOME="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" NVCC_PREPEND_FLAGS_BACKUP=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" XDG_DATA_DIRS="/home/Competition2025/P02/P02U006/.local/share/flatpak/exports/share:/var/lib/flatpak/exports/share:/usr/local/share:/usr/share" OBJDUMP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objdump" SLURM_CONF="/etc/slurm/slurm.conf" PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/condabin:/home/Competition2025/P02/P02U006/.local/bin:/home/Competition2025/P02/P02U006/bin:/usr/share/Modules/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin" SLURM_JOB_NAME="lora-r1" MODULEPATH="/etc/scl/modulefiles:/home/appli/modulefiles:/usr/share/Modules/modulefiles:/etc/modulefiles:/usr/share/modulefiles" CC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" SLURM_NTASKS_PER_NODE="8" CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" CXXFILT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++filt" DBUS_SESSION_BUS_ADDRESS="unix:path=/run/user/11034/bus" BUILD="x86_64-conda-linux-gnu" MAIL="/var/spool/mail/P02U006" SSH_TTY="/dev/pts/47" SLURM_JOB_GID="11034" CPATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib/python3.10/site-packages/nvidia/cublas/include:" RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib" CONDA_BUILD_SYSROOT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot" UCX_MAX_EAGER_RAILS="8" OLDPWD="/home/Competition2025/P02/P02U006" SLURM_JOB_NODELIST="osk-gpu[54,56,91]" MODULES_CMD="/usr/share/Modules/libexec/modulecmd.tcl" TORCH_ELASTIC_STORE_TIMEOUT="3600" _="/usr/bin/srun" SLURM_MPI_TYPE="pmix_v3" SRUN_DEBUG="3" SLURM_UMASK="0022" SLURM_JOB_CPUS_PER_NODE_PACK_GROUP_0="8(x3)" SLURM_DISTRIBUTION="block" SLURM_STEP_ID="0" SLURM_STEPID="0" SLURM_STEP_NODELIST="osk-gpu[54,56,91]" SLURM_STEP_NUM_NODES="3" SLURM_STEP_NUM_TASKS="24" SLURM_STEP_TASKS_PER_NODE="8(x3)" SLURM_STEP_LAUNCHER_PORT="32819" SLURM_SRUN_COMM_PORT="32819" SLURM_PMIXP_ABORT_AGENT_PORT="34205" SLURM_PMIX_MAPPING_SERV="(vector,(0,3,8))" SLURM_SRUN_COMM_HOST="192.168.11.54" SLURM_STEP_GPUS="0,1,2,3,4,5,6,7" SLURM_CPU_BIND="quiet,none" SLURM_CPU_BIND_TYPE="none" SLURM_CPU_BIND_VERBOSE="quiet" SLURM_LAUNCH_NODE_IPADDR="192.168.11.54" PMIX_NAMESPACE="slurm.pmix.328550.0" PMIX_RANK="22" PMIX_SERVER_URI3="pmix-server.3124463;tcp4://127.0.0.1:41703" PMIX_SERVER_URI2="pmix-server.3124463;tcp4://127.0.0.1:41703" PMIX_SERVER_URI21="pmix-server.3124463;tcp4://127.0.0.1:41703" PMIX_SECURITY_MODE="munge,native" PMIX_PTL_MODULE="tcp,usock" PMIX_BFROP_BUFFER_TYPE="PMIX_BFROP_BUFFER_NON_DESC" PMIX_GDS_MODULE="ds21,ds12,hash" PMIX_SERVER_TMPDIR="/var/spool/slurm/d/pmix.328550.0/" PMIX_SYSTEM_TMPDIR="/tmp" PMIX_DSTORE_21_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds21_3124463" PMIX_DSTORE_ESH_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds12_3124463" PMIX_HOSTNAME="osk-gpu91" PMIX_VERSION="3.2.3" CUDA_DEVICE_MAX_CONNECTIONS="1" && torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora'

Exit code: 1

Stdout: already printed

Stderr: already printed



====== Training on All Nodes =====
127.0.0.1: failure
Error: failed to run torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora on 127.0.0.1, is localhost: True, exception: Encountered a bad command exit code!

Command: 'cd /home/Competition2025/P02/P02U006/ColossalAI && export SHELL="/bin/bash" SLURM_GPUS_PER_NODE="8" GCC_RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ranlib" SLURM_JOB_USER="P02U006" SLURM_TASKS_PER_NODE="8(x3)" SLURM_JOB_UID="11034" HISTCONTROL="ignoredups" SLURM_TASK_PID="3124475" CONDA_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/conda" SLURM_JOB_GPUS="0,1,2,3,4,5,6,7" SLURM_LOCALID="3" build_alias="x86_64-conda-linux-gnu" SLURM_SUBMIT_DIR="/home/Competition2025/P02/P02U006/ColossalAI" CMAKE_ARGS="-DCMAKE_AR=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar -DCMAKE_RANLIB=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib -DCMAKE_LINKER=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld -DCMAKE_STRIP=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip -DCMAKE_BUILD_TYPE=Release" HOSTNAME="osk-gpu54" HISTSIZE="1000" SLURMD_NODENAME="osk-gpu91" FLASH_ATTENTION_DISABLE="1" MASTER_PORT="13700" GPROF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gprof" _CONDA_PYTHON_SYSCONFIGDATA_NAME="_sysconfigdata_x86_64_conda_cos7_linux_gnu" STRINGS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strings" CPP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cpp" NCCL_NET_PLUGIN="none" SLURM_NODE_ALIASES="(null)" SLURM_CLUSTER_NAME="osk-cluster" SLURM_CPUS_ON_NODE="8" SLURM_JOB_CPUS_PER_NODE="8(x3)" NCCL_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" SLURM_GPUS_ON_NODE="8" PWD="/home/Competition2025/P02/P02U006/ColossalAI" SLURM_GTIDS="16,17,18,19,20,21,22,23" GSETTINGS_SCHEMA_DIR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/share/glib-2.0/schemas" LOGNAME="P02U006" UCX_NET_DEVICES="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" XDG_SESSION_TYPE="tty" CONDA_PREFIX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" SLURM_JOB_PARTITION="P02" MODULESHOME="/usr/share/Modules" MANPATH="/usr/share/man:" ROCR_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" NCCL_DEBUG="INFO" SLURM_JOB_NUM_NODES="3" CXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" NCCL_TIMEOUT="3600" SLURM_JOBID="328550" GLOO_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" NCCL_IB_HCA="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" DEBUG_CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_JOB_QOS="normal" MOTD_SHOWN="pam" TORCH_NCCL_BLOCKING_WAIT="1" LDFLAGS="-Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,-rpath,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -Wl,-rpath-link,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib  -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib/stubs" __MODULES_SHARE_MANPATH=":1" HOME="/home/Competition2025/P02/P02U006" LANG="en_US.UTF-8" DEBUG_CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" LS_COLORS="rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=01;37;41:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.webp=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=01;36:*.au=01;36:*.flac=01;36:*.m4a=01;36:*.mid=01;36:*.midi=01;36:*.mka=01;36:*.mp3=01;36:*.mpc=01;36:*.ogg=01;36:*.ra=01;36:*.wav=01;36:*.oga=01;36:*.opus=01;36:*.spx=01;36:*.xspf=01;36:" NVCC_PREPEND_FLAGS=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++ -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" SLURM_PROCID="19" CXX_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" HF_TRANSFORMERS_CACHE_DISABLE_FLASH_ATTN_2="1" ELFEDIT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-elfedit" CONDA_PROMPT_MODIFIER="(deepseeksft310) " TMPDIR="/tmp" CMAKE_PREFIX_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot/usr" CUDACXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/nvcc" CPPFLAGS="-DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" SLURM_NTASKS="24" LD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld" SLURM_TOPOLOGY_ADDR="osk-gpu91" SSH_CONNECTION="100.113.255.14 5454Error: failed to run torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora on 127.0.0.1, is localhost: True, exception: Encountered a bad command exit code!

Command: 'cd /home/Competition2025/P02/P02U006/ColossalAI && export SHELL="/bin/bash" SLURM_GPUS_PER_NODE="8" GCC_RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ranlib" SLURM_JOB_USER="P02U006" SLURM_TASKS_PER_NODE="8(x3)" SLURM_JOB_UID="11034" HISTCONTROL="ignoredups" SLURM_TASK_PID="3124474" CONDA_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/conda" SLURM_JOB_GPUS="0,1,2,3,4,5,6,7" SLURM_LOCALID="2" build_alias="x86_64-conda-linux-gnu" SLURM_SUBMIT_DIR="/home/Competition2025/P02/P02U006/ColossalAI" CMAKE_ARGS="-DCMAKE_AR=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar -DCMAKE_RANLIB=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib -DCMAKE_LINKER=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld -DCMAKE_STRIP=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip -DCMAKE_BUILD_TYPE=Release" HOSTNAME="osk-gpu54" HISTSIZE="1000" SLURMD_NODENAME="osk-gpu91" FLASH_ATTENTION_DISABLE="1" MASTER_PORT="13700" GPROF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gprof" _CONDA_PYTHON_SYSCONFIGDATA_NAME="_sysconfigdata_x86_64_conda_cos7_linux_gnu" STRINGS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strings" CPP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cpp" NCCL_NET_PLUGIN="none" SLURM_NODE_ALIASES="(null)" SLURM_CLUSTER_NAME="osk-cluster" SLURM_CPUS_ON_NODE="8" SLURM_JOB_CPUS_PER_NODE="8(x3)" NCCL_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" SLURM_GPUS_ON_NODE="8" PWD="/home/Competition2025/P02/P02U006/ColossalAI" SLURM_GTIDS="16,17,18,19,20,21,22,23" GSETTINGS_SCHEMA_DIR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/share/glib-2.0/schemas" LOGNAME="P02U006" UCX_NET_DEVICES="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" XDG_SESSION_TYPE="tty" CONDA_PREFIX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" SLURM_JOB_PARTITION="P02" MODULESHOME="/usr/share/Modules" MANPATH="/usr/share/man:" ROCR_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" NCCL_DEBUG="INFO" SLURM_JOB_NUM_NODES="3" CXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" NCCL_TIMEOUT="3600" SLURM_JOBID="328550" GLOO_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" NCCL_IB_HCA="mlx5_0:1,mlx5_1:1,mlx5_26 10.255.255.101 22" READELF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-readelf" ZE_AFFINITY_MASK="0,1,2,3,4,5,6,7" PYTORCH_CUDA_ALLOC_CONF="expandable_segments:True" GXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-g++" MASTER_ADDR="osk-gpu54" SLURM_TOPOLOGY_ADDR_PATTERN="node" CUDA_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" GCC_AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ar" ADDR2LINE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-addr2line" XDG_SESSION_CLASS="user" SLURM_WORKING_CLUSTER="osk-cluster:10.255.255.100:6817:9728:109" PYTHONPATH="/home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat:/home/Competition2025/P02/P02U006/ColossalAI:" TERM="xterm-256color" TORCH_NCCL_ASYNC_ERROR_HANDLING="0" GCC_NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-nm" SIZE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-size" HOST="x86_64-conda-linux-gnu" LESSOPEN="||/usr/bin/lesspipe.sh %s" CC_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" USER="P02U006" LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" SLURM_NODELIST="osk-gpu[54,56,91]" ENVIRONMENT="BATCH" GPU_DEVICE_ORDINAL="0,1,2,3,4,5,6,7" CONDA_SHLVL="1" MODULES_RUN_QUARANTINE="LD_LIBRARY_PATH LD_PRELOAD" AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar" AS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-as" DEBUG_CPPFLAGS="-D_DEBUG -D_FORTIFY_SOURCE=2 -Og -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_PRIO_PROCESS="0" host_alias="x86_64-conda-linux-gnu" SLURM_NPROCS="24" PYTHONFAULTHANDLER="1" SHLVL="2" SLURM_NNODES="3" NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-nm" GCC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc" PMIX_MCA_gds="^ds12" XDG_SESSION_ID="64665" SLURM_SUBMIT_HOST="osk-cpu01" LD_GOLD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld.gold" CONDA_PYTHON_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/python" LD_LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" XDG_RUNTIME_DIR="/run/user/11034" SLURM_JOB_ID="328550" UCX_MAX_RNDV_RAILS="8" SLURM_NODEID="2" SSH_CLIENT="100.113.255.14 54546 22" CONDA_DEFAULT_ENV="deepseeksft310" __MODULES_LMINIT="module use --append /home/appli/modulefiles:module use --append /usr/share/Modules/modulefiles:module use --append /etc/modulefiles:module use --append /usr/share/modulefiles" OBJCOPY="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objcopy" OMPI_MCA_coll_hcoll_enable="0" which_declare="declare -f" STRIP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip" CUDA_HOME="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" NVCC_PREPEND_FLAGS_BACKUP=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" XDG_DATA_DIRS="/home/Competition2025/P02/P02U006/.local/share/flatpak/exports/share:/var/lib/flatpak/exports/share:/usr/local/share:/usr/share" OBJDUMP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objdump" SLURM_CONF="/etc/slurm/slurm.conf" PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/condabin:/home/:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" DEBUG_CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_JOB_QOS="normal" MOTD_SHOWN="pam" TORCH_NCCL_BLOCKING_WAIT="1" LDFLAGS="-Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,-rpath,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -Wl,-rpath-link,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib  -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib/stubs" __MODULES_SHARE_MANPATH=":1" HOME="/home/Competition2025/P02/P02U006" LANG="en_US.UTF-8" DEBUG_CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" LS_COLORS="rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=01;37;41:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.webp=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=01;36:*.au=01;36:*.flac=01;36:*.m4a=01;36:*.mid=01;36:*.midi=01;36:*.mka=01;36:*.mp3=01;36:*.mpc=01;36:*.ogg=01;36:*.ra=01;36:*.wav=01;36:*.oga=01;36:*.opus=01;36:*.spx=01;36:*.xspf=01;36:" NVCC_PREPEND_FLAGS=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++ -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" SLURM_PROCID="18" CXX_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" HF_TRANSFORMERS_CACHE_DISABLE_FLASH_ATTN_2="1" ELFEDIT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-elfedit" CONDA_PROMPT_MODIFIER="(deepseeksft310) " TMPDIR="/tmp" CMAKE_PREFIX_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot/usr" CUDACXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/nvcc" CPPFLAGS="-DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" SLURM_NTASKS="24" LD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld" SLURM_TOPOLOGY_ADDR="osk-gpu91" SSH_CONNECTION="100.113.255.14 5454Competition2025/P02/P02U006/.local/bin:/home/Competition2025/P02/P02U006/bin:/usr/share/Modules/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin" SLURM_JOB_NAME="lora-r1" MODULEPATH="/etc/scl/modulefiles:/home/appli/modulefiles:/usr/share/Modules/modulefiles:/etc/modulefiles:/usr/share/modulefiles" CC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" SLURM_NTASKS_PER_NODE="8" CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" CXXFILT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++filt" DBUS_SESSION_BUS_ADDRESS="unix:path=/run/user/11034/bus" BUILD="x86_64-conda-linux-gnu" MAIL="/var/spool/mail/P02U006" SSH_TTY="/dev/pts/47" SLURM_JOB_GID="11034" CPATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib/python3.10/site-packages/nvidia/cublas/include:" RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib" CONDA_BUILD_SYSROOT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot" UCX_MAX_EAGER_RAILS="8" OLDPWD="/home/Competition2025/P02/P02U006" SLURM_JOB_NODELIST="osk-gpu[54,56,91]" MODULES_CMD="/usr/share/Modules/libexec/modulecmd.tcl" TORCH_ELASTIC_STORE_TIMEOUT="3600" _="/usr/bin/srun" SLURM_MPI_TYPE="pmix_v3" SRUN_DEBUG="3" SLURM_UMASK="0022" SLURM_JOB_CPUS_PER_NODE_PACK_GROUP_0="8(x3)" SLURM_DISTRIBUTION="block" SLURM_STEP_ID="0" SLURM_STEPID="0" SLURM_STEP_NODELIST="osk-gpu[54,56,91]" SLURM_STEP_NUM_NODES="3" SLURM_STEP_NUM_TASKS="24" SLURM_STEP_TASKS_PER_NODE="8(x3)" SLURM_STEP_LAUNCHER_PORT="32819" SLURM_SRUN_COMM_PORT="32819" SLURM_PMIXP_ABORT_AGENT_PORT="34205" SLURM_PMIX_MAPPING_SERV="(vector,(0,3,8))" SLURM_SRUN_COMM_HOST="192.168.11.54" SLURM_STEP_GPUS="0,1,2,3,4,5,6,7" SLURM_CPU_BIND="quiet,none" SLURM_CPU_BIND_TYPE="none" SLURM_CPU_BIND_VERBOSE="quiet" SLURM_LAUNCH_NODE_IPADDR="192.168.11.54" PMIX_NAMESPACE="slurm.pmix.328550.0" PMIX_RANK="19" PMIX_SERVER_URI3="pmix-server.3124463;tcp4://127.0.0.1:41703" PMIX_SERVER_URI2="pmix-server.3124463;tcp4://127.0.0.1:41703" PMIX_SERVER_URI21="pmix-server.3124463;tcp4://127.0.0.1:41703" PMIX_SECURITY_MODE="munge,native" PMIX_PTL_MODULE="tcp,usock" PMIX_BFROP_BUFFER_TYPE="PMIX_BFROP_BUFFER_NON_DESC" PMIX_GDS_MODULE="ds21,ds12,hash" PMIX_SERVER_TMPDIR="/var/spool/slurm/d/pmix.328550.0/" PMIX_SYSTEM_TMPDIR="/tmp" PMIX_DSTORE_21_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds21_3124463" PMIX_DSTORE_ESH_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds12_3124463" PMIX_HOSTNAME="osk-gpu91" PMIX_VERSION="3.2.3" CUDA_DEVICE_MAX_CONNECTIONS="1" && torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora'

Exit code: 1

Stdout: already printed

Stderr: already printed



====== Training on All Nodes =====
127.0.0.1: failure
6 10.255.255.101 22" READELF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-readelf" ZE_AFFINITY_MASK="0,1,2,3,4,5,6,7" PYTORCH_CUDA_ALLOC_CONF="expandable_segments:True" GXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-g++" MASTER_ADDR="osk-gpu54" SLURM_TOPOLOGY_ADDR_PATTERN="node" CUDA_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" GCC_AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ar" ADDR2LINE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-addr2line" XDG_SESSION_CLASS="user" SLURM_WORKING_CLUSTER="osk-cluster:10.255.255.100:6817:9728:109" PYTHONPATH="/home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat:/home/Competition2025/P02/P02U006/ColossalAI:" TERM="xterm-256color" TORCH_NCCL_ASYNC_ERROR_HANDLING="0" GCC_NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-nm" SIZE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-size" HOST="x86_64-conda-linux-gnu" LESSOPEN="||/usr/bin/lesspipe.sh %s" CC_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" USER="P02U006" LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" SLURM_NODELIST="osk-gpu[54,56,91]" ENVIRONMENT="BATCH" GPU_DEVICE_ORDINAL="0,1,2,3,4,5,6,7" CONDA_SHLVL="1" MODULES_RUN_QUARANTINE="LD_LIBRARY_PATH LD_PRELOAD" AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar" AS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-as" DEBUG_CPPFLAGS="-D_DEBUG -D_FORTIFY_SOURCE=2 -Og -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_PRIO_PROCESS="0" host_alias="x86_64-conda-linux-gnu" SLURM_NPROCS="24" PYTHONFAULTHANDLER="1" SHLVL="2" SLURM_NNODES="3" NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-nm" GCC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc" PMIX_MCA_gds="^ds12" XDG_SESSION_ID="64665" SLURM_SUBMIT_HOST="osk-cpu01" LD_GOLD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld.gold" CONDA_PYTHON_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/python" LD_LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" XDG_RUNTIME_DIR="/run/user/11034" SLURM_JOB_ID="328550" UCX_MAX_RNDV_RAILS="8" SLURM_NODEID="2" SSH_CLIENT="100.113.255.14 54546 22" CONDA_DEFAULT_ENV="deepseeksft310" __MODULES_LMINIT="module use --append /home/appli/modulefiles:module use --append /usr/share/Modules/modulefiles:module use --append /etc/modulefiles:module use --append /usr/share/modulefiles" OBJCOPY="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objcopy" OMPI_MCA_coll_hcoll_enable="0" which_declare="declare -f" STRIP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip" CUDA_HOME="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" NVCC_PREPEND_FLAGS_BACKUP=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" XDG_DATA_DIRS="/home/Competition2025/P02/P02U006/.local/share/flatpak/exports/share:/var/lib/flatpak/exports/share:/usr/local/share:/usr/share" OBJDUMP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objdump" SLURM_CONF="/etc/slurm/slurm.conf" PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/condabin:/home/
====== Stopping All Nodes =====
127.0.0.1: finish

====== Stopping All Nodes =====
127.0.0.1: finish
Competition2025/P02/P02U006/.local/bin:/home/Competition2025/P02/P02U006/bin:/usr/share/Modules/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin" SLURM_JOB_NAME="lora-r1" MODULEPATH="/etc/scl/modulefiles:/home/appli/modulefiles:/usr/share/Modules/modulefiles:/etc/modulefiles:/usr/share/modulefiles" CC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" SLURM_NTASKS_PER_NODE="8" CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" CXXFILT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++filt" DBUS_SESSION_BUS_ADDRESS="unix:path=/run/user/11034/bus" BUILD="x86_64-conda-linux-gnu" MAIL="/var/spool/mail/P02U006" SSH_TTY="/dev/pts/47" SLURM_JOB_GID="11034" CPATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib/python3.10/site-packages/nvidia/cublas/include:" RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib" CONDA_BUILD_SYSROOT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot" UCX_MAX_EAGER_RAILS="8" OLDPWD="/home/Competition2025/P02/P02U006" SLURM_JOB_NODELIST="osk-gpu[54,56,91]" MODULES_CMD="/usr/share/Modules/libexec/modulecmd.tcl" TORCH_ELASTIC_STORE_TIMEOUT="3600" _="/usr/bin/srun" SLURM_MPI_TYPE="pmix_v3" SRUN_DEBUG="3" SLURM_UMASK="0022" SLURM_JOB_CPUS_PER_NODE_PACK_GROUP_0="8(x3)" SLURM_DISTRIBUTION="block" SLURM_STEP_ID="0" SLURM_STEPID="0" SLURM_STEP_NODELIST="osk-gpu[54,56,91]" SLURM_STEP_NUM_NODES="3" SLURM_STEP_NUM_TASKS="24" SLURM_STEP_TASKS_PER_NODE="8(x3)" SLURM_STEP_LAUNCHER_PORT="32819" SLURM_SRUN_COMM_PORT="32819" SLURM_PMIXP_ABORT_AGENT_PORT="34205" SLURM_PMIX_MAPPING_SERV="(vector,(0,3,8))" SLURM_SRUN_COMM_HOST="192.168.11.54" SLURM_STEP_GPUS="0,1,2,3,4,5,6,7" SLURM_CPU_BIND="quiet,none" SLURM_CPU_BIND_TYPE="none" SLURM_CPU_BIND_VERBOSE="quiet" SLURM_LAUNCH_NODE_IPADDR="192.168.11.54" PMIX_NAMESPACE="slurm.pmix.328550.0" PMIX_RANK="18" PMIX_SERVER_URI3="pmix-server.3124463;tcp4://127.0.0.1:41703" PMIX_SERVER_URI2="pmix-server.3124463;tcp4://127.0.0.1:41703" PMIX_SERVER_URI21="pmix-server.3124463;tcp4://127.0.0.1:41703" PMIX_SECURITY_MODE="munge,native" PMIX_PTL_MODULE="tcp,usock" PMIX_BFROP_BUFFER_TYPE="PMIX_BFROP_BUFFER_NON_DESC" PMIX_GDS_MODULE="ds21,ds12,hash" PMIX_SERVER_TMPDIR="/var/spool/slurm/d/pmix.328550.0/" PMIX_SYSTEM_TMPDIR="/tmp" PMIX_DSTORE_21_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds21_3124463" PMIX_DSTORE_ESH_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds12_3124463" PMIX_HOSTNAME="osk-gpu91" PMIX_VERSION="3.2.3" CUDA_DEVICE_MAX_CONNECTIONS="1" && torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora'

Exit code: 1

Stdout: already printed

Stderr: already printed



====== Training on All Nodes =====
127.0.0.1: failure

====== Stopping All Nodes =====
127.0.0.1: finish
Error: failed to run torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora on 127.0.0.1, is localhost: True, exception: Encountered a bad command exit code!

Command: 'cd /home/Competition2025/P02/P02U006/ColossalAI && export SHELL="/bin/bash" SLURM_GPUS_PER_NODE="8" GCC_RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ranlib" SLURM_JOB_USER="P02U006" SLURM_TASKS_PER_NODE="8(x3)" SLURM_JOB_UID="11034" HISTCONTROL="ignoredups" SLURM_TASK_PID="3124473" CONDA_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/conda" SLURM_JOB_GPUS="0,1,2,3,4,5,6,7" SLURM_LOCALID="1" build_alias="x86_64-conda-linux-gnu" SLURM_SUBMIT_DIR="/home/Competition2025/P02/P02U006/ColossalAI" CMAKE_ARGS="-DCMAKE_AR=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar -DCMAKE_RANLIB=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib -DCMAKE_LINKER=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld -DCMAKE_STRIP=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip -DCMAKE_BUILD_TYPE=Release" HOSTNAME="osk-gpu54" HISTSIZE="1000" SLURMD_NODENAME="osk-gpu91" FLASH_ATTENTION_DISABLE="1" MASTER_PORT="13700" GPROF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gprof" _CONDA_PYTHON_SYSCONFIGDATA_NAME="_sysconfigdata_x86_64_conda_cos7_linux_gnu" STRINGS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strings" CPP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cpp" NCCL_NET_PLUGIN="none" SLURM_NODE_ALIASES="(null)" SLURM_CLUSTER_NAME="osk-cluster" SLURM_CPUS_ON_NODE="8" SLURM_JOB_CPUS_PER_NODE="8(x3)" NCCL_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" SLURM_GPUS_ON_NODE="8" PWD="/home/Competition2025/P02/P02U006/ColossalAI" SLURM_GTIDS="16,17,18,19,20,21,22,23" GSETTINGS_SCHEMA_DIR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/share/glib-2.0/schemas" LOGNAME="P02U006" UCX_NET_DEVICES="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" XDG_SESSION_TYPE="tty" CONDA_PREFIX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" SLURM_JOB_PARTITION="P02" MODULESHOME="/usr/share/Modules" MANPATH="/usr/share/man:" ROCR_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" NCCL_DEBUG="INFO" SLURM_JOB_NUM_NODES="3" CXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" NCCL_TIMEOUT="3600" SLURM_JOBID="328550" GLOO_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" NCCL_IB_HCA="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" DEBUG_CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_JOB_QOS="normal" MOTD_SHOWN="pam" TORCH_NCCL_BLOCKING_WAIT="1" LDFLAGS="-Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,-rpath,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -Wl,-rpath-link,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib  -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib/stubs" __MODULES_SHARE_MANPATH=":1" HOME="/home/Competition2025/P02/P02U006" LANG="en_US.UTF-8" DEBUG_CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" LS_COLORS="rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=01;37;41:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.webp=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=01;36:*.au=01;36:*.flac=01;36:*.m4a=01;36:*.mid=01;36:*.midi=01;36:*.mka=01;36:*.mp3=01;36:*.mpc=01;36:*.ogg=01;36:*.ra=01;36:*.wav=01;36:*.oga=01;36:*.opus=01;36:*.spx=01;36:*.xspf=01;36:" NVCC_PREPEND_FLAGS=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++ -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" SLURM_PROCID="17" CXX_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" HF_TRANSFORMERS_CACHE_DISABLE_FLASH_ATTN_2="1" ELFEDIT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-elfedit" CONDA_PROMPT_MODIFIER="(deepseeksft310) " TMPDIR="/tmp" CMAKE_PREFIX_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot/usr" CUDACXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/nvcc" CPPFLAGS="-DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" SLURM_NTASKS="24" LD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld" SLURM_TOPOLOGY_ADDR="osk-gpu91" SSH_CONNECTION="100.113.255.14 54546 10.255.255.101 22" READELF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-readelf" ZE_AFFINITY_MASK="0,1,2,3,4,5,6,7" PYTORCH_CUDA_ALLOC_CONF="expandable_segments:True" GXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-g++" MASTER_ADDR="osk-gpu54" SLURM_TOPOLOGY_ADDR_PATTERN="node" CUDA_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" GCC_AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ar" ADDR2LINE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-addr2line" XDG_SESSION_CLASS="user" SLURM_WORKING_CLUSTER="osk-cluster:10.255.255.100:6817:9728:109" PYTHONPATH="/home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat:/home/Competition2025/P02/P02U006/ColossalAI:" TERM="xterm-256color" TORCH_NCCL_ASYNC_ERROR_HANDLING="0" GCC_NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-nm" SIZE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-size" HOST="x86_64-conda-linux-gnu" LESSOPEN="||/usr/bin/lesspipe.sh %s" CC_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" USER="P02U006" LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" SLURM_NODELIST="osk-gpu[54,56,91]" ENVIRONMENT="BATCH" GPU_DEVICE_ORDINAL="0,1,2,3,4,5,6,7" CONDA_SHLVL="1" MODULES_RUN_QUARANTINE="LD_LIBRARY_PATH LD_PRELOAD" AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar" AS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-as" DEBUG_CPPFLAGS="-D_DEBUG -D_FORTIFY_SOURCE=2 -Og -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_PRIO_PROCESS="0" host_alias="x86_64-conda-linux-gnu" SLURM_NPROCS="24" PYTHONFAULTHANDLER="1" SHLVL="2" SLURM_NNODES="3" NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-nm" GCC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc" PMIX_MCA_gds="^ds12" XDG_SESSION_ID="64665" SLURM_SUBMIT_HOST="osk-cpu01" LD_GOLD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld.gold" CONDA_PYTHON_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/python" LD_LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" XDG_RUNTIME_DIR="/run/user/11034" SLURM_JOB_ID="328550" UCX_MAX_RNDV_RAILS="8" SLURM_NODEID="2" SSH_CLIENT="100.113.255.14 54546 22" CONDA_DEFAULT_ENV="deepseeksft310" __MODULES_LMINIT="module use --append /home/appli/modulefiles:module use --append /usr/share/Modules/modulefiles:module use --append /etc/modulefiles:module use --append /usr/share/modulefiles" OBJCOPY="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objcopy" OMPI_MCA_coll_hcoll_enable="0" which_declare="declare -f" STRIP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip" CUDA_HOME="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" NVCC_PREPEND_FLAGS_BACKUP=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" XDG_DATA_DIRS="/home/Competition2025/P02/P02U006/.local/share/flatpak/exports/share:/var/lib/flatpak/exports/share:/usr/local/share:/usr/share" OBJDUMP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objdump" SLURM_CONF="/etc/slurm/slurm.conf" PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/condabin:/home/Competition2025/P02/P02U006/.local/bin:/home/Competition2025/P02/P02U006/bin:/usr/share/Modules/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin" SLURM_JOB_NAME="lora-r1" MODULEPATH="/etc/scl/modulefiles:/home/appli/modulefiles:/usr/share/Modules/modulefiles:/etc/modulefiles:/usr/share/modulefiles" CC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" SLURM_NTASKS_PER_NODE="8" CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" CXXFILT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++filt" DBUS_SESSION_BUS_ADDRESS="unix:path=/run/user/11034/bus" BUILD="x86_64-conda-linux-gnu" MAIL="/var/spool/mail/P02U006" SSH_TTY="/dev/pts/47" SLURM_JOB_GID="11034" CPATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib/python3.10/site-packages/nvidia/cublas/include:" RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib" CONDA_BUILD_SYSROOT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot" UCX_MAX_EAGER_RAILS="8" OLDPWD="/home/Competition2025/P02/P02U006" SLURM_JOB_NODELIST="osk-gpu[54,56,91]" MODULES_CMD="/usr/share/Modules/libexec/modulecmd.tcl" TORCH_ELASTIC_STORE_TIMEOUT="3600" _="/usr/bin/srun" SLURM_MPI_TYPE="pmix_v3" SRUN_DEBUG="3" SLURM_UMASK="0022" SLURM_JOB_CPUS_PER_NODE_PACK_GROUP_0="8(x3)" SLURM_DISTRIBUTION="block" SLURM_STEP_ID="0" SLURM_STEPID="0" SLURM_STEP_NODELIST="osk-gpu[54,56,91]" SLURM_STEP_NUM_NODES="3" SLURM_STEP_NUM_TASKS="24" SLURM_STEP_TASKS_PER_NODE="8(x3)" SLURM_STEP_LAUNCHER_PORT="32819" SLURM_SRUN_COMM_PORT="32819" SLURM_PMIXP_ABORT_AGENT_PORT="34205" SLURM_PMIX_MAPPING_SERV="(vector,(0,3,8))" SLURM_SRUN_COMM_HOST="192.168.11.54" SLURM_STEP_GPUS="0,1,2,3,4,5,6,7" SLURM_CPU_BIND="quiet,none" SLURM_CPU_BIND_TYPE="none" SLURM_CPU_BIND_VERBOSE="quiet" SLURM_LAUNCH_NODE_IPADDR="192.168.11.54" PMIX_NAMESPACE="slurm.pmix.328550.0" PMIX_RANK="17" PMIX_SERVER_URI3="pmix-server.3124463;tcp4://127.0.0.1:41703" PMIX_SERVER_URI2="pmix-server.3124463;tcp4://127.0.0.1:41703" PMIX_SERVER_URI21="pmix-server.3124463;tcp4://127.0.0.1:41703" PMIX_SECURITY_MODE="munge,native" PMIX_PTL_MODULE="tcp,usock" PMIX_BFROP_BUFFER_TYPE="PMIX_BFROP_BUFFER_NON_DESC" PMIX_GDS_MODULE="ds21,ds12,hash" PMIX_SERVER_TMPDIR="/var/spool/slurm/d/pmix.328550.0/" PMIX_SYSTEM_TMPDIR="/tmp" PMIX_DSTORE_21_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds21_3124463" PMIX_DSTORE_ESH_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds12_3124463" PMIX_HOSTNAME="osk-gpu91" PMIX_VERSION="3.2.3" CUDA_DEVICE_MAX_CONNECTIONS="1" && torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora'

Exit code: 1

Stdout: already printed

Stderr: already printed


Error: failed to run torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora on 127.0.0.1, is localhost: True, exception: Encountered a bad command exit code!

Command: 'cd /home/Competition2025/P02/P02U006/ColossalAI && export SHELL="/bin/bash" SLURM_GPUS_PER_NODE="8" GCC_RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ranlib" SLURM_JOB_USER="P02U006" SLURM_TASKS_PER_NODE="8(x3)" SLURM_JOB_UID="11034" HISTCONTROL="ignoredups" SLURM_TASK_PID="3124476" CONDA_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/conda" SLURM_JOB_GPUS="0,1,2,3,4,5,6,7" SLURM_LOCALID="4" build_alias="x86_64-conda-linux-gnu" SLURM_SUBMIT_DIR="/home/Competition2025/P02/P02U006/ColossalAI" CMAKE_ARGS="-DCMAKE_AR=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar -DCMAKE_RANLIB=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib -DCMAKE_LINKER=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld -DCMAKE_STRIP=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip -DCMAKE_BUILD_TYPE=Release" HOSTNAME="osk-gpu54" HISTSIZE="1000" SLURMD_NODENAME="osk-gpu91" FLASH_ATTENTION_DISABLE="1" MASTER_PORT="13700" GPROF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gprof" _CONDA_PYTHON_SYSCONFIGDATA_NAME="_sysconfigdata_x86_64_conda_cos7_linux_gnu" STRINGS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strings" CPP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cpp" NCCL_NET_PLUGIN="none" SLURM_NODE_ALIASES="(null)" SLURM_CLUSTER_NAME="osk-cluster" SLURM_CPUS_ON_NODE="8" SLURM_JOB_CPUS_PER_NODE="8(x3)" NCCL_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" SLURM_GPUS_ON_NODE="8" PWD="/home/Competition2025/P02/P02U006/ColossalAI" SLURM_GTIDS="16,17,18,19,20,21,22,23" GSETTINGS_SCHEMA_DIR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/share/glib-2.0/schemas" LOGNAME="P02U006" UCX_NET_DEVICES="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" XDG_SESSION_TYPE="tty" CONDA_PREFIX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" SLURM_JOB_PARTITION="P02" MODULESHOME="/usr/share/Modules" MANPATH="/usr/share/man:" ROCR_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" NCCL_DEBUG="INFO" SLURM_JOB_NUM_NODES="3" CXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" NCCL_TIMEOUT="3600" SLURM_JOBID="328550" GLOO_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" NCCL_IB_HCA="mlx5_0:1,mlx5_1:1,mlx5_2
====== Training on All Nodes =====
127.0.0.1: failure
:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" DEBUG_CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_JOB_QOS="normal" MOTD_SHOWN="pam" TORCH_NCCL_BLOCKING_WAIT="1" LDFLAGS="-Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,-rpath,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -Wl,-rpath-link,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib  -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib/stubs" __MODULES_SHARE_MANPATH=":1" HOME="/home/Competition2025/P02/P02U006" LANG="en_US.UTF-8" DEBUG_CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" LS_COLORS="rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=01;37;41:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.webp=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=01;36:*.au=01;36:*.flac=01;36:*.m4a=01;36:*.mid=01;36:*.midi=01;36:*.mka=01;36:*.mp3=01;36:*.mpc=01;36:*.ogg=01;36:*.ra=01;36:*.wav=01;36:*.oga=01;36:*.opus=01;36:*.spx=01;36:*.xspf=01;36:" NVCC_PREPEND_FLAGS=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++ -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" SLURM_PROCID="20" CXX_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" HF_TRANSFORMERS_CACHE_DISABLE_FLASH_ATTN_2="1" ELFEDIT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-elfedit" CONDA_PROMPT_MODIFIER="(deepseeksft310) " TMPDIR="/tmp" CMAKE_PREFIX_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot/usr" CUDACXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/nvcc" CPPFLAGS="-DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" SLURM_NTASKS="24" LD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld" SLURM_TOPOLOGY_ADDR="osk-gpu91" SSH_CONNECTION="100.113.255.14 54546 10.255.255.101 22" READELF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-readelf" ZE_AFFINITY_MASK="0,1,2,3,4,5,6,7" PYTORCH_CUDA_ALLOC_CONF="expandable_segments:True" GXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-g++" MASTER_ADDR="osk-gpu54" SLURM_TOPOLOGY_ADDR_PATTERN="node" CUDA_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" GCC_AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ar" ADDR2LINE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-addr2line" XDG_SESSION_CLASS="user" SLURM_WORKING_CLUSTER="osk-cluster:10.255.255.100:6817:9728:109" PYTHONPATH="/home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat:/home/Competition2025/P02/P02U006/ColossalAI:" TERM="xterm-256color" TORCH_NCCL_ASYNC_ERROR_HANDLING="0" GCC_NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-nm" SIZE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-size" HOST="x86_64-conda-linux-gnu" LESSOPEN="||/usr/bin/lesspipe.sh %s" CC_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" USER="P02U006" LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" SLURM_NODELIST="osk-gpu[54,56,91]" ENVIRONMENT="BATCH" GPU_DEVICE_ORDINAL="0,1,2,3,4,5,6,7" CONDA_SHLVL="1" MODULES_RUN_QUARANTINE="LD_LIBRARY_PATH LD_PRELOAD" AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar" AS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-as" DEBUG_CPPFLAGS="-D_DEBUG -D_FORTIFY_SOURCE=2 -Og -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_PRIO_PROCESS="0" host_alias="x86_64-conda-linux-gnu" SLURM_NPROCS="24" PYTHONFAULTHANDLER="1" SHLVL="2" SLURM_NNODES="3" NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-nm" GCC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc" PMIX_MCA_gds="^ds12" XDG_SESSION_ID="64665" SLURM_SUBMIT_HOST="osk-cpu01" LD_GOLD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld.gold" CONDA_PYTHON_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/python" LD_LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" XDG_RUNTIME_DIR="/run/user/11034" SLURM_JOB_ID="328550" UCX_MAX_RNDV_RAILS="8" SLURM_NODEID="2" SSH_CLIENT="100.113.255.14 54546 22" CONDA_DEFAULT_ENV="deepseeksft310" __MODULES_LMINIT="module use --append /home/appli/modulefiles:module use --append /usr/share/Modules/modulefiles:module use --append /etc/modulefiles:module use --append /usr/share/modulefiles" OBJCOPY="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objcopy" OMPI_MCA_coll_hcoll_enable="0" which_declare="declare -f" STRIP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip" CUDA_HOME="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" NVCC_PREPEND_FLAGS_BACKUP=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" XDG_DATA_DIRS="/home/Competition2025/P02/P02U006/.local/share/flatpak/exports/share:/var/lib/flatpak/exports/share:/usr/local/share:/usr/share" OBJDUMP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objdump" SLURM_CONF="/etc/slurm/slurm.conf" PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/condabin:/home/Competition2025/P02/P02U006/.local/bin:/home/Competition2025/P02/P02U006/bin:/usr/share/Modules/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin" SLURM_JOB_NAME="lora-r1" MODULEPATH="/etc/scl/modulefiles:/home/appli/modulefiles:/usr/share/Modules/modulefiles:/etc/modulefiles:/usr/share/modulefiles" CC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" SLURM_NTASKS_PER_NODE="8" CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" CXXFILT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++filt" DBUS_SESSION_BUS_ADDRESS="unix:path=/run/user/11034/bus" BUILD="x86_64-conda-linux-gnu" MAIL="/var/spool/mail/P02U006" SSH_TTY="/dev/pts/47" SLURM_JOB_GID="11034" CPATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib/python3.10/site-packages/nvidia/cublas/include:" RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib" CONDA_BUILD_SYSROOT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot" UCX_MAX_EAGER_RAILS="8" OLDPWD="/home/Competition2025/P02/P02U006" SLURM_JOB_NODELIST="osk-gpu[54,56,91]" MODULES_CMD="/usr/share/Modules/libexec/modulecmd.tcl" TORCH_ELASTIC_STORE_TIMEOUT="3600" _="/usr/bin/srun" SLURM_MPI_TYPE="pmix_v3" SRUN_DEBUG="3" SLURM_UMASK="0022" SLURM_JOB_CPUS_PER_NODE_PACK_GROUP_0="8(x3)" SLURM_DISTRIBUTION="block" SLURM_STEP_ID="0" SLURM_STEPID="0" SLURM_STEP_NODELIST="osk-gpu[54,56,91]" SLURM_STEP_NUM_NODES="3" SLURM_STEP_NUM_TASKS="24" SLURM_STEP_TASKS_PER_NODE="8(x3)" SLURM_STEP_LAUNCHER_PORT="32819" SLURM_SRUN_COMM_PORT="32819" SLURM_PMIXP_ABORT_AGENT_PORT="34205" SLURM_PMIX_MAPPING_SERV="(vector,(0,3,8))" SLURM_SRUN_COMM_HOST="192.168.11.54" SLURM_STEP_GPUS="0,1,2,3,4,5,6,7" SLURM_CPU_BIND="quiet,none" SLURM_CPU_BIND_TYPE="none" SLURM_CPU_BIND_VERBOSE="quiet" SLURM_LAUNCH_NODE_IPADDR="192.168.11.54" PMIX_NAMESPACE="slurm.pmix.328550.0" PMIX_RANK="20" PMIX_SERVER_URI3="pmix-server.3124463;tcp4://127.0.0.1:41703" PMIX_SERVER_URI2="pmix-server.3124463;tcp4://127.0.0.1:41703" PMIX_SERVER_URI21="pmix-server.3124463;tcp4://127.0.0.1:41703" PMIX_SECURITY_MODE="munge,native" PMIX_PTL_MODULE="tcp,usock" PMIX_BFROP_BUFFER_TYPE="PMIX_BFROP_BUFFER_NON_DESC" PMIX_GDS_MODULE="ds21,ds12,hash" PMIX_SERVER_TMPDIR="/var/spool/slurm/d/pmix.328550.0/" PMIX_SYSTEM_TMPDIR="/tmp" PMIX_DSTORE_21_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds21_3124463" PMIX_DSTORE_ESH_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds12_3124463" PMIX_HOSTNAME="osk-gpu91" PMIX_VERSION="3.2.3" CUDA_DEVICE_MAX_CONNECTIONS="1" && torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora'

Exit code: 1

Stdout: already printed

Stderr: already printed


Error: failed to run torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora on 127.0.0.1, is localhost: True, exception: Encountered a bad command exit code!

Command: 'cd /home/Competition2025/P02/P02U006/ColossalAI && export SHELL="/bin/bash" SLURM_GPUS_PER_NODE="8" GCC_RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ranlib" SLURM_JOB_USER="P02U006" SLURM_TASKS_PER_NODE="8(x3)" SLURM_JOB_UID="11034" HISTCONTROL="ignoredups" SLURM_TASK_PID="3124477" CONDA_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/conda" SLURM_JOB_GPUS="0,1,2,3,4,5,6,7" SLURM_LOCALID="5" build_alias="x86_64-conda-linux-gnu" SLURM_SUBMIT_DIR="/home/Competition2025/P02/P02U006/ColossalAI" CMAKE_ARGS="-DCMAKE_AR=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar -DCMAKE_RANLIB=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib -DCMAKE_LINKER=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld -DCMAKE_STRIP=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip -DCMAKE_BUILD_TYPE=Release" HOSTNAME="osk-gpu54" HISTSIZE="1000" SLURMD_NODENAME="osk-gpu91" FLASH_ATTENTION_DISABLE="1" MASTER_PORT="13700" GPROF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gprof" _CONDA_PYTHON_SYSCONFIGDATA_NAME="_sysconfigdata_x86_64_conda_cos7_linux_gnu" STRINGS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strings" CPP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cpp" NCCL_NET_PLUGIN="none" SLURM_NODE_ALIASES="(null)" SLURM_CLUSTER_NAME="osk-cluster" SLURM_CPUS_ON_NODE="8" SLURM_JOB_CPUS_PER_NODE="8(x3)" NCCL_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" SLURM_GPUS_ON_NODE="8" PWD="/home/Competition2025/P02/P02U006/ColossalAI" SLURM_GTIDS="16,17,18,19,20,21,22,23" GSETTINGS_SCHEMA_DIR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/share/glib-2.0/schemas" LOGNAME="P02U006" UCX_NET_DEVICES="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" XDG_SESSION_TYPE="tty" CONDA_PREFIX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" SLURM_JOB_PARTITION="P02" MODULESHOME="/usr/share/Modules" MANPATH="/usr/share/man:" ROCR_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" NCCL_DEBUG="INFO" SLURM_JOB_NUM_NODES="3" CXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" NCCL_TIMEOUT="3600" SLURM_JOBID="328550" GLOO_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" NCCL_IB_HCA="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" DEBUG_CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_JOB_QOS="normal" MOTD_SHOWN="pam" TORCH_NCCL_BLOCKING_WAIT="1" LDFLAGS="-Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,-rpath,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -Wl,-rpath-link,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib  -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib/stubs" __MODULES_SHARE_MANPATH=":1" HOME="/home/Competition2025/P02/P02U006" LANG="en_US.UTF-8" DEBUG_CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" LS_COLORS="rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=01;37;41:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.webp=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=01;36:*.au=01;36:*.flac=01;36:*.m4a=01;36:*.mid=01;36:*.midi=01;36:*.mka=01;36:*.mp3=01;36:*.mpc=01;36:*.ogg=01;36:*.ra=01;36:*.wav=01;36:*.oga=01;36:*.opus=01;36:*.spx=01;36:*.xspf=01;36:" NVCC_PREPEND_FLAGS=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++ -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" SLURM_PROCID="21" CXX_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" HF_TRANSFORMERS_CACHE_DISABLE_FLASH_ATTN_2="1" ELFEDIT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-elfedit" CONDA_PROMPT_MODIFIER="(deepseeksft310) " TMPDIR="/tmp" CMAKE_PREFIX_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot/usr" CUDACXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/nvcc" CPPFLAGS="-DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" SLURM_NTASKS="24" LD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld" SLURM_TOPOLOGY_ADDR="osk-gpu91" SSH_CONNECTION="100.113.255.14 54546 10.255.255.101 22" READELF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-readelf" ZE_AFFINITY_MASK="0,1,2,3,4,5,6,7" PYTORCH_CUDA_ALLOC_CONF="expandable_segments:True" GXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-g++" MASTER_ADDR="osk-gpu54" SLURM_TOPOLOGY_ADDR_PATTERN="node" CUDA_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" GCC_AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ar" ADDR2LINE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-addr2line" XDG_SESSION_CLASS="user" SLURM_WORKING_CLUSTER="osk-cluster:10.255.255.100:6817:9728:109" PYTHONPATH="/home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat:/home/Competition2025/P02/P02U006/ColossalAI:" TERM="xterm-256color" TORCH_NCCL_ASYNC_ERROR_HANDLING="0" GCC_NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-nm" SIZE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-size" HOST="x86_64-conda-linux-gnu" LESSOPEN="||/usr/bin/lesspipe.sh %s" CC_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" USER="P02U006" LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" SLURM_NODELIST="osk-gpu[54,56,91]" ENVIRONMENT="BATCH" GPU_DEVICE_ORDINAL="0,1,2,3,4,5,6,7" CONDA_SHLVL="1" MODULES_RUN_QUARANTINE="LD_LIBRARY_PATH LD_PRELOAD" AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar" AS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-as" DEBUG_CPPFLAGS="-D_DEBUG -D_FORTIFY_SOURCE=2 -Og -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_PRIO_PROCESS="0" host_alias="x86_64-conda-linux-gnu" SLURM_NPROCS="24" PYTHONFAULTHANDLER="1" SHLVL="2" SLURM_NNODES="3" NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-nm" GCC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc" PMIX_MCA_gds="^ds12" XDG_SESSION_ID="64665" SLURM_SUBMIT_HOST="osk-cpu01" LD_GOLD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld.gold" CONDA_PYTHON_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/python" LD_LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" XDG_RUNTIME_DIR="/run/user/11034" SLURM_JOB_ID="328550" UCX_MAX_RNDV_RAILS="8" SLURM_NODEID="2" SSH_CLIENT="100.113.255.14 54546 22" CONDA_DEFAULT_ENV="deepseeksft310" __MODULES_LMINIT="module use --append /home/appli/modulefiles:module use --append /usr/share/Modules/modulefiles:module use --append /etc/modulefiles:module use --append /usr/share/modulefiles" OBJCOPY="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objcopy" OMPI_MCA_coll_hcoll_enable="0" which_declare="declare -f" STRIP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip" CUDA_HOME="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" NVCC_PREPEND_FLAGS_BACKUP=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" XDG_DATA_DIRS="/home/Competition2025/P02/P02U006/.local/share/flatpak/exports/share:/var/lib/flatpak/exports/share:/usr/local/share:/usr/share" OBJDUMP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objdump" SLURM_CONF="/etc/slurm/slurm.conf" PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/condabin:/home/Competition2025/P02/P02U006/.local/bin:/home/Competition2025/P02/P02U006/bin:/usr/share/Modules/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin" SLURM_JOB_NAME="lora-r1" MODULEPATH="/etc/scl/modulefiles:/home/appli/modulefiles:/usr/share/Modules/modulefiles:/etc/modulefiles:/usr/share/modulefiles" CC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" SLURM_NTASKS_PER_NODE="8" CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" CXXFILT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++filt" DBUS_SESSION_BUS_ADDRESS="unix:path=/run/user/11034/bus" BUILD="x86_64-conda-linux-gnu" MAIL="/var/spool/mail/P02U006" SSH_TTY="/dev/pts/47" SLURM_JOB_GID="11034" CPATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib/python3.10/site-packages/nvidia/cublas/include:" RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib" CONDA_BUILD_SYSROOT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot" UCX_MAX_EAGER_RAILS="8" OLDPWD="/home/Competition2025/P02/P02U006" SLURM_JOB_NODELIST="osk-gpu[54,56,91]" MODULES_CMD="/usr/share/Modules/libexec/modulecmd.tcl" TORCH_ELASTIC_STORE_TIMEOUT="3600" _="/usr/bin/srun" SLURM_MPI_TYPE="pmix_v3" SRUN_DEBUG="3" SLURM_UMASK="0022" SLURM_JOB_CPUS_PER_NODE_PACK_GROUP_0="8(x3)" SLURM_DISTRIBUTION="block" SLURM_STEP_ID="0" SLURM_STEPID="0" SLURM_STEP_NODELIST="osk-gpu[54,56,91]" SLURM_STEP_NUM_NODES="3" SLURM_STEP_NUM_TASKS="24" SLURM_STEP_TASKS_PER_NODE="8(x3)" SLURM_STEP_LAUNCHER_PORT="32819" SLURM_SRUN_COMM_PORT="32819" SLURM_PMIXP_ABORT_AGENT_PORT="34205" SLURM_PMIX_MAPPING_SERV="(vector,(0,3,8))" SLURM_SRUN_COMM_HOST="192.168.11.54" SLURM_STEP_GPUS="0,1,2,3,4,5,6,7" SLURM_CPU_BIND="quiet,none" SLURM_CPU_BIND_TYPE="none" SLURM_CPU_BIND_VERBOSE="quiet" SLURM_LAUNCH_NODE_IPADDR="192.168.11.54" PMIX_NAMESPACE="slurm.pmix.328550.0" PMIX_RANK="21" PMIX_SERVER_URI3="pmix-server.3124463;tcp4://127.0.0.1:41703" PMIX_SERVER_URI2="pmix-server.3124463;tcp4://127.0.0.1:41703" PMIX_SERVER_URI21="pmix-server.3124463;tcp4://127.0.0.1:41703" PMIX_SECURITY_MODE="munge,native" PMIX_PTL_MODULE="tcp,usock" PMIX_BFROP_BUFFER_TYPE="PMIX_BFROP_BUFFER_NON_DESC" PMIX_GDS_MODULE="ds21,ds12,hash" PMIX_SERVER_TMPDIR="/var/spool/slurm/d/pmix.328550.0/" PMIX_SYSTEM_TMPDIR="/tmp" PMIX_DSTORE_21_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds21_3124463" PMIX_DSTORE_ESH_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds12_3124463" PMIX_HOSTNAME="osk-gpu91" PMIX_VERSION="3.2.3" CUDA_DEVICE_MAX_CONNECTIONS="1" && torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora'

Exit code: 1

Stdout: already printed

Stderr: already printed



====== Training on All Nodes =====
127.0.0.1: failure

====== Training on All Nodes =====
127.0.0.1: failure

====== Stopping All Nodes =====
127.0.0.1: finish

====== Stopping All Nodes =====
127.0.0.1: finish

====== Stopping All Nodes =====
127.0.0.1: finish
Error: failed to run torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora on 127.0.0.1, is localhost: True, exception: Encountered a bad command exit code!

Command: 'cd /home/Competition2025/P02/P02U006/ColossalAI && export SHELL="/bin/bash" SLURM_GPUS_PER_NODE="8" GCC_RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ranlib" SLURM_JOB_USER="P02U006" SLURM_TASKS_PER_NODE="8(x3)" SLURM_JOB_UID="11034" HISTCONTROL="ignoredups" SLURM_TASK_PID="1574142" CONDA_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/conda" SLURM_JOB_GPUS="0,1,2,3,4,5,6,7" SLURM_LOCALID="1" build_alias="x86_64-conda-linux-gnu" SLURM_SUBMIT_DIR="/home/Competition2025/P02/P02U006/ColossalAI" CMAKE_ARGS="-DCMAKE_AR=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar -DCMAKE_RANLIB=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib -DCMAKE_LINKER=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld -DCMAKE_STRIP=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip -DCMAKE_BUILD_TYPE=Release" HOSTNAME="osk-gpu54" HISTSIZE="1000" SLURMD_NODENAME="osk-gpu56" FLASH_ATTENTION_DISABLE="1" MASTER_PORT="13700" GPROF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gprof" _CONDA_PYTHON_SYSCONFIGDATA_NAME="_sysconfigdata_x86_64_conda_cos7_linux_gnu" STRINGS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strings" CPP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cpp" NCCL_NET_PLUGIN="none" SLURM_NODE_ALIASES="(null)" SLURM_CLUSTER_NAME="osk-cluster" SLURM_CPUS_ON_NODE="8" SLURM_JOB_CPUS_PER_NODE="8(x3)" NCCL_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" SLURM_GPUS_ON_NODE="8" PWD="/home/Competition2025/P02/P02U006/ColossalAI" SLURM_GTIDS="8,9,10,11,12,13,14,15" GSETTINGS_SCHEMA_DIR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/share/glib-2.0/schemas" LOGNAME="P02U006" UCX_NET_DEVICES="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" XDG_SESSION_TYPE="tty" CONDA_PREFIX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" SLURM_JOB_PARTITION="P02" MODULESHOME="/usr/share/Modules" MANPATH="/usr/share/man:" ROCR_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" NCCL_DEBUG="INFO" SLURM_JOB_NUM_NODES="3" CXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" NCCL_TIMEOUT="3600" SLURM_JOBID="328550" GLOO_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" NCCL_IB_HCA="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" DEBUG_CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_JOB_QOS="normal" MOTD_SHOWN="pam" TORCH_NCCL_BLOCKING_WAIT="1" LDFLAGS="-Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,-rpath,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -Wl,-rpath-link,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib  -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib/stubs" __MODULES_SHARE_MANPATH=":1" HOME="/home/Competition2025/P02/P02U006" LANG="en_US.UTF-8" DEBUG_CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" LS_COLORS="rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=01;37;41:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.webp=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=01;36:*.au=01;36:*.flac=01;36:*.m4a=01;36:*.mid=01;36:*.midi=01;36:*.mka=01;36:*.mp3=01;36:*.mpc=01;36:*.ogg=01;36:*.ra=01;36:*.wav=01;36:*.oga=01;36:*.opus=01;36:*.spx=01;36:*.xspf=01;36:" NVCC_PREPEND_FLAGS=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++ -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" SLURM_PROCID="9" CXX_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" HF_TRANSFORMERS_CACHE_DISABLE_FLASH_ATTN_2="1" ELFEDIT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-elfedit" CONDA_PROMPT_MODIFIER="(deepseeksft310) " TMPDIR="/tmp" CMAKE_PREFIX_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot/usr" CUDACXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/nvcc" CPPFLAGS="-DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" SLURM_NTASKS="24" LD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld" SLURM_TOPOLOGY_ADDR="osk-gpu56" SSH_CONNECTION="100.113.255.14 54546 10.255.255.101 22" READELF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-readelf" ZE_AFFINITY_MASK="0,1,2,3,4,5,6,7" PYTORCH_CUDA_ALLOC_CONF="expandable_segments:True" GXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-g++" MASTER_ADDR="osk-gpu54" SLURM_TOPOLOGY_ADDR_PATTERN="node" CUDA_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" GCC_AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ar" ADDR2LINE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-addr2line" XDG_SESSION_CLASS="user" SLURM_WORKING_CLUSTER="osk-cluster:10.255.255.100:6817:9728:109" PYTHONPATH="/home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat:/home/Competition2025/P02/P02U006/ColossalAI:" TERM="xterm-256color" TORCH_NCCL_ASYNC_ERROR_HANDLING="0" GCC_NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-nm" SIZE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-size" HOST="x86_64-conda-linux-gnu" LESSOPEN="||/usr/bin/lesspipe.sh %s" CC_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" USER="P02U006" LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" SLURM_NODELIST="osk-gpu[54,56,91]" ENVIRONMENT="BATCH" GPU_DEVICE_ORDINAL="0,1,2,3,4,5,6,7" CONDA_SHLVL="1" MODULES_RUN_QUARANTINE="LD_LIBRARY_PATH LD_PRELOAD" AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar" AS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-as" DEBUG_CPPFLAGS="-D_DEBUG -D_FORTIFY_SOURCE=2 -Og -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_PRIO_PROCESS="0" host_alias="x86_64-conda-linux-gnu" SLURM_NPROCS="24" PYTHONFAULTHANDLER="1" SHLVL="2" SLURM_NNODES="3" NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-nm" GCC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc" PMIX_MCA_gds="^ds12" XDG_SESSION_ID="64665" SLURM_SUBMIT_HOST="osk-cpu01" LD_GOLD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld.gold" CONDA_PYTHON_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/python" LD_LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" XDG_RUNTIME_DIR="/run/user/11034" SLURM_JOB_ID="328550" UCX_MAX_RNDV_RAILS="8" SLURM_NODEID="1" SSH_CLIENT="100.113.255.14 54546 22" CONDA_DEFAULT_ENV="deepseeksft310" __MODULES_LMINIT="module use --append /home/appli/modulefiles:module use --append /usr/share/Modules/modulefiles:module use --append /etc/modulefiles:module use --append /usr/share/modulefiles" OBJCOPY="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objcopy" OMPI_MCA_coll_hcoll_enable="0" which_declare="declare -f" STRIP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip" CUDA_HOME="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" NVCC_PREPEND_FLAGS_BACKUP=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" XDG_DATA_DIRS="/home/Competition2025/P02/P02U006/.local/share/flatpak/exports/share:/var/lib/flatpak/exports/share:/usr/local/share:/usr/share" OBJDUMP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objdump" SLURM_CONF="/etc/slurm/slurm.conf" PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/condabin:/home/Competition2025/P02/P02U006/.local/bin:/home/Competition2025/P02/P02U006/bin:/usr/share/Modules/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin" SLURM_JOB_NAME="lora-r1" MODULEPATH="/etc/scl/modulefiles:/home/appli/modulefiles:/usr/share/Modules/modulefiles:/etc/modulefiles:/usr/share/modulefiles" CC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" SLURM_NTASKS_PER_NODE="8" CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" CXXFILT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++filt" DBUS_SESSION_BUS_ADDRESS="unix:path=/run/user/11034/bus" BUILD="x86_64-conda-linux-gnu" MAIL="/var/spool/mail/P02U006" SSH_TTY="/dev/pts/47" SLURM_JOB_GID="11034" CPATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib/python3.10/site-packages/nvidia/cublas/include:" RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib" CONDA_BUILD_SYSROOT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot" UCX_MAX_EAGER_RAILS="8" OLDPWD="/home/Competition2025/P02/P02U006" SLURM_JOB_NODELIST="osk-gpu[54,56,91]" MODULES_CMD="/usr/share/Modules/libexec/modulecmd.tcl" TORCH_ELASTIC_STORE_TIMEOUT="3600" _="/usr/bin/srun" SLURM_MPI_TYPE="pmix_v3" SRUN_DEBUG="3" SLURM_UMASK="0022" SLURM_JOB_CPUS_PER_NODE_PACK_GROUP_0="8(x3)" SLURM_DISTRIBUTION="block" SLURM_STEP_ID="0" SLURM_STEPID="0" SLURM_STEP_NODELIST="osk-gpu[54,56,91]" SLURM_STEP_NUM_NODES="3" SLURM_STEP_NUM_TASKS="24" SLURM_STEP_TASKS_PER_NODE="8(x3)" SLURM_STEP_LAUNCHER_PORT="32819" SLURM_SRUN_COMM_PORT="32819" SLURM_PMIXP_ABORT_AGENT_PORT="34205" SLURM_PMIX_MAPPING_SERV="(vector,(0,3,8))" SLURM_SRUN_COMM_HOST="192.168.11.54" SLURM_STEP_GPUS="0,1,2,3,4,5,6,7" SLURM_CPU_BIND="quiet,none" SLURM_CPU_BIND_TYPE="none" SLURM_CPU_BIND_VERBOSE="quiet" SLURM_LAUNCH_NODE_IPADDR="192.168.11.54" PMIX_NAMESPACE="slurm.pmix.328550.0" PMIX_RANK="9" PMIX_SERVER_URI3="pmix-server.1574131;tcp4://127.0.0.1:42971" PMIX_SERVER_URI2="pmix-server.1574131;tcp4://127.0.0.1:42971" PMIX_SERVER_URI21="pmix-server.1574131;tcp4://127.0.0.1:42971" PMIX_SECURITY_MODE="munge,native" PMIX_PTL_MODULE="tcp,usock" PMIX_BFROP_BUFFER_TYPE="PMIX_BFROP_BUFFER_NON_DESC" PMIX_GDS_MODULE="ds21,ds12,hash" PMIX_SERVER_TMPDIR="/var/spool/slurm/d/pmix.328550.0/" PMIX_SYSTEM_TMPDIR="/tmp" PMIX_DSTORE_21_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds21_1574131" PMIX_DSTORE_ESH_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds12_1574131" PMIX_HOSTNAME="osk-gpu56" PMIX_VERSION="3.2.3" CUDA_DEVICE_MAX_CONNECTIONS="1" && torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora'

Exit code: 1

Stdout: already printed

Stderr: already printed



====== Training on All Nodes =====
127.0.0.1: failure

====== Stopping All Nodes =====
127.0.0.1: finish
Error: failed to run torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora on 127.0.0.1, is localhost: True, exception: Encountered a bad command exit code!

Command: 'cd /home/Competition2025/P02/P02U006/ColossalAI && export SHELL="/bin/bash" SLURM_GPUS_PER_NODE="8" GCC_RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ranlib" SLURM_JOB_USER="P02U006" SLURM_TASKS_PER_NODE="8(x3)" SLURM_JOB_UID="11034" HISTCONTROL="ignoredups" SLURM_TASK_PID="1574147" CONDA_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/conda" SLURM_JOB_GPUS="0,1,2,3,4,5,6,7" SLURM_LOCALID="6" build_alias="x86_64-conda-linux-gnu" SLURM_SUBMIT_DIR="/home/Competition2025/P02/P02U006/ColossalAI" CMAKE_ARGS="-DCMAKE_AR=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar -DCMAKE_RANLIB=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib -DCMAKE_LINKER=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld -DCMAKE_STRIP=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip -DCMAKE_BUILD_TYPE=Release" HOSTNAME="osk-gpu54" HISTSIZE="1000" SLURMD_NODENAME="osk-gpu56" FLASH_ATTENTION_DISABLE="1" MASTER_PORT="13700" GPROF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gprof" _CONDA_PYTHON_SYSCONFIGDATA_NAME="_sysconfigdata_x86_64_conda_cos7_linux_gnu" STRINGS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strings" CPP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cpp" NCCL_NET_PLUGIN="none" SLURM_NODE_ALIASES="(null)" SLURM_CLUSTER_NAME="osk-cluster" SLURM_CPUS_ON_NODE="8" SLURM_JOB_CPUS_PER_NODE="8(x3)" NCCL_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" SLURM_GPUS_ON_NODE="8" PWD="/home/Competition2025/P02/P02U006/ColossalAI" SLURM_GTIDS="8,9,10,11,12,13,14,15" GSETTINGS_SCHEMA_DIR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/share/glib-2.0/schemas" LOGNAME="P02U006" UCX_NET_DEVICES="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" XDG_SESSION_TYPE="tty" CONDA_PREFIX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" SLURM_JOB_PARTITION="P02" MODULESHOME="/usr/share/Modules" MANPATH="/usr/share/man:" ROCR_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" NCCL_DEBUG="INFO" SLURM_JOB_NUM_NODES="3" CXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" NCCL_TIMEOUT="3600" SLURM_JOBID="328550" GLOO_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" NCCL_IB_HCA="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" DEBUG_CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_JOB_QOS="normal" MOTD_SHOWN="pam" TORCH_NCCL_BLOCKING_WAIT="1" LDFLAGS="-Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,-rpath,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -Wl,-rpath-link,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib  -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib/stubs" __MODULES_SHARE_MANPATH=":1" HOME="/home/Competition2025/P02/P02U006" LANG="en_US.UTF-8" DEBUG_CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" LS_COLORS="rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=01;37;41:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.webp=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=01;36:*.au=01;36:*.flac=01;36:*.m4a=01;36:*.mid=01;36:*.midi=01;36:*.mka=01;36:*.mp3=01;36:*.mpc=01;36:*.ogg=01;36:*.ra=01;36:*.wav=01;36:*.oga=01;36:*.opus=01;36:*.spx=01;36:*.xspf=01;36:" NVCC_PREPEND_FLAGS=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++ -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" SLURM_PROCID="14" CXX_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" HF_TRANSFORMERS_CACHE_DISABLE_FLASH_ATTN_2="1" ELFEDIT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-elfedit" CONDA_PROMPT_MODIFIER="(deepseeksft310) " TMPDIR="/tmp" CMAKE_PREFIX_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot/usr" CUDACXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/nvcc" CPPFLAGS="-DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" SLURM_NTASKS="24" LD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld" SLURM_TOPOLOGY_ADDR="osk-gpu56" SSH_CONNECTION="100.113.255.14 54546 10.255.255.101 22" READELF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-readelf" ZE_AFFINITY_MASK="0,1,2,3,4,5,6,7" PYTORCH_CUDA_ALLOC_CONF="expandable_segments:True" GXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-g++" MASTER_ADDR="osk-gpu54" SLURM_TOPOLOGY_ADDR_PATTERN="node" CUDA_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" GCC_AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ar" ADDR2LINE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-addr2line" XDG_SESSION_CLASS="user" SLURM_WORKING_CLUSTER="osk-cluster:10.255.255.100:6817:9728:109" PYTHONPATH="/home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat:/home/Competition2025/P02/P02U006/ColossalAI:" TERM="xterm-256color" TORCH_NCCL_ASYNC_ERROR_HANDLING="0" GCC_NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-nm" SIZE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-size" HOST="x86_64-conda-linux-gnu" LESSOPEN="||/usr/bin/lesspipe.sh %s" CC_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" USER="P02U006" LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" SLURM_NODELIST="osk-gpu[54,56,91]" ENVIRONMENT="BATCH" GPU_DEVICE_ORDINAL="0,1,2,3,4,5,6,7" CONDA_SHLVL="1" MODULES_RUN_QUARANTINE="LD_LIBRARY_PATH LD_PRELOAD" AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar" AS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-as" DEBUG_CPPFLAGS="-D_DEBUG -D_FORTIFY_SOURCE=2 -Og -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_PRIO_PROCESS="0" host_alias="x86_64-conda-linux-gnu" SLURM_NPROCS="24" PYTHONFAULTHANDLER="1" SHLVL="2" SLURM_NNODES="3" NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-nm" GCC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc" PMIX_MCA_gds="^ds12" XDG_SESSION_ID="64665" SLURM_SUBMIT_HOST="osk-cpu01" LD_GOLD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld.gold" CONDA_PYTHON_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/python" LD_LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" XDG_RUNTIME_DIR="/run/user/11034" SLURM_JOB_ID="328550" UCX_MAX_RNDV_RAILS="8" SLURM_NODEID="1" SSH_CLIENT="100.113.255.14 54546 22" CONDA_DEFAULT_ENV="deepseeksft310" __MODULES_LMINIT="module use --append /home/appli/modulefiles:module use --append /usr/share/Modules/modulefiles:module use --append /etc/modulefiles:module use --append /usr/share/modulefiles" OBJCOPY="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objcopy" OMPI_MCA_coll_hcoll_enable="0" which_declare="declare -f" STRIP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip" CUDA_HOME="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" NVCC_PREPEND_FLAGS_BACKUP=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" XDG_DATA_DIRS="/home/Competition2025/P02/P02U006/.local/share/flatpak/exports/share:/var/lib/flatpak/exports/share:/usr/local/share:/usr/share" OBJDUMP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objdump" SLURM_CONF="/etc/slurm/slurm.conf" PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/condabin:/home/Competition2025/P02/P02U006/.local/bin:/home/Competition2025/P02/P02U006/bin:/usr/share/Modules/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin" SLURM_JOB_NAME="lora-r1" MODULEPATH="/etc/scl/modulefiles:/home/appli/modulefiles:/usr/share/Modules/modulefiles:/etc/modulefiles:/usr/share/modulefiles" CC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" SLURM_NTASKS_PER_NODE="8" CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" CXXFILT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++filt" DBUS_SESSION_BUS_ADDRESS="unix:path=/run/user/11034/bus" BUILD="x86_64-conda-linux-gnu" MAIL="/var/spool/mail/P02U006" SSH_TTY="/dev/pts/47" SLURM_JOB_GID="11034" CPATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib/python3.10/site-packages/nvidia/cublas/include:" RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib" CONDA_BUILD_SYSROOT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot" UCX_MAX_EAGER_RAILS="8" OLDPWD="/home/Competition2025/P02/P02U006" SLURM_JOB_NODELIST="osk-gpu[54,56,91]" MODULES_CMD="/usr/share/Modules/libexec/modulecmd.tcl" TORCH_ELASTIC_STORE_TIMEOUT="3600" _="/usr/bin/srun" SLURM_MPI_TYPE="pmix_v3" SRUN_DEBUG="3" SLURM_UMASK="0022" SLURM_JOB_CPUS_PER_NODE_PACK_GROUP_0="8(x3)" SLURM_DISTRIBUTION="block" SLURM_STEP_ID="0" SLURM_STEPID="0" SLURM_STEP_NODELIST="osk-gpu[54,56,91]" SLURM_STEP_NUM_NODES="3" SLURM_STEP_NUM_TASKS="24" SLURM_STEP_TASKS_PER_NODE="8(x3)" SLURM_STEP_LAUNCHER_PORT="32819" SLURM_SRUN_COMM_PORT="32819" SLURM_PMIXP_ABORT_AGENT_PORT="34205" SLURM_PMIX_MAPPING_SERV="(vector,(0,3,8))" SLURM_SRUN_COMM_HOST="192.168.11.54" SLURM_STEP_GPUS="0,1,2,3,4,5,6,7" SLURM_CPU_BIND="quiet,none" SLURM_CPU_BIND_TYPE="none" SLURM_CPU_BIND_VERBOSE="quiet" SLURM_LAUNCH_NODE_IPADDR="192.168.11.54" PMIX_NAMESPACE="slurm.pmix.328550.0" PMIX_RANK="14" PMIX_SERVER_URI3="pmix-server.1574131;tcp4://127.0.0.1:42971" PMIX_SERVER_URI2="pmix-server.1574131;tcp4://127.0.0.1:42971" PMIX_SERVER_URI21="pmix-server.1574131;tcp4://127.0.0.1:42971" PMIX_SECURITY_MODE="munge,native" PMIX_PTL_MODULE="tcp,usock" PMIX_BFROP_BUFFER_TYPE="PMIX_BFROP_BUFFER_NON_DESC" PMIX_GDS_MODULE="ds21,ds12,hash" PMIX_SERVER_TMPDIR="/var/spool/slurm/d/pmix.328550.0/" PMIX_SYSTEM_TMPDIR="/tmp" PMIX_DSTORE_21_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds21_1574131" PMIX_DSTORE_ESH_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds12_1574131" PMIX_HOSTNAME="osk-gpu56" PMIX_VERSION="3.2.3" CUDA_DEVICE_MAX_CONNECTIONS="1" && torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora'

Exit code: 1

Stdout: already printed

Stderr: already printed



====== Training on All Nodes =====
127.0.0.1: failure

====== Stopping All Nodes =====
127.0.0.1: finish
Error: failed to run torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora on 127.0.0.1, is localhost: True, exception: Encountered a bad command exit code!

Command: 'cd /home/Competition2025/P02/P02U006/ColossalAI && export SHELL="/bin/bash" SLURM_GPUS_PER_NODE="8" GCC_RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ranlib" SLURM_JOB_USER="P02U006" SLURM_TASKS_PER_NODE="8(x3)" SLURM_JOB_UID="11034" HISTCONTROL="ignoredups" SLURM_TASK_PID="1574146" CONDA_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/conda" SLURM_JOB_GPUS="0,1,2,3,4,5,6,7" SLURM_LOCALID="5" build_alias="x86_64-conda-linux-gnu" SLURM_SUBMIT_DIR="/home/Competition2025/P02/P02U006/ColossalAI" CMAKE_ARGS="-DCMAKE_AR=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar -DCMAKE_RANLIB=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib -DCMAKE_LINKER=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld -DCMAKE_STRIP=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip -DCMAKE_BUILD_TYPE=Release" HOSTNAME="osk-gpu54" HISTSIZE="1000" SLURMD_NODENAME="osk-gpu56" FLASH_ATTENTION_DISABLE="1" MASTER_PORT="13700" GPROF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gprof" _CONDA_PYTHON_SYSCONFIGDATA_NAME="_sysconfigdata_x86_64_conda_cos7_linux_gnu" STRINGS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strings" CPP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cpp" NCCL_NET_PLUGIN="none" SLURM_NODE_ALIASES="(null)" SLURM_CLUSTER_NAME="osk-cluster" SLURM_CPUS_ON_NODE="8" SLURM_JOB_CPUS_PER_NODE="8(x3)" NCCL_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" SLURM_GPUS_ON_NODE="8" PWD="/home/Competition2025/P02/P02U006/ColossalAI" SLURM_GTIDS="8,9,10,11,12,13,14,15" GSETTINGS_SCHEMA_DIR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/share/glib-2.0/schemas" LOGNAME="P02U006" UCX_NET_DEVICES="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" XDG_SESSION_TYPE="tty" CONDA_PREFIX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" SLURM_JOB_PARTITION="P02" MODULESHOME="/usr/share/Modules" MANPATH="/usr/share/man:" ROCR_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" NCCL_DEBUG="INFO" SLURM_JOB_NUM_NODES="3" CXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" NCCL_TIMEOUT="3600" SLURM_JOBID="328550" GLOO_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" NCCL_IB_HCA="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" DEBUG_CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_JOB_QOS="normal" MOTD_SHOWN="pam" TORCH_NCCL_BLOCKING_WAIT="1" LDFLAGS="-Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,-rpath,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -Wl,-rpath-link,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib  -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib/stubs" __MODULES_SHARE_MANPATH=":1" HOME="/home/Competition2025/P02/P02U006" LANG="en_US.UTF-8" DEBUG_CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" LS_COLORS="rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=01;37;41:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.webp=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=01;36:*.au=01;36:*.flac=01;36:*.m4a=01;36:*.mid=01;36:*.midi=01;36:*.mka=01;36:*.mp3=01;36:*.mpc=01;36:*.ogg=01;36:*.ra=01;36:*.wav=01;36:*.oga=01;36:*.opus=01;36:*.spx=01;36:*.xspf=01;36:" NVCC_PREPEND_FLAGS=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++ -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" SLURM_PROCID="13" CXX_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" HF_TRANSFORMERS_CACHE_DISABLE_FLASH_ATTN_2="1" ELFEDIT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-elfedit" CONDA_PROMPT_MODIFIER="(deepseeksft310) " TMPDIR="/tmp" CMAKE_PREFIX_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot/usr" CUDACXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/nvcc" CPPFLAGS="-DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" SLURM_NTASKS="24" LD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld" SLURM_TOPOLOGY_ADDR="osk-gpu56" SSH_CONNECTION="100.113.255.14 54546 10.255.255.101 22" READELF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-readelf" ZE_AFFINITY_MASK="0,1,2,3,4,5,6,7" PYTORCH_CUDA_ALLOC_CONF="expandable_segments:True" GXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-g++" MASTER_ADDR="osk-gpu54" SLURM_TOPOLOGY_ADDR_PATTERN="node" CUDA_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" GCC_AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ar" ADDR2LINE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-addr2line" XDG_SESSION_CLASS="user" SLURM_WORKING_CLUSTER="osk-cluster:10.255.255.100:6817:9728:109" PYTHONPATH="/home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat:/home/Competition2025/P02/P02U006/ColossalAI:" TERM="xterm-256color" TORCH_NCCL_ASYNC_ERROR_HANDLING="0" GCC_NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-nm" SIZE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-size" HOST="x86_64-conda-linux-gnu" LESSOPEN="||/usr/bin/lesspipe.sh %s" CC_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" USER="P02U006" LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" SLURM_NODELIST="osk-gpu[54,56,91]" ENVIRONMENT="BATCH" GPU_DEVICE_ORDINAL="0,1,2,3,4,5,6,7" CONDA_SHLVL="1" MODULES_RUN_QUARANTINE="LD_LIBRARY_PATH LD_PRELOAD" AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar" AS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-as" DEBUG_CPPFLAGS="-D_DEBUG -D_FORTIFY_SOURCE=2 -Og -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_PRIO_PROCESS="0" host_alias="x86_64-conda-linux-gnu" SLURM_NPROCS="24" PYTHONFAULTHANDLER="1" SHLVL="2" SLURM_NNODES="3" NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-nm" GCC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc" PMIX_MCA_gds="^ds12" XDG_SESSION_ID="64665" SLURM_SUBMIT_HOST="osk-cpu01" LD_GOLD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld.gold" CONDA_PYTHON_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/python" LD_LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" XDG_RUNTIME_DIR="/run/user/11034" SLURM_JOB_ID="328550" UCX_MAX_RNDV_RAILS="8" SLURM_NODEID="1" SSH_CLIENT="100.113.255.14 54546 22" CONDA_DEFAULT_ENV="deepseeksft310" __MODULES_LMINIT="module use --append /home/appli/modulefiles:module use --append /usr/share/Modules/modulefiles:module use --append /etc/modulefiles:module use --append /usr/share/modulefiles" OBJCOPY="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objcopy" OMPI_MCA_coll_hcoll_enable="0" which_declare="declare -f" STRIP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip" CUDA_HOME="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" NVCC_PREPEND_FLAGS_BACKUP=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" XDG_DATA_DIRS="/home/Competition2025/P02/P02U006/.local/share/flatpak/exports/share:/var/lib/flatpak/exports/share:/usr/local/share:/usr/share" OBJDUMP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objdump" SLURM_CONF="/etc/slurm/slurm.conf" PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/condabin:/home/Competition2025/P02/P02U006/.local/bin:/home/Competition2025/P02/P02U006/bin:/usr/share/Modules/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin" SLURM_JOB_NAME="lora-r1" MODULEPATH="/etc/scl/modulefiles:/home/appli/modulefiles:/usr/share/Modules/modulefiles:/etc/modulefiles:/usr/share/modulefiles" CC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" SLURM_NTASKS_PER_NODE="8" CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" CXXFILT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++filt" DBUS_SESSION_BUS_ADDRESS="unix:path=/run/user/11034/bus" BUILD="x86_64-conda-linux-gnu" MAIL="/var/spool/mail/P02U006" SSH_TTY="/dev/pts/47" SLURM_JOB_GID="11034" CPATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib/python3.10/site-packages/nvidia/cublas/include:" RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib" CONDA_BUILD_SYSROOT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot" UCX_MAX_EAGER_RAILS="8" OLDPWD="/home/Competition2025/P02/P02U006" SLURM_JOB_NODELIST="osk-gpu[54,56,91]" MODULES_CMD="/usr/share/Modules/libexec/modulecmd.tcl" TORCH_ELASTIC_STORE_TIMEOUT="3600" _="/usr/bin/srun" SLURM_MPI_TYPE="pmix_v3" SRUN_DEBUG="3" SLURM_UMASK="0022" SLURM_JOB_CPUS_PER_NODE_PACK_GROUP_0="8(x3)" SLURM_DISTRIBUTION="block" SLURM_STEP_ID="0" SLURM_STEPID="0" SLURM_STEP_NODELIST="osk-gpu[54,56,91]" SLURM_STEP_NUM_NODES="3" SLURM_STEP_NUM_TASKS="24" SLURM_STEP_TASKS_PER_NODE="8(x3)" SLURM_STEP_LAUNCHER_PORT="32819" SLURM_SRUN_COMM_PORT="32819" SLURM_PMIXP_ABORT_AGENT_PORT="34205" SLURM_PMIX_MAPPING_SERV="(vector,(0,3,8))" SLURM_SRUN_COMM_HOST="192.168.11.54" SLURM_STEP_GPUS="0,1,2,3,4,5,6,7" SLURM_CPU_BIND="quiet,none" SLURM_CPU_BIND_TYPE="none" SLURM_CPU_BIND_VERBOSE="quiet" SLURM_LAUNCH_NODE_IPADDR="192.168.11.54" PMIX_NAMESPACE="slurm.pmix.328550.0" PMIX_RANK="13" PMIX_SERVER_URI3="pmix-server.1574131;tcp4://127.0.0.1:42971" PMIX_SERVER_URI2="pmix-server.1574131;tcp4://127.0.0.1:42971" PMIX_SERVER_URI21="pmix-server.1574131;tcp4://127.0.0.1:42971" PMIX_SECURITY_MODE="munge,native" PMIX_PTL_MODULE="tcp,usock" PMIX_BFROP_BUFFER_TYPE="PMIX_BFROP_BUFFER_NON_DESC" PMIX_GDS_MODULE="ds21,ds12,hash" PMIX_SERVER_TMPDIR="/var/spool/slurm/d/pmix.328550.0/" PMIX_SYSTEM_TMPDIR="/tmp" PMIX_DSTORE_21_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds21_1574131" PMIX_DSTORE_ESH_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds12_1574131" PMIX_HOSTNAME="osk-gpu56" PMIX_VERSION="3.2.3" CUDA_DEVICE_MAX_CONNECTIONS="1" && torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora'

Exit code: 1

Stdout: already printed

Stderr: already printed



====== Training on All Nodes =====
127.0.0.1: failure
Error: failed to run torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora on 127.0.0.1, is localhost: True, exception: Encountered a bad command exit code!

Command: 'cd /home/Competition2025/P02/P02U006/ColossalAI && export SHELL="/bin/bash" SLURM_GPUS_PER_NODE="8" GCC_RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ranlib" SLURM_JOB_USER="P02U006" SLURM_TASKS_PER_NODE="8(x3)" SLURM_JOB_UID="11034" HISTCONTROL="ignoredups" SLURM_TASK_PID="1574148" CONDA_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/conda" SLURM_JOB_GPUS="0,1,2,3,4,5,6,7" SLURM_LOCALID="7" build_alias="x86_64-conda-linux-gnu" SLURM_SUBMIT_DIR="/home/Competition2025/P02/P02U006/ColossalAI" CMAKE_ARGS="-DCMAKE_AR=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar -DCMAKE_RANLIB=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib -DCMAKE_LINKER=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld -DCMAKE_STRIP=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip -DCMAKE_BUILD_TYPE=Release" HOSTNAME="osk-gpu54" HISTSIZE="1000" SLURMD_NODENAME="osk-gpu56" FLASH_ATTENTION_DISABLE="1" MASTER_PORT="13700" GPROF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gprof" _CONDA_PYTHON_SYSCONFIGDATA_NAME="_sysconfigdata_x86_64_conda_cos7_linux_gnu" STRINGS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strings" CPP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cpp" NCCL_NET_PLUGIN="none" SLURM_NODE_ALIASES="(null)" SLURM_CLUSTER_NAME="osk-cluster" SLURM_CPUS_ON_NODE="8" SLURM_JOB_CPUS_PER_NODE="8(x3)" NCCL_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" SLURM_GPUS_ON_NODE="8" PWD="/home/Competition2025/P02/P02U006/ColossalAI" SLURM_GTIDS="8,9,10,11,12,13,14,15" GSETTINGS_SCHEMA_DIR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/share/glib-2.0/schemas" LOGNAME="P02U006" UCX_NET_DEVICES="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" XDG_SESSION_TYPE="tty" CONDA_PREFIX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" SLURM_JOB_PARTITION="P02" MODULESHOME="/usr/share/Modules" MANPATH="/usr/share/man:" ROCR_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" NCCL_DEBUG="INFO" SLURM_JOB_NUM_NODES="3" CXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" NCCL_TIMEOUT="3600" SLURM_JOBID="328550" GLOO_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" NCCL_IB_HCA="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" DEBUG_CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_JOB_QOS="normal" MOTD_SHOWN="pam" TORCH_NCCL_BLOCKING_WAIT="1" LDFLAGS="-Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,-rpath,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -Wl,-rpath-link,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib  -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib/stubs" __MODULES_SHARE_MANPATH=":1" HOME="/home/Competition2025/P02/P02U006" LANG="en_US.UTF-8" DEBUG_CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" LS_COLORS="rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=01;37;41:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.webp=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=01;36:*.au=01;36:*.flac=01;36:*.m4a=01;36:*.mid=01;36:*.midi=01;36:*.mka=01;36:*.mp3=01;36:*.mpc=01;36:*.ogg=01;36:*.ra=01;36:*.wav=01;36:*.oga=01;36:*.opus=01;36:*.spx=01;36:*.xspf=01;36:" NVCC_PREPEND_FLAGS=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++ -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" SLURM_PROCID="15" CXX_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" HF_TRANSFORMERS_CACHE_DISABLE_FLASH_ATTN_2="1" ELFEDIT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-elfedit" CONDA_PROMPT_MODIFIER="(deepseeksft310) " TMPDIR="/tmp" CMAKE_PREFIX_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot/usr" CUDACXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/nvcc" CPPFLAGS="-DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" SLURM_NTASKS="24" LD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld" SLURM_TOPOLOGY_ADDR="osk-gpu56" SSH_CONNECTION="100.113.255.14 54546 Error: failed to run torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora on 127.0.0.1, is localhost: True, exception: Encountered a bad command exit code!

Command: 'cd /home/Competition2025/P02/P02U006/ColossalAI && export SHELL="/bin/bash" SLURM_GPUS_PER_NODE="8" GCC_RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ranlib" SLURM_JOB_USER="P02U006" SLURM_TASKS_PER_NODE="8(x3)" SLURM_JOB_UID="11034" HISTCONTROL="ignoredups" SLURM_TASK_PID="1574143" CONDA_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/conda" SLURM_JOB_GPUS="0,1,2,3,4,5,6,7" SLURM_LOCALID="2" build_alias="x86_64-conda-linux-gnu" SLURM_SUBMIT_DIR="/home/Competition2025/P02/P02U006/ColossalAI" CMAKE_ARGS="-DCMAKE_AR=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar -DCMAKE_RANLIB=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib -DCMAKE_LINKER=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld -DCMAKE_STRIP=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip -DCMAKE_BUILD_TYPE=Release" HOSTNAME="osk-gpu54" HISTSIZE="1000" SLURMD_NODENAME="osk-gpu56" FLASH_ATTENTION_DISABLE="1" MASTER_PORT="13700" GPROF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gprof" _CONDA_PYTHON_SYSCONFIGDATA_NAME="_sysconfigdata_x86_64_conda_cos7_linux_gnu" STRINGS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strings" CPP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cpp" NCCL_NET_PLUGIN="none" SLURM_NODE_ALIASES="(null)" SLURM_CLUSTER_NAME="osk-cluster" SLURM_CPUS_ON_NODE="8" SLURM_JOB_CPUS_PER_NODE="8(x3)" NCCL_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" SLURM_GPUS_ON_NODE="8" PWD="/home/Competition2025/P02/P02U006/ColossalAI" SLURM_GTIDS="8,9,10,11,12,13,14,15" GSETTINGS_SCHEMA_DIR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/share/glib-2.0/schemas" LOGNAME="P02U006" UCX_NET_DEVICES="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" XDG_SESSION_TYPE="tty" CONDA_PREFIX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" SLURM_JOB_PARTITION="P02" MODULESHOME="/usr/share/Modules" MANPATH="/usr/share/man:" ROCR_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" NCCL_DEBUG="INFO" SLURM_JOB_NUM_NODES="3" CXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" NCCL_TIMEOUT="3600" SLURM_JOBID="328550" GLOO_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" NCCL_IB_HCA="mlx5_0:1,mlx5_1:1,mlx5_2:110.255.255.101 22" READELF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-readelf" ZE_AFFINITY_MASK="0,1,2,3,4,5,6,7" PYTORCH_CUDA_ALLOC_CONF="expandable_segments:True" GXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-g++" MASTER_ADDR="osk-gpu54" SLURM_TOPOLOGY_ADDR_PATTERN="node" CUDA_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" GCC_AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ar" ADDR2LINE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-addr2line" XDG_SESSION_CLASS="user" SLURM_WORKING_CLUSTER="osk-cluster:10.255.255.100:6817:9728:109" PYTHONPATH="/home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat:/home/Competition2025/P02/P02U006/ColossalAI:" TERM="xterm-256color" TORCH_NCCL_ASYNC_ERROR_HANDLING="0" GCC_NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-nm" SIZE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-size" HOST="x86_64-conda-linux-gnu" LESSOPEN="||/usr/bin/lesspipe.sh %s" CC_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" USER="P02U006" LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" SLURM_NODELIST="osk-gpu[54,56,91]" ENVIRONMENT="BATCH" GPU_DEVICE_ORDINAL="0,1,2,3,4,5,6,7" CONDA_SHLVL="1" MODULES_RUN_QUARANTINE="LD_LIBRARY_PATH LD_PRELOAD" AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar" AS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-as" DEBUG_CPPFLAGS="-D_DEBUG -D_FORTIFY_SOURCE=2 -Og -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_PRIO_PROCESS="0" host_alias="x86_64-conda-linux-gnu" SLURM_NPROCS="24" PYTHONFAULTHANDLER="1" SHLVL="2" SLURM_NNODES="3" NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-nm" GCC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc" PMIX_MCA_gds="^ds12" XDG_SESSION_ID="64665" SLURM_SUBMIT_HOST="osk-cpu01" LD_GOLD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld.gold" CONDA_PYTHON_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/python" LD_LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" XDG_RUNTIME_DIR="/run/user/11034" SLURM_JOB_ID="328550" UCX_MAX_RNDV_RAILS="8" SLURM_NODEID="1" SSH_CLIENT="100.113.255.14 54546 22" CONDA_DEFAULT_ENV="deepseeksft310" __MODULES_LMINIT="module use --append /home/appli/modulefiles:module use --append /usr/share/Modules/modulefiles:module use --append /etc/modulefiles:module use --append /usr/share/modulefiles" OBJCOPY="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objcopy" OMPI_MCA_coll_hcoll_enable="0" which_declare="declare -f" STRIP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip" CUDA_HOME="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" NVCC_PREPEND_FLAGS_BACKUP=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" XDG_DATA_DIRS="/home/Competition2025/P02/P02U006/.local/share/flatpak/exports/share:/var/lib/flatpak/exports/share:/usr/local/share:/usr/share" OBJDUMP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objdump" SLURM_CONF="/etc/slurm/slurm.conf" PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/condabin:/home/Co,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" DEBUG_CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_JOB_QOS="normal" MOTD_SHOWN="pam" TORCH_NCCL_BLOCKING_WAIT="1" LDFLAGS="-Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,-rpath,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -Wl,-rpath-link,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib  -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib/stubs" __MODULES_SHARE_MANPATH=":1" HOME="/home/Competition2025/P02/P02U006" LANG="en_US.UTF-8" DEBUG_CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" LS_COLORS="rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=01;37;41:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.webp=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=01;36:*.au=01;36:*.flac=01;36:*.m4a=01;36:*.mid=01;36:*.midi=01;36:*.mka=01;36:*.mp3=01;36:*.mpc=01;36:*.ogg=01;36:*.ra=01;36:*.wav=01;36:*.oga=01;36:*.opus=01;36:*.spx=01;36:*.xspf=01;36:" NVCC_PREPEND_FLAGS=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++ -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" SLURM_PROCID="10" CXX_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" HF_TRANSFORMERS_CACHE_DISABLE_FLASH_ATTN_2="1" ELFEDIT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-elfedit" CONDA_PROMPT_MODIFIER="(deepseeksft310) " TMPDIR="/tmp" CMAKE_PREFIX_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot/usr" CUDACXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/nvcc" CPPFLAGS="-DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" SLURM_NTASKS="24" LD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld" SLURM_TOPOLOGY_ADDR="osk-gpu56" SSH_CONNECTION="100.113.255.14 54546 mpetition2025/P02/P02U006/.local/bin:/home/Competition2025/P02/P02U006/bin:/usr/share/Modules/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin" SLURM_JOB_NAME="lora-r1" MODULEPATH="/etc/scl/modulefiles:/home/appli/modulefiles:/usr/share/Modules/modulefiles:/etc/modulefiles:/usr/share/modulefiles" CC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" SLURM_NTASKS_PER_NODE="8" CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" CXXFILT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++filt" DBUS_SESSION_BUS_ADDRESS="unix:path=/run/user/11034/bus" BUILD="x86_64-conda-linux-gnu" MAIL="/var/spool/mail/P02U006" SSH_TTY="/dev/pts/47" SLURM_JOB_GID="11034" CPATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib/python3.10/site-packages/nvidia/cublas/include:" RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib" CONDA_BUILD_SYSROOT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot" UCX_MAX_EAGER_RAILS="8" OLDPWD="/home/Competition2025/P02/P02U006" SLURM_JOB_NODELIST="osk-gpu[54,56,91]" MODULES_CMD="/usr/share/Modules/libexec/modulecmd.tcl" TORCH_ELASTIC_STORE_TIMEOUT="3600" _="/usr/bin/srun" SLURM_MPI_TYPE="pmix_v3" SRUN_DEBUG="3" SLURM_UMASK="0022" SLURM_JOB_CPUS_PER_NODE_PACK_GROUP_0="8(x3)" SLURM_DISTRIBUTION="block" SLURM_STEP_ID="0" SLURM_STEPID="0" SLURM_STEP_NODELIST="osk-gpu[54,56,91]" SLURM_STEP_NUM_NODES="3" SLURM_STEP_NUM_TASKS="24" SLURM_STEP_TASKS_PER_NODE="8(x3)" SLURM_STEP_LAUNCHER_PORT="32819" SLURM_SRUN_COMM_PORT="32819" SLURM_PMIXP_ABORT_AGENT_PORT="34205" SLURM_PMIX_MAPPING_SERV="(vector,(0,3,8))" SLURM_SRUN_COMM_HOST="192.168.11.54" SLURM_STEP_GPUS="0,1,2,3,4,5,6,7" SLURM_CPU_BIND="quiet,none" SLURM_CPU_BIND_TYPE="none" SLURM_CPU_BIND_VERBOSE="quiet" SLURM_LAUNCH_NODE_IPADDR="192.168.11.54" PMIX_NAMESPACE="slurm.pmix.328550.0" PMIX_RANK="15" PMIX_SERVER_URI3="pmix-server.1574131;tcp4://127.0.0.1:42971" PMIX_SERVER_URI2="pmix-server.1574131;tcp4://127.0.0.1:42971" PMIX_SERVER_URI21="pmix-server.1574131;tcp4://127.0.0.1:42971" PMIX_SECURITY_MODE="munge,native" PMIX_PTL_MODULE="tcp,usock" PMIX_BFROP_BUFFER_TYPE="PMIX_BFROP_BUFFER_NON_DESC" PMIX_GDS_MODULE="ds21,ds12,hash" PMIX_SERVER_TMPDIR="/var/spool/slurm/d/pmix.328550.0/" PMIX_SYSTEM_TMPDIR="/tmp" PMIX_DSTORE_21_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds21_1574131" PMIX_DSTORE_ESH_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds12_1574131" PMIX_HOSTNAME="osk-gpu56" PMIX_VERSION="3.2.3" CUDA_DEVICE_MAX_CONNECTIONS="1" && torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora'

Exit code: 1

Stdout: already printed

Stderr: already printed


10.255.255.101 22" READELF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-readelf" ZE_AFFINITY_MASK="0,1,2,3,4,5,6,7" PYTORCH_CUDA_ALLOC_CONF="expandable_segments:True" GXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-g++" MASTER_ADDR="osk-gpu54" SLURM_TOPOLOGY_ADDR_PATTERN="node" CUDA_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" GCC_AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ar" ADDR2LINE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-addr2line" XDG_SESSION_CLASS="user" SLURM_WORKING_CLUSTER="osk-cluster:10.255.255.100:6817:9728:109" PYTHONPATH="/home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat:/home/Competition2025/P02/P02U006/ColossalAI:" TERM="xterm-256color" TORCH_NCCL_ASYNC_ERROR_HANDLING="0" GCC_NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-nm" SIZE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-size" HOST="x86_64-conda-linux-gnu" LESSOPEN="||/usr/bin/lesspipe.sh %s" CC_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" USER="P02U006" LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" SLURM_NODELIST="osk-gpu[54,56,91]" ENVIRONMENT="BATCH" GPU_DEVICE_ORDINAL="0,1,2,3,4,5,6,7" CONDA_SHLVL="1" MODULES_RUN_QUARANTINE="LD_LIBRARY_PATH LD_PRELOAD" AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar" AS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-as" DEBUG_CPPFLAGS="-D_DEBUG -D_FORTIFY_SOURCE=2 -Og -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_PRIO_PROCESS="0" host_alias="x86_64-conda-linux-gnu" SLURM_NPROCS="24" PYTHONFAULTHANDLER="1" SHLVL="2" SLURM_NNODES="3" NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-nm" GCC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc" PMIX_MCA_gds="^ds12" XDG_SESSION_ID="64665" SLURM_SUBMIT_HOST="osk-cpu01" LD_GOLD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld.gold" CONDA_PYTHON_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/python" LD_LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" XDG_RUNTIME_DIR="/run/user/11034" SLURM_JOB_ID="328550" UCX_MAX_RNDV_RAILS="8" SLURM_NODEID="1" SSH_CLIENT="100.113.255.14 54546 22" CONDA_DEFAULT_ENV="deepseeksft310" __MODULES_LMINIT="module use --append /home/appli/modulefiles:module use --append /usr/share/Modules/modulefiles:module use --append /etc/modulefiles:module use --append /usr/share/modulefiles" OBJCOPY="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objcopy" OMPI_MCA_coll_hcoll_enable="0" which_declare="declare -f" STRIP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip" CUDA_HOME="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" NVCC_PREPEND_FLAGS_BACKUP=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" XDG_DATA_DIRS="/home/Competition2025/P02/P02U006/.local/share/flatpak/exports/share:/var/lib/flatpak/exports/share:/usr/local/share:/usr/share" OBJDUMP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objdump" SLURM_CONF="/etc/slurm/slurm.conf" PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/condabin:/home/Competition2025/P02/P02U006/.local/bin:/home/Competition2025/P02/P02U006/bin:/usr/share/Modules/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin" SLURM_JOB_NAME="lora-r1" MODULEPATH="/etc/scl/modulefiles:/home/appli/modulefiles:/usr/share/Modules/modulefiles:/etc/modulefiles:/usr/share/modulefiles" CC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" SLURM_NTASKS_PER_NODE="8" CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" CXXFILT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++filt" DBUS_SESSION_BUS_ADDRESS="unix:path=/run/user/11034/bus" BUILD="x86_64-conda-linux-gnu" MAIL="/var/spool/mail/P02U006" SSH_TTY="/dev/pts/47" SLURM_JOB_GID="11034" CPATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib/python3.10/site-packages/nvidia/cublas/include:" RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib" CONDA_BUILD_SYSROOT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot" UCX_MAX_EAGER_RAILS="8" OLDPWD="/home/Competition2025/P02/P02U006" SLURM_JOB_NODELIST="osk-gpu[54,56,91]" MODULES_CMD="/usr/share/Modules/libexec/modulecmd.tcl" TORCH_ELASTIC_STORE_TIMEOUT="3600" _="/usr/bin/srun" SLURM_MPI_TYPE="pmix_v3" SRUN_DEBUG="3" SLURM_UMASK="0022" SLURM_JOB_CPUS_PER_NODE_PACK_GROUP_0="8(x3)" SLURM_DISTRIBUTION="block" SLURM_STEP_ID="0" SLURM_STEPID="0" SLURM_STEP_NODELIST="osk-gpu[54,56,91]" SLURM_STEP_NUM_NODES="3" SLURM_STEP_NUM_TASKS="24" SLURM_STEP_TASKS_PER_NODE="8(x3)" SLURM_STEP_LAUNCHER_PORT="32819" SLURM_SRUN_COMM_PORT="32819" SLURM_PMIXP_ABORT_AGENT_PORT="34205" SLURM_PMIX_MAPPING_SERV="(vector,(0,3,8))" SLURM_SRUN_COMM_HOST="192.168.11.54" SLURM_STEP_GPUS="0,1,2,3,4,5,6,7" SLURM_CPU_BIND="quiet,none" SLURM_CPU_BIND_TYPE="none" SLURM_CPU_BIND_VERBOSE="quiet" SLURM_LAUNCH_NODE_IPADDR="192.168.11.54" PMIX_NAMESPACE="slurm.pmix.328550.0" PMIX_RANK="10" PMIX_SERVER_URI3="pmix-server.1574131;tcp4://127.0.0.1:42971" PMIX_SERVER_URI2="pmix-server.1574131;tcp4://127.0.0.1:42971" PMIX_SERVER_URI21="pmix-server.1574131;tcp4://127.0.0.1:42971" PMIX_SECURITY_MODE="munge,native" PMIX_PTL_MODULE="tcp,usock" PMIX_BFROP_BUFFER_TYPE="PMIX_BFROP_BUFFER_NON_DESC" PMIX_GDS_MODULE="ds21,ds12,hash" PMIX_SERVER_TMPDIR="/var/spool/slurm/d/pmix.328550.0/" PMIX_SYSTEM_TMPDIR="/tmp" PMIX_DSTORE_21_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds21_1574131" PMIX_DSTORE_ESH_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds12_1574131" PMIX_HOSTNAME="osk-gpu56" PMIX_VERSION="3.2.3" CUDA_DEVICE_MAX_CONNECTIONS="1" && torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora'

Exit code: 1

Stdout: already printed

Stderr: already printed



====== Training on All Nodes =====
127.0.0.1: failure

====== Stopping All Nodes =====
127.0.0.1: finish

====== Training on All Nodes =====

====== Stopping All Nodes =====
127.0.0.1: finish
127.0.0.1: failure

====== Stopping All Nodes =====
127.0.0.1: finish
Error: failed to run torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora on 127.0.0.1, is localhost: True, exception: Encountered a bad command exit code!

Command: 'cd /home/Competition2025/P02/P02U006/ColossalAI && export SHELL="/bin/bash" SLURM_GPUS_PER_NODE="8" GCC_RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ranlib" SLURM_JOB_USER="P02U006" SLURM_TASKS_PER_NODE="8(x3)" SLURM_JOB_UID="11034" HISTCONTROL="ignoredups" SLURM_TASK_PID="1574145" CONDA_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/conda" SLURM_JOB_GPUS="0,1,2,3,4,5,6,7" SLURM_LOCALID="4" build_alias="x86_64-conda-linux-gnu" SLURM_SUBMIT_DIR="/home/Competition2025/P02/P02U006/ColossalAI" CMAKE_ARGS="-DCMAKE_AR=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar -DCMAKE_RANLIB=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib -DCMAKE_LINKER=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld -DCMAKE_STRIP=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip -DCMAKE_BUILD_TYPE=Release" HOSTNAME="osk-gpu54" HISTSIZE="1000" SLURMD_NODENAME="osk-gpu56" FLASH_ATTENTION_DISABLE="1" MASTER_PORT="13700" GPROF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gprof" _CONDA_PYTHON_SYSCONFIGDATA_NAME="_sysconfigdata_x86_64_conda_cos7_linux_gnu" STRINGS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strings" CPP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cpp" NCCL_NET_PLUGIN="none" SLURM_NODE_ALIASES="(null)" SLURM_CLUSTER_NAME="osk-cluster" SLURM_CPUS_ON_NODE="8" SLURM_JOB_CPUS_PER_NODE="8(x3)" NCCL_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" SLURM_GPUS_ON_NODE="8" PWD="/home/Competition2025/P02/P02U006/ColossalAI" SLURM_GTIDS="8,9,10,11,12,13,14,15" GSETTINGS_SCHEMA_DIR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/share/glib-2.0/schemas" LOGNAME="P02U006" UCX_NET_DEVICES="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" XDG_SESSION_TYPE="tty" CONDA_PREFIX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" SLURM_JOB_PARTITION="P02" MODULESHOME="/usr/share/Modules" MANPATH="/usr/share/man:" ROCR_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" NCCL_DEBUG="INFO" SLURM_JOB_NUM_NODES="3" CXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" NCCL_TIMEOUT="3600" SLURM_JOBID="328550" GLOO_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" NCCL_IB_HCA="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" DEBUG_CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_JOB_QOS="normal" MOTD_SHOWN="pam" TORCH_NCCL_BLOCKING_WAIT="1" LDFLAGS="-Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,-rpath,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -Wl,-rpath-link,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib  -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib/stubs" __MODULES_SHARE_MANPATH=":1" HOME="/home/Competition2025/P02/P02U006" LANG="en_US.UTF-8" DEBUG_CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" LS_COLORS="rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=01;37;41:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.webp=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=01;36:*.au=01;36:*.flac=01;36:*.m4a=01;36:*.mid=01;36:*.midi=01;36:*.mka=01;36:*.mp3=01;36:*.mpc=01;36:*.ogg=01;36:*.ra=01;36:*.wav=01;36:*.oga=01;36:*.opus=01;36:*.spx=01;36:*.xspf=01;36:" NVCC_PREPEND_FLAGS=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++ -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" SLURM_PROCID="12" CXX_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" HF_TRANSFORMERS_CACHE_DISABLE_FLASH_ATTN_2="1" ELFEDIT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-elfedit" CONDA_PROMPT_MODIFIER="(deepseeksft310) " TMPDIR="/tmp" CMAKE_PREFIX_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot/usr" CUDACXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/nvcc" CPPFLAGS="-DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" SLURM_NTASKS="24" LD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld" SLURM_TOPOLOGY_ADDR="osk-gpu56" SSH_CONNECTION="100.113.255.14 54546 10.255.255.101 22" READELF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-readelf" ZE_AFFINITY_MASK="0,1,2,3,4,5,6,7" PYTORCH_CUDA_ALLOC_CONF="expandable_segments:True" GXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-g++" MASTER_ADDR="osk-gpu54" SLURM_TOPOLOGY_ADDR_PATTERN="node" CUDA_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" GCC_AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ar" ADDR2LINE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-addr2line" XDG_SESSION_CLASS="user" SLURM_WORKING_CLUSTER="osk-cluster:10.255.255.100:6817:9728:109" PYTHONPATH="/home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat:/home/Competition2025/P02/P02U006/ColossalAI:" TERM="xterm-256color" TORCH_NCCL_ASYNC_ERROR_HANDLING="0" GCC_NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-nm" SIZE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-size" HOST="x86_64-conda-linux-gnu" LESSOPEN="||/usr/bin/lesspipe.sh %s" CC_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" USER="P02U006" LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" SLURM_NODELIST="osk-gpu[54,56,91]" ENVIRONMENT="BATCH" GPU_DEVICE_ORDINAL="0,1,2,3,4,5,6,7" CONDA_SHLVL="1" MODULES_RUN_QUARANTINE="LD_LIBRARY_PATH LD_PRELOAD" AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar" AS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-as" DEBUG_CPPFLAGS="-D_DEBUG -D_FORTIFY_SOURCE=2 -Og -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_PRIO_PROCESS="0" host_alias="x86_64-conda-linux-gnu" SLURM_NPROCS="24" PYTHONFAULTHANDLER="1" SHLVL="2" SLURM_NNODES="3" NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-nm" GCC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc" PMIX_MCA_gds="^ds12" XDG_SESSION_ID="64665" SLURM_SUBMIT_HOST="osk-cpu01" LD_GOLD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld.gold" CONDA_PYTHON_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/python" LD_LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" XDG_RUNTIME_DIR="/run/user/11034" SLURM_JOB_ID="328550" UCX_MAX_RNDV_RAILS="8" SLURM_NODEID="1" SSH_CLIENT="100.113.255.14 54546 22" CONDA_DEFAULT_ENV="deepseeksft310" __MODULES_LMINIT="module use --append /home/appli/modulefiles:module use --append /usr/share/Modules/modulefiles:module use --append /etc/modulefiles:module use --append /usr/share/modulefiles" OBJCOPY="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objcopy" OMPI_MCA_coll_hcoll_enable="0" which_declare="declare -f" STRIP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip" CUDA_HOME="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" NVCC_PREPEND_FLAGS_BACKUP=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" XDG_DATA_DIRS="/home/Competition2025/P02/P02U006/.local/share/flatpak/exports/share:/var/lib/flatpak/exports/share:/usr/local/share:/usr/share" OBJDUMP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objdump" SLURM_CONF="/etc/slurm/slurm.conf" PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/condabin:/home/Competition2025/P02/P02U006/.local/bin:/home/Competition2025/P02/P02U006/bin:/usr/share/Modules/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin" SLURM_JOB_NAME="lora-r1" MODULEPATH="/etc/scl/modulefiles:/home/appli/modulefiles:/usr/share/Modules/modulefiles:/etc/modulefiles:/usr/share/modulefiles" CC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" SLURM_NTASKS_PER_NODE="8" CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" CXXFILT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++filt" DBUS_SESSION_BUS_ADDRESS="unix:path=/run/user/11034/bus" BUILD="x86_64-conda-linux-gnu" MAIL="/var/spool/mail/P02U006" SSH_TTY="/dev/pts/47" SLURM_JOB_GID="11034" CPATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib/python3.10/site-packages/nvidia/cublas/include:" RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib" CONDA_BUILD_SYSROOT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot" UCX_MAX_EAGER_RAILS="8" OLDPWD="/home/Competition2025/P02/P02U006" SLURM_JOB_NODELIST="osk-gpu[54,56,91]" MODULES_CMD="/usr/share/Modules/libexec/modulecmd.tcl" TORCH_ELASTIC_STORE_TIMEOUT="3600" _="/usr/bin/srun" SLURM_MPI_TYPE="pmix_v3" SRUN_DEBUG="3" SLURM_UMASK="0022" SLURM_JOB_CPUS_PER_NODE_PACK_GROUP_0="8(x3)" SLURM_DISTRIBUTION="block" SLURM_STEP_ID="0" SLURM_STEPID="0" SLURM_STEP_NODELIST="osk-gpu[54,56,91]" SLURM_STEP_NUM_NODES="3" SLURM_STEP_NUM_TASKS="24" SLURM_STEP_TASKS_PER_NODE="8(x3)" SLURM_STEP_LAUNCHER_PORT="32819" SLURM_SRUN_COMM_PORT="32819" SLURM_PMIXP_ABORT_AGENT_PORT="34205" SLURM_PMIX_MAPPING_SERV="(vector,(0,3,8))" SLURM_SRUN_COMM_HOST="192.168.11.54" SLURM_STEP_GPUS="0,1,2,3,4,5,6,7" SLURM_CPU_BIND="quiet,none" SLURM_CPU_BIND_TYPE="none" SLURM_CPU_BIND_VERBOSE="quiet" SLURM_LAUNCH_NODE_IPADDR="192.168.11.54" PMIX_NAMESPACE="slurm.pmix.328550.0" PMIX_RANK="12" PMIX_SERVER_URI3="pmix-server.1574131;tcp4://127.0.0.1:42971" PMIX_SERVER_URI2="pmix-server.1574131;tcp4://127.0.0.1:42971" PMIX_SERVER_URI21="pmix-server.1574131;tcp4://127.0.0.1:42971" PMIX_SECURITY_MODE="munge,native" PMIX_PTL_MODULE="tcp,usock" PMIX_BFROP_BUFFER_TYPE="PMIX_BFROP_BUFFER_NON_DESC" PMIX_GDS_MODULE="ds21,ds12,hash" PMIX_SERVER_TMPDIR="/var/spool/slurm/d/pmix.328550.0/" PMIX_SYSTEM_TMPDIR="/tmp" PMIX_DSTORE_21_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds21_1574131" PMIX_DSTORE_ESH_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds12_1574131" PMIX_HOSTNAME="osk-gpu56" PMIX_VERSION="3.2.3" CUDA_DEVICE_MAX_CONNECTIONS="1" && torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora'

Exit code: 1

Stdout: already printed

Stderr: already printed



====== Training on All Nodes =====
127.0.0.1: failure
Error: failed to run torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora on 127.0.0.1, is localhost: True, exception: Encountered a bad command exit code!

Command: 'cd /home/Competition2025/P02/P02U006/ColossalAI && export SHELL="/bin/bash" SLURM_GPUS_PER_NODE="8" GCC_RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ranlib" SLURM_JOB_USER="P02U006" SLURM_TASKS_PER_NODE="8(x3)" SLURM_JOB_UID="11034" HISTCONTROL="ignoredups" SLURM_TASK_PID="1574144" CONDA_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/conda" SLURM_JOB_GPUS="0,1,2,3,4,5,6,7" SLURM_LOCALID="3" build_alias="x86_64-conda-linux-gnu" SLURM_SUBMIT_DIR="/home/Competition2025/P02/P02U006/ColossalAI" CMAKE_ARGS="-DCMAKE_AR=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar -DCMAKE_RANLIB=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib -DCMAKE_LINKER=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld -DCMAKE_STRIP=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip -DCMAKE_BUILD_TYPE=Release" HOSTNAME="osk-gpu54" HISTSIZE="1000" SLURMD_NODENAME="osk-gpu56" FLASH_ATTENTION_DISABLE="1" MASTER_PORT="13700" GPROF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gprof" _CONDA_PYTHON_SYSCONFIGDATA_NAME="_sysconfigdata_x86_64_conda_cos7_linux_gnu" STRINGS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strings" CPP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cpp" NCCL_NET_PLUGIN="none" SLURM_NODE_ALIASES="(null)" SLURM_CLUSTER_NAME="osk-cluster" SLURM_CPUS_ON_NODE="8" SLURM_JOB_CPUS_PER_NODE="8(x3)" NCCL_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" SLURM_GPUS_ON_NODE="8" PWD="/home/Competition2025/P02/P02U006/ColossalAI" SLURM_GTIDS="8,9,10,11,12,13,14,15" GSETTINGS_SCHEMA_DIR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/share/glib-2.0/schemas" LOGNAME="P02U006" UCX_NET_DEVICES="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" XDG_SESSION_TYPE="tty" CONDA_PREFIX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" SLURM_JOB_PARTITION="P02" MODULESHOME="/usr/share/Modules" MANPATH="/usr/share/man:" ROCR_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" NCCL_DEBUG="INFO" SLURM_JOB_NUM_NODES="3" CXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" NCCL_TIMEOUT="3600" SLURM_JOBID="328550" GLOO_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" NCCL_IB_HCA="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" DEBUG_CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_JOB_QOS="normal" MOTD_SHOWN="pam" TORCH_NCCL_BLOCKING_WAIT="1" LDFLAGS="-Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,-rpath,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -Wl,-rpath-link,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib  -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib/stubs" __MODULES_SHARE_MANPATH=":1" HOME="/home/Competition2025/P02/P02U006" LANG="en_US.UTF-8" DEBUG_CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" LS_COLORS="rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=01;37;41:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.webp=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=01;36:*.au=01;36:*.flac=01;36:*.m4a=01;36:*.mid=01;36:*.midi=01;36:*.mka=01;36:*.mp3=01;36:*.mpc=01;36:*.ogg=01;36:*.ra=01;36:*.wav=01;36:*.oga=01;36:*.opus=01;36:*.spx=01;36:*.xspf=01;36:" NVCC_PREPEND_FLAGS=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++ -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" SLURM_PROCID="11" CXX_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" HF_TRANSFORMERS_CACHE_DISABLE_FLASH_ATTN_2="1" ELFEDIT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-elfedit" CONDA_PROMPT_MODIFIER="(deepseeksft310) " TMPDIR="/tmp" CMAKE_PREFIX_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot/usr" CUDACXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/nvcc" CPPFLAGS="-DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" SLURM_NTASKS="24" LD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld" SLURM_TOPOLOGY_ADDR="osk-gpu56" SSH_CONNECTION="100.113.255.14 54546 10.255.255.101 22" READELF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-readelf" ZE_AFFINITY_MASK="0,1,2,3,4,5,6,7" PYTORCH_CUDA_ALLOC_CONF="expandable_segments:True" GXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-g++" MASTER_ADDR="osk-gpu54" SLURM_TOPOLOGY_ADDR_PATTERN="node" CUDA_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" GCC_AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ar" ADDR2LINE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-addr2line" XDG_SESSION_CLASS="user" SLURM_WORKING_CLUSTER="osk-cluster:10.255.255.100:6817:9728:109" PYTHONPATH="/home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat:/home/Competition2025/P02/P02U006/ColossalAI:" TERM="xterm-256color" TORCH_NCCL_ASYNC_ERROR_HANDLING="0" GCC_NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-nm" SIZE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-size" HOST="x86_64-conda-linux-gnu" LESSOPEN="||/usr/bin/lesspipe.sh %s" CC_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" USER="P02U006" LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" SLURM_NODELIST="osk-gpu[54,56,91]" ENVIRONMENT="BATCH" GPU_DEVICE_ORDINAL="0,1,2,3,4,5,6,7" CONDA_SHLVL="1" MODULES_RUN_QUARANTINE="LD_LIBRARY_PATH LD_PRELOAD" AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar" AS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-as" DEBUG_CPPFLAGS="-D_DEBUG -D_FORTIFY_SOURCE=2 -Og -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_PRIO_PROCESS="0" host_alias="x86_64-conda-linux-gnu" SLURM_NPROCS="24" PYTHONFAULTHANDLER="1" SHLVL="2" SLURM_NNODES="3" NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-nm" GCC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc" PMIX_MCA_gds="^ds12" XDG_SESSION_ID="64665" SLURM_SUBMIT_HOST="osk-cpu01" LD_GOLD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld.gold" CONDA_PYTHON_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/python" LD_LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" XDG_RUNTIME_DIR="/run/user/11034" SLURM_JOB_ID="328550" UCX_MAX_RNDV_RAILS="8" SLURM_NODEID="1" SSH_CLIENT="100.113.255.14 54546 22" CONDA_DEFAULT_ENV="deepseeksft310" __MODULES_LMINIT="module use --append /home/appli/modulefiles:module use --append /usr/share/Modules/modulefiles:module use --append /etc/modulefiles:module use --append /usr/share/modulefiles" OBJCOPY="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objcopy" OMPI_MCA_coll_hcoll_enable="0" which_declare="declare -f" STRIP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip" CUDA_HOME="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" NVCC_PREPEND_FLAGS_BACKUP=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" XDG_DATA_DIRS="/home/Competition2025/P02/P02U006/.local/share/flatpak/exports/share:/var/lib/flatpak/exports/share:/usr/local/share:/usr/share" OBJDUMP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objdump" SLURM_CONF="/etc/slurm/slurm.conf" PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/condabin:/home/Competition2025/P02/P02U006/.local/bin:/home/Competition2025/P02/P02U006/bin:/usr/share/Modules/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin" SLURM_JOB_NAME="lora-r1" MODULEPATH="/etc/scl/modulefiles:/home/appli/modulefiles:/usr/share/Modules/modulefiles:/etc/modulefiles:/usr/share/modulefiles" CC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" SLURM_NTASKS_PER_NODE="8" CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" CXXFILT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++filt" DBUS_SESSION_BUS_ADDRESS="unix:path=/run/user/11034/bus" BUILD="x86_64-conda-linux-gnu" MAIL="/var/spool/mail/P02U006" SSH_TTY="/dev/pts/47" SLURM_JOB_GID="11034" CPATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib/python3.10/site-packages/nvidia/cublas/include:" RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib" CONDA_BUILD_SYSROOT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot" UCX_MAX_EAGER_RAILS="8" OLDPWD="/home/Competition2025/P02/P02U006" SLURM_JOB_NODELIST="osk-gpu[54,56,91]" MODULES_CMD="/usr/share/Modules/libexec/modulecmd.tcl" TORCH_ELASTIC_STORE_TIMEOUT="3600" _="/usr/bin/srun" SLURM_MPI_TYPE="pmix_v3" SRUN_DEBUG="3" SLURM_UMASK="0022" SLURM_JOB_CPUS_PER_NODE_PACK_GROUP_0="8(x3)" SLURM_DISTRIBUTION="block" SLURM_STEP_ID="0" SLURM_STEPID="0" SLURM_STEP_NODELIST="osk-gpu[54,56,91]" SLURM_STEP_NUM_NODES="3" SLURM_STEP_NUM_TASKS="24" SLURM_STEP_TASKS_PER_NODE="8(x3)" SLURM_STEP_LAUNCHER_PORT="32819" SLURM_SRUN_COMM_PORT="32819" SLURM_PMIXP_ABORT_AGENT_PORT="34205" SLURM_PMIX_MAPPING_SERV="(vector,(0,3,8))" SLURM_SRUN_COMM_HOST="192.168.11.54" SLURM_STEP_GPUS="0,1,2,3,4,5,6,7" SLURM_CPU_BIND="quiet,none" SLURM_CPU_BIND_TYPE="none" SLURM_CPU_BIND_VERBOSE="quiet" SLURM_LAUNCH_NODE_IPADDR="192.168.11.54" PMIX_NAMESPACE="slurm.pmix.328550.0" PMIX_RANK="11" PMIX_SERVER_URI3="pmix-server.1574131;tcp4://127.0.0.1:42971" PMIX_SERVER_URI2="pmix-server.1574131;tcp4://127.0.0.1:42971" PMIX_SERVER_URI21="pmix-server.1574131;tcp4://127.0.0.1:42971" PMIX_SECURITY_MODE="munge,native" PMIX_PTL_MODULE="tcp,usock" PMIX_BFROP_BUFFER_TYPE="PMIX_BFROP_BUFFER_NON_DESC" PMIX_GDS_MODULE="ds21,ds12,hash" PMIX_SERVER_TMPDIR="/var/spool/slurm/d/pmix.328550.0/" PMIX_SYSTEM_TMPDIR="/tmp" PMIX_DSTORE_21_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds21_1574131" PMIX_DSTORE_ESH_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds12_1574131" PMIX_HOSTNAME="osk-gpu56" PMIX_VERSION="3.2.3" CUDA_DEVICE_MAX_CONNECTIONS="1" && torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora'

Exit code: 1

Stdout: already printed

Stderr: already printed



====== Stopping All Nodes =====

====== Training on All Nodes =====
127.0.0.1: failure

====== Stopping All Nodes =====
127.0.0.1: finish
127.0.0.1: finish
please install Colossal-AI from https://www.colossalai.org/download or from source
please install Colossal-AI from https://www.colossalai.org/download or from source
==== ColossalAI SFT script: train() Start ====
[08/06/25 12:01:52] INFO     colossalai - colossalai - INFO:                    
                             /home/Competition2025/P02/P02U006/ColossalAI/coloss
                             alai/initialize.py:75 launch                       
                    INFO     colossalai - colossalai - INFO: Distributed        
                             environment is initialized, world size: 1          
Error: failed to run torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora on 127.0.0.1, is localhost: True, exception: Encountered a bad command exit code!

Command: 'cd /home/Competition2025/P02/P02U006/ColossalAI && export SHELL="/bin/bash" SLURM_GPUS_PER_NODE="8" GCC_RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ranlib" SLURM_JOB_USER="P02U006" SLURM_TASKS_PER_NODE="8(x3)" SLURM_JOB_UID="11034" HISTCONTROL="ignoredups" SLURM_TASK_PID="2009344" CONDA_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/conda" SLURM_JOB_GPUS="0,1,2,3,4,5,6,7" SLURM_LOCALID="2" build_alias="x86_64-conda-linux-gnu" SLURM_SUBMIT_DIR="/home/Competition2025/P02/P02U006/ColossalAI" CMAKE_ARGS="-DCMAKE_AR=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar -DCMAKE_RANLIB=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib -DCMAKE_LINKER=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld -DCMAKE_STRIP=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip -DCMAKE_BUILD_TYPE=Release" HOSTNAME="osk-gpu54" HISTSIZE="1000" SLURMD_NODENAME="osk-gpu54" FLASH_ATTENTION_DISABLE="1" MASTER_PORT="13700" GPROF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gprof" _CONDA_PYTHON_SYSCONFIGDATA_NAME="_sysconfigdata_x86_64_conda_cos7_linux_gnu" STRINGS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strings" CPP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cpp" NCCL_NET_PLUGIN="none" SLURM_NODE_ALIASES="(null)" SLURM_CLUSTER_NAME="osk-cluster" SLURM_CPUS_ON_NODE="8" SLURM_JOB_CPUS_PER_NODE="8(x3)" NCCL_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" SLURM_GPUS_ON_NODE="8" PWD="/home/Competition2025/P02/P02U006/ColossalAI" SLURM_GTIDS="0,1,2,3,4,5,6,7" GSETTINGS_SCHEMA_DIR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/share/glib-2.0/schemas" LOGNAME="P02U006" UCX_NET_DEVICES="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" XDG_SESSION_TYPE="tty" CONDA_PREFIX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" SLURM_JOB_PARTITION="P02" MODULESHOME="/usr/share/Modules" MANPATH="/usr/share/man:" ROCR_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" NCCL_DEBUG="INFO" SLURM_JOB_NUM_NODES="3" CXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" NCCL_TIMEOUT="3600" SLURM_JOBID="328550" GLOO_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" NCCL_IB_HCA="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" DEBUG_CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_JOB_QOS="normal" MOTD_SHOWN="pam" TORCH_NCCL_BLOCKING_WAIT="1" LDFLAGS="-Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,-rpath,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -Wl,-rpath-link,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib  -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib/stubs" __MODULES_SHARE_MANPATH=":1" HOME="/home/Competition2025/P02/P02U006" LANG="en_US.UTF-8" DEBUG_CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" LS_COLORS="rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=01;37;41:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.webp=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=01;36:*.au=01;36:*.flac=01;36:*.m4a=01;36:*.mid=01;36:*.midi=01;36:*.mka=01;36:*.mp3=01;36:*.mpc=01;36:*.ogg=01;36:*.ra=01;36:*.wav=01;36:*.oga=01;36:*.opus=01;36:*.spx=01;36:*.xspf=01;36:" NVCC_PREPEND_FLAGS=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++ -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" SLURM_PROCID="2" CXX_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" HF_TRANSFORMERS_CACHE_DISABLE_FLASH_ATTN_2="1" ELFEDIT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-elfedit" CONDA_PROMPT_MODIFIER="(deepseeksft310) " TMPDIR="/tmp" CMAKE_PREFIX_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot/usr" CUDACXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/nvcc" CPPFLAGS="-DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" SLURM_NTASKS="24" LD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld" SLURM_TOPOLOGY_ADDR="osk-gpu54" SSH_CONNECTION="100.113.255.14 54546 10.255.255.101 22" READELF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-readelf" ZE_AFFINITY_MASK="0,1,2,3,4,5,6,7" PYTORCH_CUDA_ALLOC_CONF="expandable_segments:True" GXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-g++" MASTER_ADDR="osk-gpu54" SLURM_TOPOLOGY_ADDR_PATTERN="node" CUDA_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" GCC_AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ar" ADDR2LINE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-addr2line" XDG_SESSION_CLASS="user" SLURM_WORKING_CLUSTER="osk-cluster:10.255.255.100:6817:9728:109" PYTHONPATH="/home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat:/home/Competition2025/P02/P02U006/ColossalAI:" TERM="xterm-256color" TORCH_NCCL_ASYNC_ERROR_HANDLING="0" GCC_NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-nm" SIZE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-size" HOST="x86_64-conda-linux-gnu" LESSOPEN="||/usr/bin/lesspipe.sh %s" CC_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" USER="P02U006" LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" SLURM_NODELIST="osk-gpu[54,56,91]" ENVIRONMENT="BATCH" GPU_DEVICE_ORDINAL="0,1,2,3,4,5,6,7" CONDA_SHLVL="1" MODULES_RUN_QUARANTINE="LD_LIBRARY_PATH LD_PRELOAD" AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar" AS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-as" DEBUG_CPPFLAGS="-D_DEBUG -D_FORTIFY_SOURCE=2 -Og -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_PRIO_PROCESS="0" host_alias="x86_64-conda-linux-gnu" SLURM_NPROCS="24" PYTHONFAULTHANDLER="1" SHLVL="2" SLURM_NNODES="3" NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-nm" GCC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc" PMIX_MCA_gds="^ds12" XDG_SESSION_ID="64665" SLURM_SUBMIT_HOST="osk-cpu01" LD_GOLD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld.gold" CONDA_PYTHON_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/python" LD_LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" XDG_RUNTIME_DIR="/run/user/11034" SLURM_JOB_ID="328550" UCX_MAX_RNDV_RAILS="8" SLURM_NODEID="0" SSH_CLIENT="100.113.255.14 54546 22" CONDA_DEFAULT_ENV="deepseeksft310" __MODULES_LMINIT="module use --append /home/appli/modulefiles:module use --append /usr/share/Modules/modulefiles:module use --append /etc/modulefiles:module use --append /usr/share/modulefiles" OBJCOPY="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objcopy" OMPI_MCA_coll_hcoll_enable="0" which_declare="declare -f" STRIP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip" CUDA_HOME="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" NVCC_PREPEND_FLAGS_BACKUP=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" XDG_DATA_DIRS="/home/Competition2025/P02/P02U006/.local/share/flatpak/exports/share:/var/lib/flatpak/exports/share:/usr/local/share:/usr/share" OBJDUMP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objdump" SLURM_CONF="/etc/slurm/slurm.conf" PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/condabin:/home/Competition2025/P02/P02U006/.local/bin:/home/Competition2025/P02/P02U006/bin:/usr/share/Modules/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin" SLURM_JOB_NAME="lora-r1" MODULEPATH="/etc/scl/modulefiles:/home/appli/modulefiles:/usr/share/Modules/modulefiles:/etc/modulefiles:/usr/share/modulefiles" CC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" SLURM_NTASKS_PER_NODE="8" CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" CXXFILT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++filt" DBUS_SESSION_BUS_ADDRESS="unix:path=/run/user/11034/bus" BUILD="x86_64-conda-linux-gnu" MAIL="/var/spool/mail/P02U006" SSH_TTY="/dev/pts/47" SLURM_JOB_GID="11034" CPATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib/python3.10/site-packages/nvidia/cublas/include:" RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib" CONDA_BUILD_SYSROOT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot" UCX_MAX_EAGER_RAILS="8" OLDPWD="/home/Competition2025/P02/P02U006" SLURM_JOB_NODELIST="osk-gpu[54,56,91]" MODULES_CMD="/usr/share/Modules/libexec/modulecmd.tcl" TORCH_ELASTIC_STORE_TIMEOUT="3600" _="/usr/bin/srun" SLURM_MPI_TYPE="pmix_v3" SRUN_DEBUG="3" SLURM_UMASK="0022" SLURM_JOB_CPUS_PER_NODE_PACK_GROUP_0="8(x3)" SLURM_DISTRIBUTION="block" SLURM_STEP_ID="0" SLURM_STEPID="0" SLURM_STEP_NODELIST="osk-gpu[54,56,91]" SLURM_STEP_NUM_NODES="3" SLURM_STEP_NUM_TASKS="24" SLURM_STEP_TASKS_PER_NODE="8(x3)" SLURM_STEP_LAUNCHER_PORT="32819" SLURM_SRUN_COMM_PORT="32819" SLURM_PMIXP_ABORT_AGENT_PORT="34205" SLURM_PMIX_MAPPING_SERV="(vector,(0,3,8))" SLURM_SRUN_COMM_HOST="192.168.11.54" SLURM_STEP_GPUS="0,1,2,3,4,5,6,7" SLURM_CPU_BIND="quiet,none" SLURM_CPU_BIND_TYPE="none" SLURM_CPU_BIND_VERBOSE="quiet" SLURM_LAUNCH_NODE_IPADDR="192.168.11.54" PMIX_NAMESPACE="slurm.pmix.328550.0" PMIX_RANK="2" PMIX_SERVER_URI3="pmix-server.2009332;tcp4://127.0.0.1:45561" PMIX_SERVER_URI2="pmix-server.2009332;tcp4://127.0.0.1:45561" PMIX_SERVER_URI21="pmix-server.2009332;tcp4://127.0.0.1:45561" PMIX_SECURITY_MODE="munge,native" PMIX_PTL_MODULE="tcp,usock" PMIX_BFROP_BUFFER_TYPE="PMIX_BFROP_BUFFER_NON_DESC" PMIX_GDS_MODULE="ds21,ds12,hash" PMIX_SERVER_TMPDIR="/var/spool/slurm/d/pmix.328550.0/" PMIX_SYSTEM_TMPDIR="/tmp" PMIX_DSTORE_21_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds21_2009332" PMIX_DSTORE_ESH_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds12_2009332" PMIX_HOSTNAME="osk-gpu54" PMIX_VERSION="3.2.3" CUDA_DEVICE_MAX_CONNECTIONS="1" && torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora'

Exit code: 1

Stdout: already printed

Stderr: already printed



====== Training on All Nodes =====
127.0.0.1: failure

====== Stopping All Nodes =====
127.0.0.1: finish
==== ColossalAI SFT script: train() Start ====
[08/06/25 12:01:59] INFO     colossalai - colossalai - INFO:                    
                             /home/Competition2025/P02/P02U006/ColossalAI/coloss
                             alai/initialize.py:75 launch                       
                    INFO     colossalai - colossalai - INFO: Distributed        
                             environment is initialized, world size: 1          
==== ColossalAI SFT script: train() Start ====
[08/06/25 12:02:00] INFO     colossalai - colossalai - INFO:                    
                             /home/Competition2025/P02/P02U006/ColossalAI/coloss
                             alai/initialize.py:75 launch                       
                    INFO     colossalai - colossalai - INFO: Distributed        
                             environment is initialized, world size: 1          
Error: failed to run torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora on 127.0.0.1, is localhost: True, exception: Encountered a bad command exit code!

Command: 'cd /home/Competition2025/P02/P02U006/ColossalAI && export SHELL="/bin/bash" SLURM_GPUS_PER_NODE="8" GCC_RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ranlib" SLURM_JOB_USER="P02U006" SLURM_TASKS_PER_NODE="8(x3)" SLURM_JOB_UID="11034" HISTCONTROL="ignoredups" SLURM_TASK_PID="3124479" CONDA_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/conda" SLURM_JOB_GPUS="0,1,2,3,4,5,6,7" SLURM_LOCALID="7" build_alias="x86_64-conda-linux-gnu" SLURM_SUBMIT_DIR="/home/Competition2025/P02/P02U006/ColossalAI" CMAKE_ARGS="-DCMAKE_AR=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar -DCMAKE_RANLIB=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib -DCMAKE_LINKER=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld -DCMAKE_STRIP=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip -DCMAKE_BUILD_TYPE=Release" HOSTNAME="osk-gpu54" HISTSIZE="1000" SLURMD_NODENAME="osk-gpu91" FLASH_ATTENTION_DISABLE="1" MASTER_PORT="13700" GPROF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gprof" _CONDA_PYTHON_SYSCONFIGDATA_NAME="_sysconfigdata_x86_64_conda_cos7_linux_gnu" STRINGS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strings" CPP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cpp" NCCL_NET_PLUGIN="none" SLURM_NODE_ALIASES="(null)" SLURM_CLUSTER_NAME="osk-cluster" SLURM_CPUS_ON_NODE="8" SLURM_JOB_CPUS_PER_NODE="8(x3)" NCCL_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" SLURM_GPUS_ON_NODE="8" PWD="/home/Competition2025/P02/P02U006/ColossalAI" SLURM_GTIDS="16,17,18,19,20,21,22,23" GSETTINGS_SCHEMA_DIR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/share/glib-2.0/schemas" LOGNAME="P02U006" UCX_NET_DEVICES="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" XDG_SESSION_TYPE="tty" CONDA_PREFIX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" SLURM_JOB_PARTITION="P02" MODULESHOME="/usr/share/Modules" MANPATH="/usr/share/man:" ROCR_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" NCCL_DEBUG="INFO" SLURM_JOB_NUM_NODES="3" CXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" NCCL_TIMEOUT="3600" SLURM_JOBID="328550" GLOO_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" NCCL_IB_HCA="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" DEBUG_CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_JOB_QOS="normal" MOTD_SHOWN="pam" TORCH_NCCL_BLOCKING_WAIT="1" LDFLAGS="-Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,-rpath,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -Wl,-rpath-link,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib  -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib/stubs" __MODULES_SHARE_MANPATH=":1" HOME="/home/Competition2025/P02/P02U006" LANG="en_US.UTF-8" DEBUG_CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" LS_COLORS="rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=01;37;41:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.webp=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=01;36:*.au=01;36:*.flac=01;36:*.m4a=01;36:*.mid=01;36:*.midi=01;36:*.mka=01;36:*.mp3=01;36:*.mpc=01;36:*.ogg=01;36:*.ra=01;36:*.wav=01;36:*.oga=01;36:*.opus=01;36:*.spx=01;36:*.xspf=01;36:" NVCC_PREPEND_FLAGS=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++ -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" SLURM_PROCID="23" CXX_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" HF_TRANSFORMERS_CACHE_DISABLE_FLASH_ATTN_2="1" ELFEDIT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-elfedit" CONDA_PROMPT_MODIFIER="(deepseeksft310) " TMPDIR="/tmp" CMAKE_PREFIX_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot/usr" CUDACXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/nvcc" CPPFLAGS="-DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" SLURM_NTASKS="24" LD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld" SLURM_TOPOLOGY_ADDR="osk-gpu91" SSH_CONNECTION="100.113.255.14 54546 10.255.255.101 22" READELF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-readelf" ZE_AFFINITY_MASK="0,1,2,3,4,5,6,7" PYTORCH_CUDA_ALLOC_CONF="expandable_segments:True" GXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-g++" MASTER_ADDR="osk-gpu54" SLURM_TOPOLOGY_ADDR_PATTERN="node" CUDA_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" GCC_AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ar" ADDR2LINE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-addr2line" XDG_SESSION_CLASS="user" SLURM_WORKING_CLUSTER="osk-cluster:10.255.255.100:6817:9728:109" PYTHONPATH="/home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat:/home/Competition2025/P02/P02U006/ColossalAI:" TERM="xterm-256color" TORCH_NCCL_ASYNC_ERROR_HANDLING="0" GCC_NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-nm" SIZE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-size" HOST="x86_64-conda-linux-gnu" LESSOPEN="||/usr/bin/lesspipe.sh %s" CC_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" USER="P02U006" LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" SLURM_NODELIST="osk-gpu[54,56,91]" ENVIRONMENT="BATCH" GPU_DEVICE_ORDINAL="0,1,2,3,4,5,6,7" CONDA_SHLVL="1" MODULES_RUN_QUARANTINE="LD_LIBRARY_PATH LD_PRELOAD" AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar" AS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-as" DEBUG_CPPFLAGS="-D_DEBUG -D_FORTIFY_SOURCE=2 -Og -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_PRIO_PROCESS="0" host_alias="x86_64-conda-linux-gnu" SLURM_NPROCS="24" PYTHONFAULTHANDLER="1" SHLVL="2" SLURM_NNODES="3" NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-nm" GCC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc" PMIX_MCA_gds="^ds12" XDG_SESSION_ID="64665" SLURM_SUBMIT_HOST="osk-cpu01" LD_GOLD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld.gold" CONDA_PYTHON_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/python" LD_LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" XDG_RUNTIME_DIR="/run/user/11034" SLURM_JOB_ID="328550" UCX_MAX_RNDV_RAILS="8" SLURM_NODEID="2" SSH_CLIENT="100.113.255.14 54546 22" CONDA_DEFAULT_ENV="deepseeksft310" __MODULES_LMINIT="module use --append /home/appli/modulefiles:module use --append /usr/share/Modules/modulefiles:module use --append /etc/modulefiles:module use --append /usr/share/modulefiles" OBJCOPY="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objcopy" OMPI_MCA_coll_hcoll_enable="0" which_declare="declare -f" STRIP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip" CUDA_HOME="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" NVCC_PREPEND_FLAGS_BACKUP=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" XDG_DATA_DIRS="/home/Competition2025/P02/P02U006/.local/share/flatpak/exports/share:/var/lib/flatpak/exports/share:/usr/local/share:/usr/share" OBJDUMP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objdump" SLURM_CONF="/etc/slurm/slurm.conf" PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/condabin:/home/Competition2025/P02/P02U006/.local/bin:/home/Competition2025/P02/P02U006/bin:/usr/share/Modules/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin" SLURM_JOB_NAME="lora-r1" MODULEPATH="/etc/scl/modulefiles:/home/appli/modulefiles:/usr/share/Modules/modulefiles:/etc/modulefiles:/usr/share/modulefiles" CC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" SLURM_NTASKS_PER_NODE="8" CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" CXXFILT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++filt" DBUS_SESSION_BUS_ADDRESS="unix:path=/run/user/11034/bus" BUILD="x86_64-conda-linux-gnu" MAIL="/var/spool/mail/P02U006" SSH_TTY="/dev/pts/47" SLURM_JOB_GID="11034" CPATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib/python3.10/site-packages/nvidia/cublas/include:" RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib" CONDA_BUILD_SYSROOT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot" UCX_MAX_EAGER_RAILS="8" OLDPWD="/home/Competition2025/P02/P02U006" SLURM_JOB_NODELIST="osk-gpu[54,56,91]" MODULES_CMD="/usr/share/Modules/libexec/modulecmd.tcl" TORCH_ELASTIC_STORE_TIMEOUT="3600" _="/usr/bin/srun" SLURM_MPI_TYPE="pmix_v3" SRUN_DEBUG="3" SLURM_UMASK="0022" SLURM_JOB_CPUS_PER_NODE_PACK_GROUP_0="8(x3)" SLURM_DISTRIBUTION="block" SLURM_STEP_ID="0" SLURM_STEPID="0" SLURM_STEP_NODELIST="osk-gpu[54,56,91]" SLURM_STEP_NUM_NODES="3" SLURM_STEP_NUM_TASKS="24" SLURM_STEP_TASKS_PER_NODE="8(x3)" SLURM_STEP_LAUNCHER_PORT="32819" SLURM_SRUN_COMM_PORT="32819" SLURM_PMIXP_ABORT_AGENT_PORT="34205" SLURM_PMIX_MAPPING_SERV="(vector,(0,3,8))" SLURM_SRUN_COMM_HOST="192.168.11.54" SLURM_STEP_GPUS="0,1,2,3,4,5,6,7" SLURM_CPU_BIND="quiet,none" SLURM_CPU_BIND_TYPE="none" SLURM_CPU_BIND_VERBOSE="quiet" SLURM_LAUNCH_NODE_IPADDR="192.168.11.54" PMIX_NAMESPACE="slurm.pmix.328550.0" PMIX_RANK="23" PMIX_SERVER_URI3="pmix-server.3124463;tcp4://127.0.0.1:41703" PMIX_SERVER_URI2="pmix-server.3124463;tcp4://127.0.0.1:41703" PMIX_SERVER_URI21="pmix-server.3124463;tcp4://127.0.0.1:41703" PMIX_SECURITY_MODE="munge,native" PMIX_PTL_MODULE="tcp,usock" PMIX_BFROP_BUFFER_TYPE="PMIX_BFROP_BUFFER_NON_DESC" PMIX_GDS_MODULE="ds21,ds12,hash" PMIX_SERVER_TMPDIR="/var/spool/slurm/d/pmix.328550.0/" PMIX_SYSTEM_TMPDIR="/tmp" PMIX_DSTORE_21_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds21_3124463" PMIX_DSTORE_ESH_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds12_3124463" PMIX_HOSTNAME="osk-gpu91" PMIX_VERSION="3.2.3" CUDA_DEVICE_MAX_CONNECTIONS="1" && torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora'

Exit code: 1

Stdout: already printed

Stderr: already printed



====== Training on All Nodes =====
127.0.0.1: failure

====== Stopping All Nodes =====
127.0.0.1: finish
Error: failed to run torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora on 127.0.0.1, is localhost: True, exception: Encountered a bad command exit code!

Command: 'cd /home/Competition2025/P02/P02U006/ColossalAI && export SHELL="/bin/bash" SLURM_GPUS_PER_NODE="8" GCC_RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ranlib" SLURM_JOB_USER="P02U006" SLURM_TASKS_PER_NODE="8(x3)" SLURM_JOB_UID="11034" HISTCONTROL="ignoredups" SLURM_TASK_PID="1574141" CONDA_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/conda" SLURM_JOB_GPUS="0,1,2,3,4,5,6,7" SLURM_LOCALID="0" build_alias="x86_64-conda-linux-gnu" SLURM_SUBMIT_DIR="/home/Competition2025/P02/P02U006/ColossalAI" CMAKE_ARGS="-DCMAKE_AR=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar -DCMAKE_RANLIB=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib -DCMAKE_LINKER=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld -DCMAKE_STRIP=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip -DCMAKE_BUILD_TYPE=Release" HOSTNAME="osk-gpu54" HISTSIZE="1000" SLURMD_NODENAME="osk-gpu56" FLASH_ATTENTION_DISABLE="1" MASTER_PORT="13700" GPROF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gprof" _CONDA_PYTHON_SYSCONFIGDATA_NAME="_sysconfigdata_x86_64_conda_cos7_linux_gnu" STRINGS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strings" CPP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cpp" NCCL_NET_PLUGIN="none" SLURM_NODE_ALIASES="(null)" SLURM_CLUSTER_NAME="osk-cluster" SLURM_CPUS_ON_NODE="8" SLURM_JOB_CPUS_PER_NODE="8(x3)" NCCL_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" SLURM_GPUS_ON_NODE="8" PWD="/home/Competition2025/P02/P02U006/ColossalAI" SLURM_GTIDS="8,9,10,11,12,13,14,15" GSETTINGS_SCHEMA_DIR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/share/glib-2.0/schemas" LOGNAME="P02U006" UCX_NET_DEVICES="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" XDG_SESSION_TYPE="tty" CONDA_PREFIX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" SLURM_JOB_PARTITION="P02" MODULESHOME="/usr/share/Modules" MANPATH="/usr/share/man:" ROCR_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" NCCL_DEBUG="INFO" SLURM_JOB_NUM_NODES="3" CXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" NCCL_TIMEOUT="3600" SLURM_JOBID="328550" GLOO_SOCKET_IFNAME="enp25s0np0,enp41s0np0,enp59s0np0,enp92s0np0,enp155s0np0,enp170s0np0,enp187s0np0,enp218s0np0" NCCL_IB_HCA="mlx5_0:1,mlx5_1:1,mlx5_2:1,mlx5_4:1,mlx5_5:1,mlx5_6:1,mlx5_7:1,mlx5_11:1" DEBUG_CXXFLAGS="-fvisibility-inlines-hidden -std=c++17 -fmessage-length=0 -march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_JOB_QOS="normal" MOTD_SHOWN="pam" TORCH_NCCL_BLOCKING_WAIT="1" LDFLAGS="-Wl,-O2 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,--disable-new-dtags -Wl,--gc-sections -Wl,-rpath,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -Wl,-rpath-link,/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib  -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib -L/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib/stubs" __MODULES_SHARE_MANPATH=":1" HOME="/home/Competition2025/P02/P02U006" LANG="en_US.UTF-8" DEBUG_CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-all -fno-plt -Og -g -Wall -Wextra -fvar-tracking-assignments -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" LS_COLORS="rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=01;37;41:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.webp=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=01;36:*.au=01;36:*.flac=01;36:*.m4a=01;36:*.mid=01;36:*.midi=01;36:*.mka=01;36:*.mp3=01;36:*.mpc=01;36:*.ogg=01;36:*.ra=01;36:*.wav=01;36:*.oga=01;36:*.opus=01;36:*.spx=01;36:*.xspf=01;36:" NVCC_PREPEND_FLAGS=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++ -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" SLURM_PROCID="8" CXX_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" HF_TRANSFORMERS_CACHE_DISABLE_FLASH_ATTN_2="1" ELFEDIT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-elfedit" CONDA_PROMPT_MODIFIER="(deepseeksft310) " TMPDIR="/tmp" CMAKE_PREFIX_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot/usr" CUDACXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/nvcc" CPPFLAGS="-DNDEBUG -D_FORTIFY_SOURCE=2 -O2 -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" SLURM_NTASKS="24" LD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld" SLURM_TOPOLOGY_ADDR="osk-gpu56" SSH_CONNECTION="100.113.255.14 54546 10.255.255.101 22" READELF="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-readelf" ZE_AFFINITY_MASK="0,1,2,3,4,5,6,7" PYTORCH_CUDA_ALLOC_CONF="expandable_segments:True" GXX="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-g++" MASTER_ADDR="osk-gpu54" SLURM_TOPOLOGY_ADDR_PATTERN="node" CUDA_VISIBLE_DEVICES="0,1,2,3,4,5,6,7" GCC_AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-ar" ADDR2LINE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-addr2line" XDG_SESSION_CLASS="user" SLURM_WORKING_CLUSTER="osk-cluster:10.255.255.100:6817:9728:109" PYTHONPATH="/home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat:/home/Competition2025/P02/P02U006/ColossalAI:" TERM="xterm-256color" TORCH_NCCL_ASYNC_ERROR_HANDLING="0" GCC_NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc-nm" SIZE="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-size" HOST="x86_64-conda-linux-gnu" LESSOPEN="||/usr/bin/lesspipe.sh %s" CC_FOR_BUILD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" USER="P02U006" LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" SLURM_NODELIST="osk-gpu[54,56,91]" ENVIRONMENT="BATCH" GPU_DEVICE_ORDINAL="0,1,2,3,4,5,6,7" CONDA_SHLVL="1" MODULES_RUN_QUARANTINE="LD_LIBRARY_PATH LD_PRELOAD" AR="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ar" AS="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-as" DEBUG_CPPFLAGS="-D_DEBUG -D_FORTIFY_SOURCE=2 -Og -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include" SLURM_PRIO_PROCESS="0" host_alias="x86_64-conda-linux-gnu" SLURM_NPROCS="24" PYTHONFAULTHANDLER="1" SHLVL="2" SLURM_NNODES="3" NM="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-nm" GCC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-gcc" PMIX_MCA_gds="^ds12" XDG_SESSION_ID="64665" SLURM_SUBMIT_HOST="osk-cpu01" LD_GOLD="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ld.gold" CONDA_PYTHON_EXE="/home/Competition2025/P02/P02U006/miniconda3/bin/python" LD_LIBRARY_PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib64:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/lib:" XDG_RUNTIME_DIR="/run/user/11034" SLURM_JOB_ID="328550" UCX_MAX_RNDV_RAILS="8" SLURM_NODEID="1" SSH_CLIENT="100.113.255.14 54546 22" CONDA_DEFAULT_ENV="deepseeksft310" __MODULES_LMINIT="module use --append /home/appli/modulefiles:module use --append /usr/share/Modules/modulefiles:module use --append /etc/modulefiles:module use --append /usr/share/modulefiles" OBJCOPY="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objcopy" OMPI_MCA_coll_hcoll_enable="0" which_declare="declare -f" STRIP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-strip" CUDA_HOME="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310" NVCC_PREPEND_FLAGS_BACKUP=" -ccbin=/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++" XDG_DATA_DIRS="/home/Competition2025/P02/P02U006/.local/share/flatpak/exports/share:/var/lib/flatpak/exports/share:/usr/local/share:/usr/share" OBJDUMP="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-objdump" SLURM_CONF="/etc/slurm/slurm.conf" PATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin:/home/Competition2025/P02/P02U006/miniconda3/condabin:/home/Competition2025/P02/P02U006/.local/bin:/home/Competition2025/P02/P02U006/bin:/usr/share/Modules/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin" SLURM_JOB_NAME="lora-r1" MODULEPATH="/etc/scl/modulefiles:/home/appli/modulefiles:/usr/share/Modules/modulefiles:/etc/modulefiles:/usr/share/modulefiles" CC="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-cc" SLURM_NTASKS_PER_NODE="8" CFLAGS="-march=nocona -mtune=haswell -ftree-vectorize -fPIC -fstack-protector-strong -fno-plt -O2 -ffunction-sections -pipe -isystem /home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include  -I/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include" CXXFILT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-c++filt" DBUS_SESSION_BUS_ADDRESS="unix:path=/run/user/11034/bus" BUILD="x86_64-conda-linux-gnu" MAIL="/var/spool/mail/P02U006" SSH_TTY="/dev/pts/47" SLURM_JOB_GID="11034" CPATH="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/targets/x86_64-linux/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/include:/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/lib/python3.10/site-packages/nvidia/cublas/include:" RANLIB="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/bin/x86_64-conda-linux-gnu-ranlib" CONDA_BUILD_SYSROOT="/home/Competition2025/P02/P02U006/miniconda3/envs/deepseeksft310/x86_64-conda-linux-gnu/sysroot" UCX_MAX_EAGER_RAILS="8" OLDPWD="/home/Competition2025/P02/P02U006" SLURM_JOB_NODELIST="osk-gpu[54,56,91]" MODULES_CMD="/usr/share/Modules/libexec/modulecmd.tcl" TORCH_ELASTIC_STORE_TIMEOUT="3600" _="/usr/bin/srun" SLURM_MPI_TYPE="pmix_v3" SRUN_DEBUG="3" SLURM_UMASK="0022" SLURM_JOB_CPUS_PER_NODE_PACK_GROUP_0="8(x3)" SLURM_DISTRIBUTION="block" SLURM_STEP_ID="0" SLURM_STEPID="0" SLURM_STEP_NODELIST="osk-gpu[54,56,91]" SLURM_STEP_NUM_NODES="3" SLURM_STEP_NUM_TASKS="24" SLURM_STEP_TASKS_PER_NODE="8(x3)" SLURM_STEP_LAUNCHER_PORT="32819" SLURM_SRUN_COMM_PORT="32819" SLURM_PMIXP_ABORT_AGENT_PORT="34205" SLURM_PMIX_MAPPING_SERV="(vector,(0,3,8))" SLURM_SRUN_COMM_HOST="192.168.11.54" SLURM_STEP_GPUS="0,1,2,3,4,5,6,7" SLURM_CPU_BIND="quiet,none" SLURM_CPU_BIND_TYPE="none" SLURM_CPU_BIND_VERBOSE="quiet" SLURM_LAUNCH_NODE_IPADDR="192.168.11.54" PMIX_NAMESPACE="slurm.pmix.328550.0" PMIX_RANK="8" PMIX_SERVER_URI3="pmix-server.1574131;tcp4://127.0.0.1:42971" PMIX_SERVER_URI2="pmix-server.1574131;tcp4://127.0.0.1:42971" PMIX_SERVER_URI21="pmix-server.1574131;tcp4://127.0.0.1:42971" PMIX_SECURITY_MODE="munge,native" PMIX_PTL_MODULE="tcp,usock" PMIX_BFROP_BUFFER_TYPE="PMIX_BFROP_BUFFER_NON_DESC" PMIX_GDS_MODULE="ds21,ds12,hash" PMIX_SERVER_TMPDIR="/var/spool/slurm/d/pmix.328550.0/" PMIX_SYSTEM_TMPDIR="/tmp" PMIX_DSTORE_21_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds21_1574131" PMIX_DSTORE_ESH_BASE_PATH="/var/spool/slurm/d/pmix.328550.0//pmix_dstor_ds12_1574131" PMIX_HOSTNAME="osk-gpu56" PMIX_VERSION="3.2.3" CUDA_DEVICE_MAX_CONNECTIONS="1" && torchrun --nproc_per_node=1 --nnodes=1 --node_rank=0 --master_addr=127.0.0.1 --master_port=29500 /home/Competition2025/P02/P02U006/ColossalAI/applications/ColossalChat/examples/training_scripts/lora_finetune.py --pretrained /home/Competition2025/P02/shareP02/DeepSeek-R1-0528-BF16 --dataset /home/Competition2025/P02/shareP02/hci_colossalai_deepseekr10528_lorasft.jsonl --plugin moe --pp 3 --ep 8 --batch_size 8 --lr 2e-5 --max_length 256 --lora_rank 8 --lora_alpha 16 --num_epochs 2 --warmup_steps 8 --mixed_precision bf16 --use_grad_checkpoint --tensorboard_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/tb --save_dir /home/Competition2025/P02/P02U006/ColossalAI/logs/328550/DeepSeek-R1-0528-lora'

Exit code: 1

Stdout: already printed

Stderr: already printed



====== Training on All Nodes =====
127.0.0.1: failure

====== Stopping All Nodes =====
127.0.0.1: finish
