W0817 05:19:59.389000 1141425 torch/distributed/run.py:784] master_addr is only used for static rdzv_backend and when rdzv_endpoint is not specified.
W0817 05:19:59.390000 1141425 torch/distributed/run.py:792] 
W0817 05:19:59.390000 1141425 torch/distributed/run.py:792] *****************************************
W0817 05:19:59.390000 1141425 torch/distributed/run.py:792] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0817 05:19:59.390000 1141425 torch/distributed/run.py:792] *****************************************
Found cached dataset hle_sft_open_thoughts-114k (/home/Competition2025/P02/P02U006/.cache/huggingface/datasets/neko-llm___hle_sft_open_thoughts-114k/default/0.0.0/95b7ec559aefd67116876c6fe0c205c412188605)
Loading cached processed dataset at /home/Competition2025/P02/P02U006/.cache/huggingface/datasets/neko-llm___hle_sft_open_thoughts-114k/default/0.0.0/95b7ec559aefd67116876c6fe0c205c412188605/cache-8fff6bb52ea27ace_*_of_00001.arrow
Loading cached shuffled indices for dataset at /home/Competition2025/P02/P02U006/.cache/huggingface/datasets/neko-llm___hle_sft_open_thoughts-114k/default/0.0.0/95b7ec559aefd67116876c6fe0c205c412188605/cache-1eeda50561e2fa07.arrow
[INFO|tokenization_utils_base.py:2011] 2025-08-17 05:20:25,718 >> loading file vocab.json from cache at /home/Competition2025/P02/P02U006/.cache/huggingface/hub/models--Qwen--Qwen3-30B-A3B/snapshots/ad44e777bcd18fa416d9da3bd8f70d33ebb85d39/vocab.json
[INFO|tokenization_utils_base.py:2011] 2025-08-17 05:20:25,718 >> loading file merges.txt from cache at /home/Competition2025/P02/P02U006/.cache/huggingface/hub/models--Qwen--Qwen3-30B-A3B/snapshots/ad44e777bcd18fa416d9da3bd8f70d33ebb85d39/merges.txt
[INFO|tokenization_utils_base.py:2011] 2025-08-17 05:20:25,718 >> loading file tokenizer.json from cache at /home/Competition2025/P02/P02U006/.cache/huggingface/hub/models--Qwen--Qwen3-30B-A3B/snapshots/ad44e777bcd18fa416d9da3bd8f70d33ebb85d39/tokenizer.json
[INFO|tokenization_utils_base.py:2011] 2025-08-17 05:20:25,718 >> loading file added_tokens.json from cache at None
[INFO|tokenization_utils_base.py:2011] 2025-08-17 05:20:25,719 >> loading file special_tokens_map.json from cache at None
[INFO|tokenization_utils_base.py:2011] 2025-08-17 05:20:25,719 >> loading file tokenizer_config.json from cache at /home/Competition2025/P02/P02U006/.cache/huggingface/hub/models--Qwen--Qwen3-30B-A3B/snapshots/ad44e777bcd18fa416d9da3bd8f70d33ebb85d39/tokenizer_config.json
[INFO|tokenization_utils_base.py:2011] 2025-08-17 05:20:25,719 >> loading file chat_template.jinja from cache at None
[INFO|tokenization_utils_base.py:2280] 2025-08-17 05:20:26,062 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|configuration_utils.py:752] 2025-08-17 05:20:26,236 >> loading configuration file config.json from cache at /home/Competition2025/P02/P02U006/.cache/huggingface/hub/models--Qwen--Qwen3-30B-A3B/snapshots/ad44e777bcd18fa416d9da3bd8f70d33ebb85d39/config.json
[INFO|configuration_utils.py:817] 2025-08-17 05:20:26,237 >> Model config Qwen3MoeConfig {
  "architectures": [
    "Qwen3MoeForCausalLM"
  ],
  "attention_bias": false,
  "attention_dropout": 0.0,
  "bos_token_id": 151643,
  "decoder_sparse_step": 1,
  "eos_token_id": 151645,
  "head_dim": 128,
  "hidden_act": "silu",
  "hidden_size": 2048,
  "initializer_range": 0.02,
  "intermediate_size": 6144,
  "max_position_embeddings": 40960,
  "max_window_layers": 48,
  "mlp_only_layers": [],
  "model_type": "qwen3_moe",
  "moe_intermediate_size": 768,
  "norm_topk_prob": true,
  "num_attention_heads": 32,
  "num_experts": 128,
  "num_experts_per_tok": 8,
  "num_hidden_layers": 48,
  "num_key_value_heads": 4,
  "output_router_logits": false,
  "rms_norm_eps": 1e-06,
  "rope_scaling": null,
  "rope_theta": 1000000.0,
  "router_aux_loss_coef": 0.001,
  "sliding_window": null,
  "tie_word_embeddings": false,
  "torch_dtype": "bfloat16",
  "transformers_version": "4.54.1",
  "use_cache": true,
  "use_sliding_window": false,
  "vocab_size": 151936
}

[INFO|modeling_utils.py:1271] 2025-08-17 05:20:26,740 >> loading weights file model.safetensors from cache at /home/Competition2025/P02/P02U006/.cache/huggingface/hub/models--Qwen--Qwen3-30B-A3B/snapshots/ad44e777bcd18fa416d9da3bd8f70d33ebb85d39/model.safetensors.index.json
[INFO|modeling_utils.py:2374] 2025-08-17 05:20:26,753 >> Instantiating Qwen3MoeForCausalLM model under default dtype torch.bfloat16.
[INFO|modeling_utils.py:4306] 2025-08-17 05:20:26,753 >> Detected DeepSpeed ZeRO-3: activating zero.init() for this model
[INFO|configuration_utils.py:1103] 2025-08-17 05:20:26,762 >> Generate config GenerationConfig {
  "bos_token_id": 151643,
  "eos_token_id": 151645
}

Loading checkpoint shards:   0%|          | 0/16 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/16 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/16 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/16 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/16 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/16 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/16 [00:00<?, ?it/s]Loading checkpoint shards:   0%|          | 0/16 [00:00<?, ?it/s]Loading checkpoint shards:   6%|▋         | 1/16 [00:05<01:27,  5.83s/it]Loading checkpoint shards:   6%|▋         | 1/16 [00:05<01:26,  5.80s/it]Loading checkpoint shards:   6%|▋         | 1/16 [00:05<01:27,  5.85s/it]Loading checkpoint shards:   6%|▋         | 1/16 [00:05<01:27,  5.83s/it]Loading checkpoint shards:   6%|▋         | 1/16 [00:05<01:27,  5.82s/it]Loading checkpoint shards:   6%|▋         | 1/16 [00:05<01:27,  5.81s/it]Loading checkpoint shards:   6%|▋         | 1/16 [00:05<01:27,  5.84s/it]Loading checkpoint shards:   6%|▋         | 1/16 [00:06<01:33,  6.21s/it]Loading checkpoint shards:  12%|█▎        | 2/16 [00:13<01:33,  6.71s/it]Loading checkpoint shards:  12%|█▎        | 2/16 [00:13<01:33,  6.70s/it]Loading checkpoint shards:  12%|█▎        | 2/16 [00:13<01:33,  6.69s/it]Loading checkpoint shards:  12%|█▎        | 2/16 [00:13<01:33,  6.71s/it]Loading checkpoint shards:  12%|█▎        | 2/16 [00:13<01:34,  6.72s/it]Loading checkpoint shards:  12%|█▎        | 2/16 [00:13<01:33,  6.71s/it]Loading checkpoint shards:  12%|█▎        | 2/16 [00:13<01:33,  6.70s/it]Loading checkpoint shards:  12%|█▎        | 2/16 [00:13<01:36,  6.90s/it]Loading checkpoint shards:  19%|█▉        | 3/16 [00:20<01:30,  6.96s/it]Loading checkpoint shards:  19%|█▉        | 3/16 [00:20<01:30,  6.97s/it]Loading checkpoint shards:  19%|█▉        | 3/16 [00:20<01:30,  6.97s/it]Loading checkpoint shards:  19%|█▉        | 3/16 [00:20<01:30,  6.96s/it]Loading checkpoint shards:  19%|█▉        | 3/16 [00:20<01:30,  6.96s/it]Loading checkpoint shards:  19%|█▉        | 3/16 [00:20<01:30,  6.96s/it]Loading checkpoint shards:  19%|█▉        | 3/16 [00:20<01:30,  6.97s/it]Loading checkpoint shards:  19%|█▉        | 3/16 [00:20<01:31,  7.07s/it]Loading checkpoint shards:  25%|██▌       | 4/16 [00:25<01:15,  6.28s/it]Loading checkpoint shards:  25%|██▌       | 4/16 [00:25<01:15,  6.29s/it]Loading checkpoint shards:  25%|██▌       | 4/16 [00:25<01:15,  6.28s/it]Loading checkpoint shards:  25%|██▌       | 4/16 [00:25<01:15,  6.29s/it]Loading checkpoint shards:  25%|██▌       | 4/16 [00:25<01:15,  6.28s/it]Loading checkpoint shards:  25%|██▌       | 4/16 [00:25<01:15,  6.28s/it]Loading checkpoint shards:  25%|██▌       | 4/16 [00:25<01:15,  6.28s/it]Loading checkpoint shards:  25%|██▌       | 4/16 [00:26<01:15,  6.31s/it]Loading checkpoint shards:  31%|███▏      | 5/16 [00:32<01:12,  6.58s/it]Loading checkpoint shards:  31%|███▏      | 5/16 [00:32<01:12,  6.59s/it]Loading checkpoint shards:  31%|███▏      | 5/16 [00:32<01:12,  6.59s/it]Loading checkpoint shards:  31%|███▏      | 5/16 [00:32<01:12,  6.58s/it]Loading checkpoint shards:  31%|███▏      | 5/16 [00:32<01:12,  6.59s/it]Loading checkpoint shards:  31%|███▏      | 5/16 [00:32<01:12,  6.58s/it]Loading checkpoint shards:  31%|███▏      | 5/16 [00:32<01:12,  6.58s/it]Loading checkpoint shards:  31%|███▏      | 5/16 [00:33<01:12,  6.62s/it]Loading checkpoint shards:  38%|███▊      | 6/16 [00:39<01:07,  6.79s/it]Loading checkpoint shards:  38%|███▊      | 6/16 [00:39<01:07,  6.78s/it]Loading checkpoint shards:  38%|███▊      | 6/16 [00:39<01:07,  6.79s/it]Loading checkpoint shards:  38%|███▊      | 6/16 [00:39<01:07,  6.78s/it]Loading checkpoint shards:  38%|███▊      | 6/16 [00:39<01:07,  6.79s/it]Loading checkpoint shards:  38%|███▊      | 6/16 [00:39<01:07,  6.79s/it]Loading checkpoint shards:  38%|███▊      | 6/16 [00:39<01:08,  6.80s/it]Loading checkpoint shards:  38%|███▊      | 6/16 [00:40<01:08,  6.81s/it]Loading checkpoint shards:  44%|████▍     | 7/16 [00:47<01:02,  6.96s/it]Loading checkpoint shards:  44%|████▍     | 7/16 [00:47<01:02,  6.96s/it]Loading checkpoint shards:  44%|████▍     | 7/16 [00:47<01:02,  6.96s/it]Loading checkpoint shards:  44%|████▍     | 7/16 [00:47<01:02,  6.95s/it]Loading checkpoint shards:  44%|████▍     | 7/16 [00:47<01:02,  6.96s/it]Loading checkpoint shards:  44%|████▍     | 7/16 [00:47<01:02,  6.96s/it]Loading checkpoint shards:  44%|████▍     | 7/16 [00:47<01:02,  6.99s/it]Loading checkpoint shards:  44%|████▍     | 7/16 [00:47<01:02,  6.97s/it]Loading checkpoint shards:  50%|█████     | 8/16 [00:54<00:56,  7.03s/it]Loading checkpoint shards:  50%|█████     | 8/16 [00:54<00:56,  7.04s/it]Loading checkpoint shards:  50%|█████     | 8/16 [00:54<00:56,  7.02s/it]Loading checkpoint shards:  50%|█████     | 8/16 [00:54<00:56,  7.03s/it]Loading checkpoint shards:  50%|█████     | 8/16 [00:54<00:56,  7.03s/it]Loading checkpoint shards:  50%|█████     | 8/16 [00:54<00:56,  7.03s/it]Loading checkpoint shards:  50%|█████     | 8/16 [00:54<00:56,  7.03s/it]Loading checkpoint shards:  50%|█████     | 8/16 [00:54<00:56,  7.04s/it]Loading checkpoint shards:  56%|█████▋    | 9/16 [00:59<00:45,  6.44s/it]Loading checkpoint shards:  56%|█████▋    | 9/16 [00:59<00:45,  6.44s/it]Loading checkpoint shards:  56%|█████▋    | 9/16 [00:59<00:45,  6.44s/it]Loading checkpoint shards:  56%|█████▋    | 9/16 [00:59<00:45,  6.43s/it]Loading checkpoint shards:  56%|█████▋    | 9/16 [00:59<00:45,  6.44s/it]Loading checkpoint shards:  56%|█████▋    | 9/16 [00:59<00:45,  6.44s/it]Loading checkpoint shards:  56%|█████▋    | 9/16 [00:59<00:45,  6.44s/it]Loading checkpoint shards:  56%|█████▋    | 9/16 [00:59<00:44,  6.41s/it]Loading checkpoint shards:  62%|██████▎   | 10/16 [01:04<00:36,  6.04s/it]Loading checkpoint shards:  62%|██████▎   | 10/16 [01:04<00:36,  6.04s/it]Loading checkpoint shards:  62%|██████▎   | 10/16 [01:04<00:36,  6.04s/it]Loading checkpoint shards:  62%|██████▎   | 10/16 [01:04<00:36,  6.03s/it]Loading checkpoint shards:  62%|██████▎   | 10/16 [01:04<00:36,  6.04s/it]Loading checkpoint shards:  62%|██████▎   | 10/16 [01:04<00:36,  6.04s/it]Loading checkpoint shards:  62%|██████▎   | 10/16 [01:04<00:36,  6.04s/it]Loading checkpoint shards:  62%|██████▎   | 10/16 [01:05<00:36,  6.02s/it]Loading checkpoint shards:  69%|██████▉   | 11/16 [01:11<00:31,  6.35s/it]Loading checkpoint shards:  69%|██████▉   | 11/16 [01:11<00:31,  6.35s/it]Loading checkpoint shards:  69%|██████▉   | 11/16 [01:11<00:31,  6.35s/it]Loading checkpoint shards:  69%|██████▉   | 11/16 [01:11<00:31,  6.35s/it]Loading checkpoint shards:  69%|██████▉   | 11/16 [01:11<00:31,  6.35s/it]Loading checkpoint shards:  69%|██████▉   | 11/16 [01:11<00:31,  6.35s/it]Loading checkpoint shards:  69%|██████▉   | 11/16 [01:11<00:31,  6.35s/it]Loading checkpoint shards:  69%|██████▉   | 11/16 [01:12<00:31,  6.36s/it]Loading checkpoint shards:  75%|███████▌  | 12/16 [01:18<00:25,  6.34s/it]Loading checkpoint shards:  75%|███████▌  | 12/16 [01:18<00:25,  6.34s/it]Loading checkpoint shards:  75%|███████▌  | 12/16 [01:18<00:25,  6.33s/it]Loading checkpoint shards:  75%|███████▌  | 12/16 [01:18<00:25,  6.34s/it]Loading checkpoint shards:  75%|███████▌  | 12/16 [01:18<00:25,  6.33s/it]Loading checkpoint shards:  75%|███████▌  | 12/16 [01:18<00:25,  6.33s/it]Loading checkpoint shards:  75%|███████▌  | 12/16 [01:18<00:25,  6.34s/it]Loading checkpoint shards:  75%|███████▌  | 12/16 [01:18<00:25,  6.33s/it]Loading checkpoint shards:  81%|████████▏ | 13/16 [01:25<00:19,  6.58s/it]Loading checkpoint shards:  81%|████████▏ | 13/16 [01:25<00:19,  6.58s/it]Loading checkpoint shards:  81%|████████▏ | 13/16 [01:25<00:19,  6.58s/it]Loading checkpoint shards:  81%|████████▏ | 13/16 [01:25<00:19,  6.58s/it]Loading checkpoint shards:  81%|████████▏ | 13/16 [01:25<00:19,  6.58s/it]Loading checkpoint shards:  81%|████████▏ | 13/16 [01:25<00:19,  6.58s/it]Loading checkpoint shards:  81%|████████▏ | 13/16 [01:25<00:19,  6.58s/it]Loading checkpoint shards:  81%|████████▏ | 13/16 [01:25<00:19,  6.60s/it]Loading checkpoint shards:  88%|████████▊ | 14/16 [01:30<00:12,  6.28s/it]Loading checkpoint shards:  88%|████████▊ | 14/16 [01:30<00:12,  6.28s/it]Loading checkpoint shards:  88%|████████▊ | 14/16 [01:30<00:12,  6.28s/it]Loading checkpoint shards:  88%|████████▊ | 14/16 [01:30<00:12,  6.28s/it]Loading checkpoint shards:  88%|████████▊ | 14/16 [01:30<00:12,  6.28s/it]Loading checkpoint shards:  88%|████████▊ | 14/16 [01:30<00:12,  6.28s/it]Loading checkpoint shards:  88%|████████▊ | 14/16 [01:30<00:12,  6.28s/it]Loading checkpoint shards:  88%|████████▊ | 14/16 [01:31<00:12,  6.26s/it]Loading checkpoint shards:  94%|█████████▍| 15/16 [01:37<00:06,  6.52s/it]Loading checkpoint shards:  94%|█████████▍| 15/16 [01:37<00:06,  6.52s/it]Loading checkpoint shards:  94%|█████████▍| 15/16 [01:37<00:06,  6.52s/it]Loading checkpoint shards:  94%|█████████▍| 15/16 [01:37<00:06,  6.52s/it]Loading checkpoint shards:  94%|█████████▍| 15/16 [01:37<00:06,  6.52s/it]Loading checkpoint shards:  94%|█████████▍| 15/16 [01:37<00:06,  6.52s/it]Loading checkpoint shards:  94%|█████████▍| 15/16 [01:37<00:06,  6.52s/it]Loading checkpoint shards:  94%|█████████▍| 15/16 [01:38<00:06,  6.53s/it]Loading checkpoint shards: 100%|██████████| 16/16 [01:38<00:00,  4.82s/it]Loading checkpoint shards: 100%|██████████| 16/16 [01:38<00:00,  4.82s/it]Loading checkpoint shards: 100%|██████████| 16/16 [01:38<00:00,  4.82s/it]Loading checkpoint shards: 100%|██████████| 16/16 [01:38<00:00,  4.83s/it]Loading checkpoint shards: 100%|██████████| 16/16 [01:38<00:00,  4.82s/it]Loading checkpoint shards: 100%|██████████| 16/16 [01:38<00:00,  4.83s/it]Loading checkpoint shards: 100%|██████████| 16/16 [01:38<00:00,  4.82s/it]Loading checkpoint shards: 100%|██████████| 16/16 [01:38<00:00,  6.17s/it]
Loading checkpoint shards: 100%|██████████| 16/16 [01:38<00:00,  6.17s/it]
Loading checkpoint shards: 100%|██████████| 16/16 [01:38<00:00,  6.17s/it]
Loading checkpoint shards: 100%|██████████| 16/16 [01:38<00:00,  6.18s/it]Loading checkpoint shards: 100%|██████████| 16/16 [01:38<00:00,  6.18s/it]

Loading checkpoint shards: 100%|██████████| 16/16 [01:38<00:00,  6.17s/it]
Loading checkpoint shards: 100%|██████████| 16/16 [01:38<00:00,  6.17s/it]
Loading checkpoint shards: 100%|██████████| 16/16 [01:39<00:00,  4.93s/it]Loading checkpoint shards: 100%|██████████| 16/16 [01:39<00:00,  6.22s/it]
[INFO|modeling_utils.py:5541] 2025-08-17 05:22:19,331 >> All model checkpoint weights were used when initializing Qwen3MoeForCausalLM.

[INFO|modeling_utils.py:5549] 2025-08-17 05:22:19,331 >> All the weights of Qwen3MoeForCausalLM were initialized from the model checkpoint at Qwen/Qwen3-30B-A3B.
If your task is similar to the task the model of the checkpoint was trained on, you can already use Qwen3MoeForCausalLM for predictions without further training.
[INFO|configuration_utils.py:1058] 2025-08-17 05:22:19,710 >> loading configuration file generation_config.json from cache at /home/Competition2025/P02/P02U006/.cache/huggingface/hub/models--Qwen--Qwen3-30B-A3B/snapshots/ad44e777bcd18fa416d9da3bd8f70d33ebb85d39/generation_config.json
[INFO|configuration_utils.py:1103] 2025-08-17 05:22:19,710 >> Generate config GenerationConfig {
  "bos_token_id": 151643,
  "do_sample": true,
  "eos_token_id": [
    151645,
    151643
  ],
  "pad_token_id": 151643,
  "temperature": 0.6,
  "top_k": 20,
  "top_p": 0.95
}

Loading cached processed dataset at /home/Competition2025/P02/P02U006/.cache/huggingface/datasets/neko-llm___hle_sft_open_thoughts-114k/default/0.0.0/95b7ec559aefd67116876c6fe0c205c412188605/cache-8766f1740da88d20_*_of_00012.arrow
Concatenating 12 shards
Process #1 will write at /home/Competition2025/P02/P02U006/.cache/huggingface/datasets/neko-llm___hle_sft_open_thoughts-114k/default/0.0.0/95b7ec559aefd67116876c6fe0c205c412188605/cache-9cfac388ffdb81bd_00000_of_00012.arrow
Process #2 will write at /home/Competition2025/P02/P02U006/.cache/huggingface/datasets/neko-llm___hle_sft_open_thoughts-114k/default/0.0.0/95b7ec559aefd67116876c6fe0c205c412188605/cache-9cfac388ffdb81bd_00001_of_00012.arrow
Process #3 will write at /home/Competition2025/P02/P02U006/.cache/huggingface/datasets/neko-llm___hle_sft_open_thoughts-114k/default/0.0.0/95b7ec559aefd67116876c6fe0c205c412188605/cache-9cfac388ffdb81bd_00002_of_00012.arrow
Process #4 will write at /home/Competition2025/P02/P02U006/.cache/huggingface/datasets/neko-llm___hle_sft_open_thoughts-114k/default/0.0.0/95b7ec559aefd67116876c6fe0c205c412188605/cache-9cfac388ffdb81bd_00003_of_00012.arrow
Process #5 will write at /home/Competition2025/P02/P02U006/.cache/huggingface/datasets/neko-llm___hle_sft_open_thoughts-114k/default/0.0.0/95b7ec559aefd67116876c6fe0c205c412188605/cache-9cfac388ffdb81bd_00004_of_00012.arrow
Process #6 will write at /home/Competition2025/P02/P02U006/.cache/huggingface/datasets/neko-llm___hle_sft_open_thoughts-114k/default/0.0.0/95b7ec559aefd67116876c6fe0c205c412188605/cache-9cfac388ffdb81bd_00005_of_00012.arrow
Process #7 will write at /home/Competition2025/P02/P02U006/.cache/huggingface/datasets/neko-llm___hle_sft_open_thoughts-114k/default/0.0.0/95b7ec559aefd67116876c6fe0c205c412188605/cache-9cfac388ffdb81bd_00006_of_00012.arrow
Process #8 will write at /home/Competition2025/P02/P02U006/.cache/huggingface/datasets/neko-llm___hle_sft_open_thoughts-114k/default/0.0.0/95b7ec559aefd67116876c6fe0c205c412188605/cache-9cfac388ffdb81bd_00007_of_00012.arrow
Process #9 will write at /home/Competition2025/P02/P02U006/.cache/huggingface/datasets/neko-llm___hle_sft_open_thoughts-114k/default/0.0.0/95b7ec559aefd67116876c6fe0c205c412188605/cache-9cfac388ffdb81bd_00008_of_00012.arrow
Process #10 will write at /home/Competition2025/P02/P02U006/.cache/huggingface/datasets/neko-llm___hle_sft_open_thoughts-114k/default/0.0.0/95b7ec559aefd67116876c6fe0c205c412188605/cache-9cfac388ffdb81bd_00009_of_00012.arrow
Process #11 will write at /home/Competition2025/P02/P02U006/.cache/huggingface/datasets/neko-llm___hle_sft_open_thoughts-114k/default/0.0.0/95b7ec559aefd67116876c6fe0c205c412188605/cache-9cfac388ffdb81bd_00010_of_00012.arrow
Process #12 will write at /home/Competition2025/P02/P02U006/.cache/huggingface/datasets/neko-llm___hle_sft_open_thoughts-114k/default/0.0.0/95b7ec559aefd67116876c6fe0c205c412188605/cache-9cfac388ffdb81bd_00011_of_00012.arrow
Truncating train dataset (num_proc=12):   0%|          | 0/6000 [00:00<?, ? examples/s]Spawning 12 processes
Caching processed dataset at /home/Competition2025/P02/P02U006/.cache/huggingface/datasets/neko-llm___hle_sft_open_thoughts-114k/default/0.0.0/95b7ec559aefd67116876c6fe0c205c412188605/cache-9cfac388ffdb81bd_00001_of_00012.arrow
Caching processed dataset at /home/Competition2025/P02/P02U006/.cache/huggingface/datasets/neko-llm___hle_sft_open_thoughts-114k/default/0.0.0/95b7ec559aefd67116876c6fe0c205c412188605/cache-9cfac388ffdb81bd_00003_of_00012.arrow
Caching processed dataset at /home/Competition2025/P02/P02U006/.cache/huggingface/datasets/neko-llm___hle_sft_open_thoughts-114k/default/0.0.0/95b7ec559aefd67116876c6fe0c205c412188605/cache-9cfac388ffdb81bd_00008_of_00012.arrow
Caching processed dataset at /home/Competition2025/P02/P02U006/.cache/huggingface/datasets/neko-llm___hle_sft_open_thoughts-114k/default/0.0.0/95b7ec559aefd67116876c6fe0c205c412188605/cache-9cfac388ffdb81bd_00004_of_00012.arrow
Caching processed dataset at /home/Competition2025/P02/P02U006/.cache/huggingface/datasets/neko-llm___hle_sft_open_thoughts-114k/default/0.0.0/95b7ec559aefd67116876c6fe0c205c412188605/cache-9cfac388ffdb81bd_00006_of_00012.arrow
Caching processed dataset at /home/Competition2025/P02/P02U006/.cache/huggingface/datasets/neko-llm___hle_sft_open_thoughts-114k/default/0.0.0/95b7ec559aefd67116876c6fe0c205c412188605/cache-9cfac388ffdb81bd_00002_of_00012.arrow
Caching processed dataset at /home/Competition2025/P02/P02U006/.cache/huggingface/datasets/neko-llm___hle_sft_open_thoughts-114k/default/0.0.0/95b7ec559aefd67116876c6fe0c205c412188605/cache-9cfac388ffdb81bd_00007_of_00012.arrow
Caching processed dataset at /home/Competition2025/P02/P02U006/.cache/huggingface/datasets/neko-llm___hle_sft_open_thoughts-114k/default/0.0.0/95b7ec559aefd67116876c6fe0c205c412188605/cache-9cfac388ffdb81bd_00000_of_00012.arrow
Caching processed dataset at /home/Competition2025/P02/P02U006/.cache/huggingface/datasets/neko-llm___hle_sft_open_thoughts-114k/default/0.0.0/95b7ec559aefd67116876c6fe0c205c412188605/cache-9cfac388ffdb81bd_00010_of_00012.arrow
Caching processed dataset at /home/Competition2025/P02/P02U006/.cache/huggingface/datasets/neko-llm___hle_sft_open_thoughts-114k/default/0.0.0/95b7ec559aefd67116876c6fe0c205c412188605/cache-9cfac388ffdb81bd_00005_of_00012.arrow
Caching processed dataset at /home/Competition2025/P02/P02U006/.cache/huggingface/datasets/neko-llm___hle_sft_open_thoughts-114k/default/0.0.0/95b7ec559aefd67116876c6fe0c205c412188605/cache-9cfac388ffdb81bd_00009_of_00012.arrow
Caching processed dataset at /home/Competition2025/P02/P02U006/.cache/huggingface/datasets/neko-llm___hle_sft_open_thoughts-114k/default/0.0.0/95b7ec559aefd67116876c6fe0c205c412188605/cache-9cfac388ffdb81bd_00011_of_00012.arrow
Truncating train dataset (num_proc=12):   8%|▊         | 500/6000 [00:00<00:03, 1554.32 examples/s]Truncating train dataset (num_proc=12): 100%|██████████| 6000/6000 [00:00<00:00, 12863.69 examples/s]
Concatenating 12 shards
[INFO|trainer.py:707] 2025-08-17 05:22:20,724 >> max_steps is given, it will override any value given in num_train_epochs
[INFO|trainer.py:757] 2025-08-17 05:22:20,724 >> Using auto half precision backend
[INFO|deepspeed.py:492] 2025-08-17 05:23:06,842 >> Attempting to resume from data/Qwen3-30B-test/checkpoint-4
[INFO|trainer.py:2432] 2025-08-17 05:24:17,376 >> ***** Running training *****
[INFO|trainer.py:2433] 2025-08-17 05:24:17,376 >>   Num examples = 6,000
[INFO|trainer.py:2434] 2025-08-17 05:24:17,376 >>   Num Epochs = 1
[INFO|trainer.py:2435] 2025-08-17 05:24:17,376 >>   Instantaneous batch size per device = 1
[INFO|trainer.py:2438] 2025-08-17 05:24:17,376 >>   Total train batch size (w. parallel, distributed & accumulation) = 64
[INFO|trainer.py:2439] 2025-08-17 05:24:17,376 >>   Gradient Accumulation steps = 8
[INFO|trainer.py:2440] 2025-08-17 05:24:17,376 >>   Total optimization steps = 3
[INFO|trainer.py:2441] 2025-08-17 05:24:17,445 >>   Number of trainable parameters = 30,532,122,624
[INFO|trainer.py:2463] 2025-08-17 05:24:17,445 >>   Continuing training from checkpoint, will skip to saved global_step
[INFO|trainer.py:2464] 2025-08-17 05:24:17,445 >>   Continuing training from epoch 0
[INFO|trainer.py:2465] 2025-08-17 05:24:17,445 >>   Continuing training from global step 4
[INFO|trainer.py:2467] 2025-08-17 05:24:17,445 >>   Will skip the first 0 epochs then the first 32 batches in the first epoch.
  0%|          | 0/3 [00:00<?, ?it/s]5it [02:03, 24.74s/it]                                     5it [02:03, 24.74s/it][INFO|trainer.py:4069] 2025-08-17 05:27:01,883 >> Saving model checkpoint to data/Qwen3-30B-test/checkpoint-5
[INFO|configuration_utils.py:478] 2025-08-17 05:27:01,888 >> Configuration saved in data/Qwen3-30B-test/checkpoint-5/config.json
[INFO|configuration_utils.py:874] 2025-08-17 05:27:01,889 >> Configuration saved in data/Qwen3-30B-test/checkpoint-5/generation_config.json
[INFO|modeling_utils.py:4123] 2025-08-17 05:27:47,605 >> The model is bigger than the maximum size per checkpoint (5GB) and is going to be split in 13 checkpoint shards. You can find where each parameters has been saved in the index located at data/Qwen3-30B-test/checkpoint-5/model.safetensors.index.json.
[INFO|tokenization_utils_base.py:2337] 2025-08-17 05:27:47,615 >> chat template saved in data/Qwen3-30B-test/checkpoint-5/chat_template.jinja
[INFO|tokenization_utils_base.py:2506] 2025-08-17 05:27:47,620 >> tokenizer config file saved in data/Qwen3-30B-test/checkpoint-5/tokenizer_config.json
[INFO|tokenization_utils_base.py:2515] 2025-08-17 05:27:47,621 >> Special tokens file saved in data/Qwen3-30B-test/checkpoint-5/special_tokens_map.json
[INFO|trainer.py:4178] 2025-08-17 05:29:13,459 >> Deleting older checkpoint [data/Qwen3-30B-test/checkpoint-4] due to args.save_total_limit
[INFO|trainer.py:2714] 2025-08-17 05:29:26,243 >> 

Training completed. Do not forget to share your model on huggingface.co/models =)


                      5it [05:08, 24.74s/it]5it [05:08, 61.75s/it]
[INFO|trainer.py:4069] 2025-08-17 05:30:04,696 >> Saving model checkpoint to data/Qwen3-30B-test
[INFO|configuration_utils.py:478] 2025-08-17 05:30:04,761 >> Configuration saved in data/Qwen3-30B-test/config.json
[INFO|configuration_utils.py:874] 2025-08-17 05:30:04,763 >> Configuration saved in data/Qwen3-30B-test/generation_config.json
[INFO|modeling_utils.py:4123] 2025-08-17 05:31:07,003 >> The model is bigger than the maximum size per checkpoint (5GB) and is going to be split in 13 checkpoint shards. You can find where each parameters has been saved in the index located at data/Qwen3-30B-test/model.safetensors.index.json.
[INFO|tokenization_utils_base.py:2337] 2025-08-17 05:31:07,007 >> chat template saved in data/Qwen3-30B-test/chat_template.jinja
[INFO|tokenization_utils_base.py:2506] 2025-08-17 05:31:07,009 >> tokenizer config file saved in data/Qwen3-30B-test/tokenizer_config.json
[INFO|tokenization_utils_base.py:2515] 2025-08-17 05:31:07,010 >> Special tokens file saved in data/Qwen3-30B-test/special_tokens_map.json
[INFO|configuration_utils.py:478] 2025-08-17 05:31:07,319 >> Configuration saved in data/Qwen3-30B-test/config.json
